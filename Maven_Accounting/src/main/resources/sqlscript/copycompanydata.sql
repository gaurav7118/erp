DROP PROCEDURE IF EXISTS copycompanydata;
delimiter //
CREATE PROCEDURE copycompanydata (fromdb varchar(50), todb varchar(50), dmn varchar(50))
BEGIN
	SET @x_subdomain = dmn;

	SET foreign_key_checks = 0;

	SET @sql_text = concat('SELECT DISTINCT companyid into @x_companyid from ',fromdb,'.company where subdomain =?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_subdomain;DEALLOCATE PREPARE stmt;
	
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productbranddiscountdetails SELECT * from ',fromdb,'.productbranddiscountdetails');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.croneschedule SELECT * from ',fromdb,'.croneschedule');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.taxadjustment SELECT * from ',fromdb,'.taxadjustment');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.additionalmemo SELECT * from ',fromdb,'.additionalmemo');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.baddebtinvoicemapping SELECT * from ',fromdb,'.baddebtinvoicemapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.baddebtpurchaseinvoicemapping SELECT * from ',fromdb,'.baddebtpurchaseinvoicemapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.timezone SELECT * from ',fromdb,'.timezone');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.templatefieldinfo SELECT * from ',fromdb,'.templatefieldinfo');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.reportrolemap SELECT * from ',fromdb,'.reportrolemap');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.reportmaster SELECT * from ',fromdb,'.reportmaster');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.producttype SELECT * from ',fromdb,'.producttype');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportsmeasuresfields SELECT * from ',fromdb,'.customreportsmeasuresfields');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportsmeasuresfieldsmapping SELECT * from ',fromdb,'.customreportsmeasuresfieldsmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportsdefaultfieldsmapping SELECT * from ',fromdb,'.customreportsdefaultfieldsmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportscustomfieldsmapping SELECT * from ',fromdb,'.customreportscustomfieldsmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportsdefaults SELECT * from ',fromdb,'.customreportsdefaults');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.modules SELECT * from ',fromdb,'.modules');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.samplefiledata SELECT * from ',fromdb,'.samplefiledata');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.reportschema SELECT * from ',fromdb,'.reportschema');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.modulecategory SELECT * from ',fromdb,'.modulecategory');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcompanypreferences SELECT * from ',fromdb,'.mrpcompanypreferences');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractdoc SELECT * from ',fromdb,'.mrpcontractdoc');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;        
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mastergroup SELECT * from ',fromdb,'.mastergroup');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.language SELECT * from ',fromdb,'.language');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.helpedit SELECT * from ',fromdb,'.helpedit');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rolepermission select * FROM ',fromdb,'.rolepermission where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstformgenerationhistory select * FROM ',fromdb,'.gstformgenerationhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.multientitymapping select * FROM ',fromdb,'.multientitymapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.taxperiod select * FROM ',fromdb,'.taxperiod where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mobilefieldsetup select * FROM ',fromdb,'.mobilefieldsetup where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultmobilefieldsetup select * FROM ',fromdb,'.defaultmobilefieldsetup where id in (select moduleid from ',fromdb,'.mobilefieldsetup where company =?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.expensepodetails select * FROM ',fromdb,'.expensepodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.expensepodetailcustomdata select * FROM ',fromdb,'.expensepodetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreports select * FROM ',fromdb,'.customreports where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accounitng_period_lock_info select * FROM ',fromdb,'.accounitng_period_lock_info where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.featurelist SELECT * from ',fromdb,'.featurelist');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.exportcompanypref SELECT * from ',fromdb,'.exportcompanypref');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.exchangerate SELECT * from ',fromdb,'.exchangerate');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultuom SELECT * from ',fromdb,'.defaultuom');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaulttax1099category SELECT * from ',fromdb,'.defaulttax1099category');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultpaymentmethod SELECT * from ',fromdb,'.defaultpaymentmethod');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultmasteritem SELECT * from ',fromdb,'.defaultmasteritem');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultgst SELECT * from ',fromdb,'.defaultgst');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultexchangeratedetails SELECT * from ',fromdb,'.defaultexchangeratedetails');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultexchangerate SELECT * from ',fromdb,'.defaultexchangerate');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultcreditterm SELECT * from ',fromdb,'.defaultcreditterm');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.default_header SELECT * from ',fromdb,'.default_header');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultaccount SELECT * from ',fromdb,'.defaultaccount');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultcustomfields SELECT * from ',fromdb,'.defaultcustomfields');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rangetextfiltersforadvancesearch SELECT * from ',fromdb,'.rangetextfiltersforadvancesearch');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.crossmodulelinkingdetails SELECT * from ',fromdb,'.crossmodulelinkingdetails');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.crossmodulejoindetails SELECT * from ',fromdb,'.crossmodulejoindetails');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportsgstfieldslineleveltermsmapping SELECT * from ',fromdb,'.customreportsgstfieldslineleveltermsmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customtables SELECT * from ',fromdb,'.customtables');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupcompany_companylist SELECT * from ',fromdb,'.groupcompany_companylist');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupcompany_processmapping SELECT * from ',fromdb,'.groupcompany_processmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupcompany_customervendormapping SELECT * from ',fromdb,'.groupcompany_customervendormapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupcompany_taxmapping SELECT * from ',fromdb,'.groupcompany_taxmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupcompany_termmapping SELECT * from ',fromdb,'.groupcompany_termmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupcompany_transactionmapping SELECT * from ',fromdb,'.groupcompany_transactionmapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.default_header_rest SELECT * from ',fromdb,'.default_header_rest');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dateformat SELECT * from ',fromdb,'.dateformat');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customcurrency select * FROM ',fromdb,'.customcurrency where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.currency SELECT * from ',fromdb,'.currency');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultgroupaccmap select * FROM ',fromdb,'.defaultgroupaccmap where defaultlayoutgroup in (select id from ',fromdb,'.defaultlayoutgroup where template in (select id from ',fromdb,'.defaulttemplatepnl where country in (select id from ',fromdb,'.country where id in (select id from ',fromdb,'.company where companyid = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultgroupmapfortotal select * FROM ',fromdb,'.defaultgroupmapfortotal where groupid in (select id from ',fromdb,'.defaultlayoutgroup where template in (select id from ',fromdb,'.defaulttemplatepnl where country in (select id from ',fromdb,'.country where id in (select id from ',fromdb,'.company where companyid = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultlayoutgroup select * FROM ',fromdb,'.defaultlayoutgroup where template in (select id from ',fromdb,'.defaulttemplatepnl where country in (select id from ',fromdb,'.country where id in (select id from ',fromdb,'.company where companyid = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaulttemplatepnl select * FROM ',fromdb,'.defaulttemplatepnl where country in (select id from ',fromdb,'.country where id in (select id from ',fromdb,'.company where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;		
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.country SELECT * from ',fromdb,'.country');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.companytype SELECT * from ',fromdb,'.companytype');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.card SELECT * from ',fromdb,'.card');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;	
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.audit_group SELECT * from ',fromdb,'.audit_group');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.audit_action SELECT * from ',fromdb,'.audit_action');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
	SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.activitylist SELECT * from ',fromdb,'.activitylist');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.locationlevel select * FROM ',fromdb,'.locationlevel');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstcessruletype select * FROM ',fromdb,'.gstcessruletype');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customcurrency select * FROM ',fromdb,'.customcurrency where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.quotation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.deliveryorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.salesreturn where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.vendorquotation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.purchasereturn where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstdocumenthistory select * FROM ',fromdb,'.gstdocumenthistory where refdocid in (select id from ',fromdb,'.debitnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.quotationdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.sodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.invoicedetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.dodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.srdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.receiptadvancedetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.cntaxentry where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.vendorquotationdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.podetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.grdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.grodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.prdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.advancedetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttaxclasshistory select * FROM ',fromdb,'.gsttaxclasshistory where refdocid in (select id from ',fromdb,'.dntaxentry where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linkdetailreceipttodebitnote select * FROM ',fromdb,'.linkdetailreceipttodebitnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linkdetailpaymenttocreditnote select * FROM ',fromdb,'.linkdetailpaymenttocreditnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linkdetailreceipttoadvancepayment select * FROM ',fromdb,'.linkdetailreceipttoadvancepayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linkdetailpaymenttoadvancepayment select * FROM ',fromdb,'.linkdetailpaymenttoadvancepayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptdetails select * FROM ',fromdb,'.receiptdetails where receipt in (select id from ',fromdb,'.receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linkdetailreceipt select * FROM ',fromdb,'.linkdetailreceipt where receipt in (select id from ',fromdb,'.receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptadvancedetail select * FROM ',fromdb,'.receiptadvancedetail where receipt in (select id from ',fromdb,'.receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptdetailotherwise select * FROM ',fromdb,'.receiptdetailotherwise where receipt in (select id from ',fromdb,'.receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptdetailsloan select * FROM ',fromdb,'.receiptdetailsloan where receipt in (select id from ',fromdb,'.receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptwriteoff select * FROM ',fromdb,'.receiptwriteoff where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptlinking SELECT *  FROM ',fromdb,'.receiptlinking WHERE docid in (SELECT id from ',fromdb,'.receipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receipt select * FROM ',fromdb,'.receipt where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cndiscount select * FROM ',fromdb,'.cndiscount where creditnote in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cndetails select * FROM ',fromdb,'.cndetails where creditNote in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cndetailsgst select * FROM ',fromdb,'.cndetailsgst where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditnotedetailtermmap select * FROM ',fromdb,'.creditnotedetailtermmap where creditnotetaxentry in (select id from ',fromdb,'.cntaxentry where creditnote in (select id from ',fromdb,'.creditnote where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cntaxentry select * FROM ',fromdb,'.cntaxentry where creditnote in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditnotetermmap select * FROM ',fromdb,'.creditnotetermmap where creditnote in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditnotpayment select * FROM ',fromdb,'.creditnotpayment where cnid in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.openingbalancecreditnotecustomdata SELECT * FROM ',fromdb,'.openingbalancecreditnotecustomdata WHERE openingbalancecreditnoteid in (SELECT id from ',fromdb,'.creditnote WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditnotelinking SELECT * FROM ',fromdb,'.creditnotelinking WHERE docid in (SELECT id from ',fromdb,'.creditnote WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditterm select * FROM ',fromdb,'.creditterm where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditnoteinvoicemappinginfo select * FROM ',fromdb,'.creditnoteinvoicemappinginfo where creditnote in (select id from ',fromdb,'.creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cnoverchargelinkamountdetails select * FROM ',fromdb,'.cnoverchargelinkamountdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditnote select * FROM ',fromdb,'.creditnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.loanrules select * FROM ',fromdb,'.loanrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.disposerevertassets select * FROM ',fromdb,'.disposerevertassets where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repaymentdetails select * FROM ',fromdb,'.repaymentdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.disbursement select * FROM ',fromdb,'.disbursement where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicedetails select * FROM ',fromdb,'.invoicedetails where invoice in (select id from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.excludedoutstandingrecords select * FROM ',fromdb,'.excludedoutstandingrecords  where invoice in (select id from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.openingbalanceinvoicecustomdata SELECT * FROM ',fromdb,'.openingbalanceinvoicecustomdata  WHERE openingbalanceinvoiceid in (SELECT id from  ',fromdb,'.invoice WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicelinking SELECT * FROM ',fromdb,'.invoicelinking  WHERE docid in (SELECT id from ',fromdb,'.invoice WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoiceinused select * FROM ',fromdb,'.invoiceinused where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicecontractmapping select * FROM ',fromdb,'.invoicecontractmapping where invoice in (select id from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicedoccompmap select * FROM ',fromdb,'.invoicedoccompmap where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicedocuments select * FROM ',fromdb,'.invoicedocuments where id in (select documentid from ',fromdb,'.invoicedoccompmap where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicetermsmap select * FROM ',fromdb,'.invoicetermsmap where invoice in (select id from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receipttermsmap select * FROM ',fromdb,'.receipttermsmap where goodsreceipt in (select id from ',fromdb,'.goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedjememo select * FROM ',fromdb,'.repeatedjememo where repeatedinv in (select repeateinvoice from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedjememo select * FROM ',fromdb,'.repeatedjememo where repeatedso in (select repeateso from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedjememo select * FROM ',fromdb,'.repeatedjememo where repeatedpayment in (select repeatpayment from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedje SELECT * from ',fromdb,'.repeatedje');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedinvoices select * FROM ',fromdb,'.repeatedinvoices where id in (select repeateinvoice from ',fromdb,'.invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedinvoices select * FROM ',fromdb,'.repeatedinvoices where id in (select repeateinvoice from ',fromdb,'.goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedsalesorders select * FROM ',fromdb,'.repeatedsalesorders where id in (select repeateso from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.deliveryplannerannouncement select * FROM ',fromdb,'.deliveryplannerannouncement where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.deliveryplanner select * FROM ',fromdb,'.deliveryplanner where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicewriteoff select * FROM ',fromdb,'.invoicewriteoff where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoice select * FROM ',fromdb,'.invoice where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dndiscount select * FROM ',fromdb,'.dndiscount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dndetails select * FROM ',fromdb,'.dndetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dndetailsgst select * FROM ',fromdb,'.dndetailsgst where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.debitnotepayment select * FROM ',fromdb,'.debitnotepayment where dnid in (select id from ',fromdb,'.debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.debitnotetermmap select * FROM ',fromdb,'.debitnotetermmap where debitnote in (select id from ',fromdb,'.debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.debitnotedetailtermmap select * FROM ',fromdb,'.debitnotedetailtermmap where debitnotetaxentry in (select id from ',fromdb,'.dntaxentry where debitnote in (select id from ',fromdb,'.debitnote where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dntaxentry select * FROM ',fromdb,'.dntaxentry where debitnote in (select id from ',fromdb,'.debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.openingbalancedebitnotecustomdata SELECT * FROM ',fromdb,'.openingbalancedebitnotecustomdata WHERE openingbalancedebitnoteid in (SELECT id from ',fromdb,'.debitnote  WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.debitnotelinking SELECT * FROM ',fromdb,'.debitnotelinking WHERE docid in (SELECT id from ',fromdb,'.debitnote  WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.challannumber select * FROM ',fromdb,'.challannumber where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.compprintersetting select * FROM ',fromdb,'.compprintersetting where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customwidgetreports select * FROM ',fromdb,'.customwidgetreports where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.docs select * FROM ',fromdb,'.docs where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.comment select * FROM ',fromdb,'.comment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.debitnoteinvoicemappinginfo select * FROM ',fromdb,'.debitnoteinvoicemappinginfo where debitnote in (select id from ',fromdb,'.debitnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.debitnote select * FROM ',fromdb,'.debitnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.paymentdetailotherwise select * FROM ',fromdb,'.paymentdetailotherwise where payment in (select id from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.paymentdetail select * FROM ',fromdb,'.paymentdetail where payment in (select id from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linkdetailpayment select * FROM ',fromdb,'.linkdetailpayment where payment in (select id from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.advancedetail select * FROM ',fromdb,'.advancedetail where payment in (select id from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.advancedetailtermmap select * FROM ',fromdb,'.advancedetailtermmap where advanceDetail in (select id from ',fromdb,'.advancedetail where payment in (select id from ',fromdb,'.payment where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedpaymentchequedetail select * FROM ',fromdb,'.repeatedpaymentchequedetail where repeatedpaymentid in (select repeatpayment from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedpayment select * FROM ',fromdb,'.repeatedpayment where id in (select repeatpayment from ',fromdb,'.payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.paymentlinking SELECT *  FROM ',fromdb,'.paymentlinking WHERE docid in (SELECT id from ',fromdb,'.payment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;                        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.payment select * FROM ',fromdb,'.payment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.expenseggrdetails select * FROM ',fromdb,'.expenseggrdetails where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.lccmanualwiseproductamount select * FROM ',fromdb,'.lccmanualwiseproductamount WHERE grdetailid in (select id from ',fromdb,'.grdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grdetails select * FROM ',fromdb,'.grdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.openingbalancevendorinvoicecustomdata SELECT *  FROM ',fromdb,'.openingbalancevendorinvoicecustomdata WHERE openingbalancevendorinvoiceid in (SELECT id from ',fromdb,'.goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceiptlinking SELECT *  FROM ',fromdb,'.goodsreceiptlinking WHERE docid in (SELECT id from ',fromdb,'.goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceipt select * FROM ',fromdb,'.goodsreceipt where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.prdetailscustomdata select * FROM ',fromdb,'.prdetailscustomdata where prdetailsid in (select id from ',fromdb,'.prdetails  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.prdetails select * FROM ',fromdb,'.prdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.prflowtargets select * FROM ',fromdb,'.prflowtargets where flowid in (select id from ',fromdb,'.prflow where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.prflow select * FROM ',fromdb,'.prflow where companyid= ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchasereturntermsmap select * FROM ',fromdb,'.purchasereturntermsmap where purchasereturn in (select id from ',fromdb,'.purchasereturn where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchasereturncustomdata select * FROM ',fromdb,'.purchasereturncustomdata where purchasereturnid in (select id from ',fromdb,'.purchasereturn where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchasereturnlinking select * FROM ',fromdb,'.purchasereturnlinking where docid in (select id from ',fromdb,'.purchasereturn where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchasereturn select * FROM ',fromdb,'.purchasereturn where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.srdetailscustomdata select * FROM ',fromdb,'.srdetailscustomdata where srdetailsid in (select id from ',fromdb,'.srdetails where salesreturn in (select id from ',fromdb,'.salesreturn where  company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.srdetails select * FROM ',fromdb,'.srdetails where salesreturn in (select id from ',fromdb,'.salesreturn where  company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesreturntermsmap select * FROM ',fromdb,'.salesreturntermsmap where salesreturn in (select id from ',fromdb,'.salesreturn where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesreturncustomdata select * FROM ',fromdb,'.salesreturncustomdata where salesreturnid in (select id from ',fromdb,'.salesreturn where  company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesreturnlinking select * FROM ',fromdb,'.salesreturnlinking where docid in (select id from ',fromdb,'.salesreturn where  company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesreturn select * FROM ',fromdb,'.salesreturn where  company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grodetailscustomdata select * FROM ',fromdb,'.grodetailscustomdata where grodetailsid in (select id from ',fromdb,'.grodetails where grorder in (select id from ',fromdb,'.grorder where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grodstockoutistmapping select * FROM ',fromdb,'.grodstockoutistmapping where grodetails in (select id from ',fromdb,'.grodetails where grorder in (select id from ',fromdb,'.grorder where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grodetails select * FROM ',fromdb,'.grodetails where grorder in (select id from ',fromdb,'.grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceiptorderlinking select * FROM ',fromdb,'.goodsreceiptorderlinking where docid in (select id from ',fromdb,'.grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grordercustomdata select * FROM ',fromdb,'.grordercustomdata where goodsreceiptorderid in (select id from ',fromdb,'.grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceiptordertermmap select * FROM ',fromdb,'.goodsreceiptordertermmap where goodsreceiptorder in (select id from ',fromdb,'.grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grorder select * FROM ',fromdb,'.grorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingcndiscount select * FROM ',fromdb,'.billingcndiscount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingcndetails select * FROM ',fromdb,'.billingcndetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingcreditnote select * FROM ',fromdb,'.billingcreditnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingreceiptdetails select * FROM ',fromdb,'.billingreceiptdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingreceiptdetailotherwise select * FROM ',fromdb,'.billingreceiptdetailotherwise where billingreceipt in (select id from ',fromdb,'.billingreceipt  where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingreceipt select * FROM ',fromdb,'.billingreceipt where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billinginvoicedetails select * FROM ',fromdb,'.billinginvoicedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billinginvoice select * FROM ',fromdb,'.billinginvoice where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingdndiscount select * FROM ',fromdb,'.billingdndiscount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingdndetails select * FROM ',fromdb,'.billingdndetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingdebitnote select * FROM ',fromdb,'.billingdebitnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingpaymentdetails select * FROM ',fromdb,'.billingpaymentdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingpaymentdetailotherwise select * FROM ',fromdb,'.billingpaymentdetailotherwise where billingpayment in (select id from ',fromdb,'.billingpayment  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingpayment select * FROM ',fromdb,'.billingpayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billinggrdetails select * FROM ',fromdb,'.billinggrdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billinggr select * FROM ',fromdb,'.billinggr where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.depriciationdetail select * FROM ',fromdb,'.depriciationdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetdepreciationdetail select * FROM ',fromdb,'.assetdepreciationdetail where assetdetail in (select id from ',fromdb,'.assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetdetailsinvdetailmapping select * FROM ',fromdb,'.assetdetailsinvdetailmapping where assetdetails in (select id from ',fromdb,'.assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.fixedassetopeningmapping select * FROM ',fromdb,'.fixedassetopeningmapping where assetdetails in (select id from ',fromdb,'.assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetmaintenancescheduler select * FROM ',fromdb,'.assetmaintenancescheduler where assetdetails in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetmaintenanceschedulerobject SELECT * FROM ',fromdb,'.assetmaintenanceschedulerobject WHERE assetdetails in (SELECT id from ',fromdb,'.assetdetail WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetdetailcustomdata select * FROM ',fromdb,'.assetdetailcustomdata where assetDetailsId in (select id from ',fromdb,'.assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetdetail select * FROM ',fromdb,'.assetdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.asset select * FROM ',fromdb,'.asset where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pbdetails select * FROM ',fromdb,'.pbdetails where build in (select id from ',fromdb,'.productbuild where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.jedetail select * FROM ',fromdb,'.jedetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.jedetail_optimized select * FROM ',fromdb,'.jedetail_optimized where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accjedetailcustomdata select * FROM ',fromdb,'.accjedetailcustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accjecustomdata select * FROM ',fromdb,'.accjecustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repeatedjechequedetail select * FROM ',fromdb,'.repeatedjechequedetail where repeatedjeid in (select repeateje from ',fromdb,'.journalentry where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.revenuejeinvoicemapping select * FROM ',fromdb,'.revenuejeinvoicemapping where jeid in (select id from ',fromdb,'.journalentry where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt; 
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.journalentryupdatehistory select * FROM ',fromdb,'.journalentryupdatehistory WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.journalentry select * FROM ',fromdb,'.journalentry where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesorderdetailcustomdata select * FROM ',fromdb,'.salesorderdetailcustomdata where soDetailID in (select id from ',fromdb,'.sodetails where salesorder in (select id from ',fromdb,'.salesorder where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.sodetailsapprovermapping select * FROM ',fromdb,'.sodetailsapprovermapping where sodetails in (select id from ',fromdb,'.sodetails where salesorder in (select id from ',fromdb,'.salesorder where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.sodetailproductcustomdata select * FROM ',fromdb,'.sodetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.sodetails select * FROM ',fromdb,'.sodetails where salesorder in (select id from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesordercustomdata select * FROM ',fromdb,'.salesordercustomdata where soID in (select id from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesordertermmap select * FROM ',fromdb,'.salesordertermmap where salesorder in (select id from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.solinking select * FROM ',fromdb,'.solinking where docid in (select id from ',fromdb,'.salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesorder select * FROM ',fromdb,'.salesorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingshippingaddresses select * FROM ',fromdb,'.billingshippingaddresses  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.podetailproductcustomdata select * FROM ',fromdb,'.podetailproductcustomdata where poDetailID in (select id from ',fromdb,'.podetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pootherdetails select * FROM ',fromdb,'.pootherdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderdetailcustomdata select * FROM ',fromdb,'.purchaseorderdetailcustomdata where poDetailID in (select id from ',fromdb,'.podetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.podetails select * FROM ',fromdb,'.podetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseordercustomdata select * FROM ',fromdb,'.purchaseordercustomdata where poID in (select id from ',fromdb,'.purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.polinking select * FROM ',fromdb,'.polinking where docid in (select id from ',fromdb,'.purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseordertermmap select * FROM ',fromdb,'.purchaseordertermmap where purchaseorder in (select id from ',fromdb,'.purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.excisedetailsassets select * FROM ',fromdb,'.excisedetailsassets where purchaseorder in (select id from ',fromdb,'.purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorder select * FROM ',fromdb,'.purchaseorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.requestforquotationlinking select * FROM ',fromdb,'.requestforquotationlinking where docid in (select id from ',fromdb,'.requestforquotation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.requestforquotationdetail select * FROM ',fromdb,'.requestforquotationdetail where requestforquotation in (select id from ',fromdb,'.requestforquotation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.requestforquotation select * FROM ',fromdb,'.requestforquotation where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rfqcustomdata select * FROM ',fromdb,'.rfqcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.requestforquotationdetailcustomdata select * FROM ',fromdb,'.requestforquotationdetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaserequisitiondetail select * FROM ',fromdb,'.purchaserequisitiondetail where purchaserequisition in (select id from ',fromdb,'.purchaserequisition where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaserequisitioncustomdata select * FROM ',fromdb,'.purchaserequisitioncustomdata where purchaserequisitionid in (select id from ',fromdb,'.purchaserequisition where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaserequisitiondetailcustomdata select * FROM ',fromdb,'.purchaserequisitiondetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaserequisitionlinking select * FROM ',fromdb,'.purchaserequisitionlinking where docid in (select id from ',fromdb,'.purchaserequisition where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaserequisition select * FROM ',fromdb,'.purchaserequisition where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingsodetails select * FROM ',fromdb,'.billingsodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingsalesorder select * FROM ',fromdb,'.billingsalesorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingpodetails select * FROM ',fromdb,'.billingpodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.billingpurchaseorder select * FROM ',fromdb,'.billingpurchaseorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotationdetailscustomdata select * FROM ',fromdb,'.quotationdetailscustomdata where quotationdetailsid in (select id from ',fromdb,'.quotationdetails where quotation in (select id from ',fromdb,'.quotation where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cqdetailproductcustomdata select * FROM ',fromdb,'.cqdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vqdetailproductcustomdata select * FROM ',fromdb,'.vqdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.prdetailproductcustomdata select * FROM ',fromdb,'.prdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.srdetailproductcustomdata select * FROM ',fromdb,'.srdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grodetailproductcustomdata select * FROM ',fromdb,'.grodetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotationdetails select * FROM ',fromdb,'.quotationdetails where quotation in (select id from ',fromdb,'.quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotationcustomdata select * FROM ',fromdb,'.quotationcustomdata where quotationid in (select id from ',fromdb,'.quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotationtermmap select * FROM ',fromdb,'.quotationtermmap where quotation in (select id from ',fromdb,'.quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cqlinking select * FROM ',fromdb,'.cqlinking where docid in (select id from ',fromdb,'.quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotation select * FROM ',fromdb,'.quotation where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.discount select * FROM ',fromdb,'.discount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.discountmaster select * FROM ',fromdb,'.discountmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.serialcustomdata select * FROM ',fromdb,'.serialcustomdata where serialdocumentmappingid in (select id from ',fromdb,'.serialdocumentmapping where serialid in (select id from ',fromdb,'.newbatchserial where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.locationbatchdocumentapprovermapping select * FROM ',fromdb,'.locationbatchdocumentapprovermapping where locationmapping in (select id from ',fromdb,'.locationbatchdocumentmapping where batchmapid in (select id from ',fromdb,'.newproductbatch where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.locationbatchrejectormapping select * FROM ',fromdb,'.locationbatchrejectormapping where locationdocumentmapping in (select id from ',fromdb,'.locationbatchdocumentmapping where batchmapid in (select id from ',fromdb,'.newproductbatch where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.locationbatchdocumentmapping SELECT * FROM ',fromdb,'.locationbatchdocumentmapping WHERE batchmapid in (SELECT id from ',fromdb,'.newproductbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.serialdocumentapprovermapping select * FROM ',fromdb,'.serialdocumentapprovermapping where serialdocumentmapping in (select id from ',fromdb,'.serialdocumentmapping where serialid in (select id from ',fromdb,'.newbatchserial where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.serialdocumentmapping SELECT * FROM ',fromdb,'.serialdocumentmapping WHERE serialid in (SELECT id from ',fromdb,'.newbatchserial WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.newproductbatch select * FROM ',fromdb,'.newproductbatch where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.newbatchserial select * FROM ',fromdb,'.newbatchserial where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.consignreqapprovermapping select * FROM ',fromdb,'.consignreqapprovermapping where consignmentrequest in (select id from ',fromdb,'.consignreqapprovalrules where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.consignreqapprovalrules select * FROM ',fromdb,'.consignreqapprovalrules where warehouse in (select id from ',fromdb,'.inventorywarehouse where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.inventorywarehouse select * FROM ',fromdb,'.inventorywarehouse where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.consignreqlocmapping select * FROM ',fromdb,'.consignreqlocmapping where inventorylocation in (select id from ',fromdb,'.inventorylocation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.inventorylocation select * FROM ',fromdb,'.inventorylocation where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.inventory select * FROM ',fromdb,'.inventory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productcyclecount select * FROM ',fromdb,'.productcyclecount where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pricelist select * FROM ',fromdb,'.pricelist where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cyclecount select * FROM ',fromdb,'.cyclecount where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpqualitycontrol select * FROM ',fromdb,'.mrpqualitycontrol where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accountopeningtransaction select * FROM ',fromdb,'.accountopeningtransaction where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.bomdetail select * FROM ',fromdb,'.bomdetail where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productassembly select * FROM ',fromdb,'.productassembly where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assemblysubproductbatchserialmapping select * FROM ',fromdb,'.assemblysubproductbatchserialmapping where mainproductserial in (select id from ',fromdb,'.batchserial where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assemblysubproductbatchserialmapping select * FROM ',fromdb,'.assemblysubproductbatchserialmapping where subproductbatch in (select id from ',fromdb,'.productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.batchserialmapping SELECT * FROM ',fromdb,'.batchserialmapping WHERE purchaseSerial in (SELECT id from ',fromdb,'.batchserial WHERE batch in (SELECT id from ',fromdb,'.productbatch WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.replacementproductbatchdetailsmapping select * FROM ',fromdb,'.replacementproductbatchdetailsmapping where batchserial in (select id from ',fromdb,'.batchserial where batch in (select id from ',fromdb,'.productbatch where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.qa_of_buildassemblyproduct select * FROM ',fromdb,'.qa_of_buildassemblyproduct where prbuildid in (select id from ',fromdb,'.productbuild where product in (select id from ',fromdb,'.product where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.returnserialmapping select * FROM ',fromdb,'.returnserialmapping where mapserial in (select id from ',fromdb,'.batchserial where batch in (select id from ',fromdb,'.productbatch where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.batchserial select * FROM ',fromdb,'.batchserial where batch in (select id from ',fromdb,'.productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.returnbatchmapping select * FROM ',fromdb,'.returnbatchmapping where batchmap in (select id from ',fromdb,'.productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salespurchasebatchmapping select * FROM ',fromdb,'.salespurchasebatchmapping where salesBatch in (select id from ',fromdb,'.productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productbatch select * FROM ',fromdb,'.productbatch where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accjedetailproductcustomdata select * FROM ',fromdb,'.accjedetailproductcustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accproductcustomdata select * FROM ',fromdb,'.accproductcustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.fixedassetopening select * FROM ',fromdb,'.fixedassetopening where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.lockassemblyquantitymapping select * FROM ',fromdb,'.lockassemblyquantitymapping where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productbuild select * FROM ',fromdb,'.productbuild where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productcategorymapping select * FROM ',fromdb,'.productcategorymapping where productid in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productcustomfieldhistory select * FROM ',fromdb,'.productcustomfieldhistory where product in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productserial select * FROM ',fromdb,'.productserial where product in (select id from ',fromdb,'.product where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productstockpricelist select * FROM ',fromdb,'.productstockpricelist  where product in (select id from ',fromdb,'.product where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pricingbandmasterdetails select * FROM ',fromdb,'.pricingbandmasterdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pricingbandmaster select * FROM ',fromdb,'.pricingbandmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pricingbandmappingwithvolumedisc select * FROM ',fromdb,'.pricingbandmappingwithvolumedisc where id in (select id from ',fromdb,'.pricingbandmaster where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.packingdodetails select * FROM ',fromdb,'.packingdodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.itemdetail select * FROM ',fromdb,'.itemdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.packingdetails select * FROM ',fromdb,'.packingdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.product select * FROM ',fromdb,'.product where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productdiscountmapping select * FROM ',fromdb,'.productdiscountmapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.amendingprice select * FROM ',fromdb,'.amendingprice  where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.approvalrules select * FROM ',fromdb,'.approvalrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.approvalhistory select * FROM ',fromdb,'.approvalhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultcap SELECT * from ',fromdb,'.defaultcap');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultcap select * FROM ',fromdb,'.defaultcap where vendoraccount in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.ibgreceivingbankdetails select * FROM ',fromdb,'.ibgreceivingbankdetails where vendor in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cimbreceivingdetails select * FROM ',fromdb,'.cimbreceivingdetails where vendor in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.ocbcreceivingdetails select * FROM ',fromdb,'.ocbcreceivingdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendoraddresses select * FROM ',fromdb,'.vendoraddresses where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorcategorymapping select * FROM ',fromdb,'.vendorcategorymapping where vendorid in (select id from ',fromdb,'.vendor where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorcustomdata select * FROM ',fromdb,'.vendorcustomdata where vendorId in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorproductmapping select * FROM ',fromdb,'.vendorproductmapping where vendorid in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationversiondetailscustomdata select * FROM ',fromdb,'.vendorquotationversiondetailscustomdata where quotationdetailsid in (select id from ',fromdb,'.vendorquotationversiondetails  where quotationversion in (select id from ',fromdb,'.vendorquotationversion where vendor in (select id from ',fromdb,'.vendor where company = ?) ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationversioncustomdata select * FROM ',fromdb,'.vendorquotationversioncustomdata where quotationid in (select id from ',fromdb,'.vendorquotationversion where vendor in (select id from ',fromdb,'.vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationversiondetails select * FROM ',fromdb,'.vendorquotationversiondetails where quotationversion in (select id from ',fromdb,'.vendorquotationversion where vendor in (select id from ',fromdb,'.vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationversion select * FROM ',fromdb,'.vendorquotationversion where vendor in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationcustomdata select * FROM ',fromdb,'.vendorquotationcustomdata where vendorquotationid in (select id from ',fromdb,'.vendorquotation where vendor in (select id from ',fromdb,'.vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationdetailscustomdata select * FROM ',fromdb,'.vendorquotationdetailscustomdata where vendorquotationdetailsid in (select id from ',fromdb,'.vendorquotationdetails  where vendorquotation in (select id from ',fromdb,'.vendorquotation where vendor in (select id from ',fromdb,'.vendor where company = ?) ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationtermmap select * FROM ',fromdb,'.vendorquotationtermmap where vendorquotation in (select id from ',fromdb,'.vendorquotation where vendor in (select id from ',fromdb,'.vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationdetails select * FROM ',fromdb,'.vendorquotationdetails where vendorquotation in (select id from ',fromdb,'.vendorquotation where vendor in (select id from ',fromdb,'.vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vqlinking select * FROM ',fromdb,'.vqlinking where docid in (select id from ',fromdb,'.vendorquotation where vendor in (select id from ',fromdb,'.vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotation select * FROM ',fromdb,'.vendorquotation where vendor in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstvendorhistory select * FROM ',fromdb,'.gstvendorhistory where vendor in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendor select * FROM ',fromdb,'.vendor where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendoragentmapping select * FROM ',fromdb,'.vendoragentmapping where vendorid in (select id from ',fromdb,'.vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendoraddressdetails select * FROM ',fromdb,'.vendoraddressdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contractdetailcustomdata select * FROM ',fromdb,'.contractdetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contractcustomdata select * FROM ',fromdb,'.contractcustomdata where contractid in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contractdetails select * FROM ',fromdb,'.contractdetails where contract in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contractfile select * FROM ',fromdb,'.contractfile where contractid  in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.docontractmapping select * FROM ',fromdb,'.docontractmapping where contract in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.maintenance select * FROM ',fromdb,'.maintenance where contract in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productreplacement select * FROM ',fromdb,'.productreplacement where contract in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productreplacementdetail select * FROM ',fromdb,'.productreplacementdetail where contract in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.servicedetails select * FROM ',fromdb,'.servicedetails where contract in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contractdates select * FROM ',fromdb,'.contractdates where contract  in (select id from ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contract select * FROM ',fromdb,'.contract where customer in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customeraddresses select * FROM ',fromdb,'.customeraddresses where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customercategorymapping select * FROM ',fromdb,'.customercategorymapping where customerid in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customercustomdata select * FROM ',fromdb,'.customercustomdata where customerId  in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customerproductmapping select * FROM ',fromdb,'.customerproductmapping where  customerid in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customervendormapping select * FROM ',fromdb,'.customervendormapping where customeraccountid in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultcap select * FROM ',fromdb,'.defaultcap where customeraccount in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.deliveryordercustomdata select * FROM ',fromdb,'.deliveryordercustomdata where deliveryOrderId in (select id from ',fromdb,'.deliveryorder where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dolinking select * FROM ',fromdb,'.dolinking where docid in (select id from ',fromdb,'.deliveryorder where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dodetailscustomdata select * FROM ',fromdb,'.dodetailscustomdata where dodetailsid in (select id from ',fromdb,'.dodetails where deliveryorder in (select id from ',fromdb,'.deliveryorder where customer in (select id from ',fromdb,'.customer where company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dodetailproductcustomdata select * FROM ',fromdb,'.dodetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.wastagedetails select * FROM ',fromdb,'.wastagedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dodistmapping select * FROM ',fromdb,'.dodistmapping where dod in (select id from ',fromdb,'.dodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.shippingdeliverydetails select * FROM ',fromdb,'.shippingdeliverydetails where shippingdo in (select id from ',fromdb,'.shippingdelivery where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.shippingdelivery select * FROM ',fromdb,'.shippingdelivery where customer in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dodetails select * FROM ',fromdb,'.dodetails where deliveryorder in (select id from ',fromdb,'.deliveryorder where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.deliveryordertermmap select * FROM ',fromdb,'.deliveryordertermmap where deliveryorder in (select id from ',fromdb,'.deliveryorder where customer in (select id from ',fromdb,'.customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.deliveryorder select * FROM ',fromdb,'.deliveryorder where customer in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstcustomerhistory select * FROM ',fromdb,'.gstcustomerhistory where customer in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customerwarehousemap select * FROM ',fromdb,'.customerwarehousemap where customer in (select id from ',fromdb,'.customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customeraddressdetails select * FROM ',fromdb,'.customeraddressdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.companyaddressdetails select * FROM ',fromdb,'.companyaddressdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.uobreceivingdetails select * FROM ',fromdb,'.uobreceivingdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customer select * FROM ',fromdb,'.customer where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customizedagedduration select * FROM ',fromdb,'.customizedagedduration  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customizereportmapping select * FROM ',fromdb,'.customizereportmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customizereportheader SELECT * from ',fromdb,'.customizereportheader');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productfieldsandmodulesmapping SELECT * FROM ',fromdb,'.productfieldsandmodulesmapping WHERE  productfieldsandmodulesmapping.fieldid in (SELECT customizereportmapping.id from ',fromdb,'.customizereportmapping WHERE  customizereportmapping.company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.taxlist select * FROM ',fromdb,'.taxlist where tax in (select id from ',fromdb,'.tax where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tax select * FROM ',fromdb,'.tax where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tax1099accounts select * FROM ',fromdb,'.tax1099accounts where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tax1099category select * FROM ',fromdb,'.tax1099category where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.paydetail select * FROM ',fromdb,'.paydetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.chequelayout select * FROM ',fromdb,'.chequelayout where paymentmethod in (select id from ',fromdb,'.paymentmethod where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.labourcustomdata select * FROM ',fromdb,'.labourcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.labour select * FROM ',fromdb,'.labour where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.paymentmethod select * FROM ',fromdb,'.paymentmethod where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.compaccpreferences select * FROM ',fromdb,'.compaccpreferences where id = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.companyholiday select * FROM ',fromdb,'.companyholiday  where id = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.companymapping select * FROM ',fromdb,'.companymapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accountbudget select * FROM ',fromdb,'.accountbudget where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accountforecast select * FROM ',fromdb,'.accountforecast  where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accountmapping select * FROM ',fromdb,'.accountmapping  where childaccountid in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accountcustomdata select * FROM ',fromdb,'.accountcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assethistory select * FROM ',fromdb,'.assethistory where assetid in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.bankreconciliationdetail select * FROM ',fromdb,'.bankreconciliationdetail where bankReconciliation in (select id from ',fromdb,'.bankreconciliation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.bankreconciliation select * FROM ',fromdb,'.bankreconciliation where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.bankreconciliationdraft select * FROM ',fromdb,'.bankreconciliationdraft where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.depriciationdetail select * FROM ',fromdb,'.depriciationdetail where account  in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.closingaccountbalance select * FROM ',fromdb,'.closingaccountbalance where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pnlaccountmap select * FROM ',fromdb,'.pnlaccountmap where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupaccmap select * FROM ',fromdb,'.groupaccmap where layoutgroup in (select id from ',fromdb,'.layoutgroup where template in (select id from ',fromdb,'.templatepnl where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.groupmapfortotal select * FROM ',fromdb,'.groupmapfortotal where groupid in (select id from ',fromdb,'.layoutgroup where template in (select id from ',fromdb,'.templatepnl where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.layoutgroup select * FROM ',fromdb,'.layoutgroup where template in (select id from ',fromdb,'.templatepnl where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.templatepnl select * FROM ',fromdb,'.templatepnl where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.ibgbankdetails select * FROM ',fromdb,'.ibgbankdetails where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cimbbankdetails select * FROM ',fromdb,'.cimbbankdetails where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.ocbcbankdetails select * FROM ',fromdb,'.ocbcbankdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicetermssales select * FROM ',fromdb,'.invoicetermssales where account in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.distributebalance select * FROM ',fromdb,'.distributebalance where accountid in (select id from ',fromdb,'.account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.limitedaccountsmapping select * FROM ',fromdb,'.limitedaccountsmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.account select * FROM ',fromdb,'.account where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.costcenter select * FROM ',fromdb,'.costcenter where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultaccount select * FROM ',fromdb,'.defaultaccount where groupname in (select id from ',fromdb,'.accgroup where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accgroup select * FROM ',fromdb,'.accgroup where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultaccount select * FROM ',fromdb,'.defaultaccount where parent is null and companytype is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accgroup select * FROM ',fromdb,'.accgroup where company is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.userlogin select * FROM ',fromdb,'.userlogin where userid in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.userpermission select * FROM ',fromdb,'.userpermission where roleusermapping in (select id from ',fromdb,'.role_user_mapping where userid in (select userid from ',fromdb,'.users where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.userpermission select * FROM ',fromdb,'.userpermission where roleusermapping is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
--         SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.userpermission select distinct feature, role, permissioncode, roleUserMapping from (SELECT feature,role,permissioncode,roleUserMapping,count(*) as count from ',fromdb,'.userpermission group by feature,role,permissioncode,roleUserMapping) u  WHERE  u.count > 1 and NOT EXISTS (SELECT feature,role,permissioncode,roleUserMapping,count(*) as count from ',todb,'.userpermission group by feature,role,permissioncode,roleUserMapping having count > 1)');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.role_user_mapping select * FROM ',fromdb,'.role_user_mapping where userid in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.role select * FROM ',fromdb,'.role where company is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.role select * FROM ',fromdb,'.role where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rolelist select * FROM ',fromdb,'.rolelist where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rolelist select * FROM ',fromdb,'.rolelist where company is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salescomissionscehma select * FROM ',fromdb,'.salescomissionscehma where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salescommission select * FROM ',fromdb,'.salescommission where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pdfreporttemplate select * FROM ',fromdb,'.pdfreporttemplate where user in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.SAVED_SEARCH_QUERY select * FROM ',fromdb,'.SAVED_SEARCH_QUERY where user in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.audittraildetails SELECT * FROM ',fromdb,'.audittraildetails WHERE auditid IN (SELECT id FROM ',fromdb,'.audit_trail WHERE user IN (select userid from ',fromdb,'.users where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.audit_trail select * FROM ',fromdb,'.audit_trail  where user in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.revaltime select * FROM ',fromdb,'.revaltime where userid  in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.revaluationhistory select * FROM ',fromdb,'.revaluationhistory where userid in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.column_header select * FROM ',fromdb,'.column_header where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.department select * FROM ',fromdb,'.department where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customdesigntemplate select * FROM ',fromdb,'.customdesigntemplate where createdby in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customdesigntemplate select * FROM ',fromdb,'.customdesigntemplate where createdby in (select userid from ',fromdb,'.users where company = "1")');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.emailtemplatefiles select * FROM ',fromdb,'.emailtemplatefiles  where creator in  (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.importlog select * FROM ',fromdb,'.importlog where user in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.projreport_template select * FROM ',fromdb,'.projreport_template where userid  in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.projreport_template select * FROM ',fromdb,'.projreport_template where tempid = "ff80808140a555fe0140a588bcee0007"');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.widgetmanagement select * FROM ',fromdb,'.widgetmanagement where user in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.useractivedaysdetails select * FROM ',fromdb,'.useractivedaysdetails where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.usergroupfieldcombomapping select * FROM ',fromdb,'.usergroupfieldcombomapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.usersgroupmapping select * FROM ',fromdb,'.usersgroupmapping where user in (select userid from ',fromdb,'.users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.usersgroup select * FROM ',fromdb,'.usersgroup where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.loanrules select * FROM ',fromdb,'.loanrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.users select * FROM ',fromdb,'.users where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.passwordpolicy select * FROM ',fromdb,'.passwordpolicy where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.userpreferences select * FROM ',fromdb,'.userpreferences where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.revaluationjecustomdata select * FROM ',fromdb,'.revaluationjecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rest_client_details select * FROM ',fromdb,'.rest_client_details where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.uomschematype select * FROM ',fromdb,'.uomschematype where stockuom in (select id from ',fromdb,'.uom where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.uomschema select * FROM ',fromdb,'.uomschema where purchaseuom in (select id from ',fromdb,'.uom where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.uomschema select * FROM ',fromdb,'.uomschema where salesuom in (select id from ',fromdb,'.uom where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.uom select * FROM ',fromdb,'.uom where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.fieldcombodatamapping select * FROM ',fromdb,'.fieldcombodatamapping where childid in (select id from ',fromdb,'.fieldcombodata where fieldid in (select id from ',fromdb,'.fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.prodcategorygstmapping select * FROM ',fromdb,'.prodcategorygstmapping where prodcategory in (select id from ',fromdb,'.fieldcombodata where fieldid in (select id from ',fromdb,'.fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.entitybasedlineleveltermsrate select * FROM ',fromdb,'.entitybasedlineleveltermsrate where entity in (select id from ',fromdb,'.fieldcombodata where fieldid in (select id from ',fromdb,'.fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.addressfielddimensionmapping select * FROM ',fromdb,'.addressfielddimensionmapping where dimension in (select id from ',fromdb,'.fieldparams where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.multientitydimesioncustomdata select * FROM ',fromdb,'.multientitydimesioncustomdata where fcdid in (select id from ',fromdb,'.fieldcombodata where fieldid in (select id from ',fromdb,'.fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.fieldcombodata select * FROM ',fromdb,'.fieldcombodata where fieldid in (select id from ',fromdb,'.fieldparams where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.fieldparams select * FROM ',fromdb,'.fieldparams where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.apiresponse select * FROM ',fromdb,'.apiresponse where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.chequesequenceformat select * FROM ',fromdb,'.chequesequenceformat where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.sequenceformat select * FROM ',fromdb,'.sequenceformat where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cheque select * FROM ',fromdb,'.cheque where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.masteritemprice select * FROM ',fromdb,'.masteritemprice where type in (select id from ',fromdb,'.pricetype where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.masteritempriceformula select * FROM ',fromdb,'.masteritempriceformula where type collate utf8_general_ci in (select id from ',fromdb,'.pricetype where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.shelflocation select * FROM ',fromdb,'.shelflocation where  company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pdftemplateconfig select * FROM ',fromdb,'.pdftemplateconfig where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pricetype select * FROM ',fromdb,'.pricetype where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetmaintenanceworkorderdetail SELECT * FROM ',fromdb,'.assetmaintenanceworkorderdetail WHERE assetmaintenanceworkorder in (SELECT id from ',fromdb,'.assetmaintenanceworkorder WHERE assignedto in (SELECT id from ',fromdb,'.masteritem WHERE company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.assetmaintenanceworkorder SELECT * FROM ',fromdb,'.assetmaintenanceworkorder WHERE assignedto in (SELECT id from ',fromdb,'.masteritem WHERE company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.itempackingdetails SELECT * FROM ',fromdb,'.itempackingdetails WHERE packingdolistdetails in (SELECT id from ',fromdb,'.packingdolistdetails  WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.shipingdodetails SELECT * FROM ',fromdb,'.shipingdodetails WHERE packingdolistdetails in (SELECT id from ',fromdb,'.packingdolistdetails  WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.packingdolistdetails SELECT * FROM ',fromdb,'.packingdolistdetails WHERE packingdolist in (SELECT id from ',fromdb,'.packingdolist  WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.packingdolist select * FROM ',fromdb,'.packingdolist where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.packages select * FROM ',fromdb,'.packages where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productpricerule select * FROM ',fromdb,'.productpricerule where category in (select id from ',fromdb,'.masteritem where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.upspackagedetails select * FROM ',fromdb,'.upspackagedetails where packing in (select id from ',fromdb,'.packing where company = ? ) ');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.packing select * FROM ',fromdb,'.packing where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.masteritem select * FROM ',fromdb,'.masteritem where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.moduletemplate select * FROM ',fromdb,'.moduletemplate where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.multilevelapprovalruletargetusers select * FROM ',fromdb,'.multilevelapprovalruletargetusers where ruleid in (select id from ',fromdb,'.multilevelapprovalrule where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.multilevelapprovalrule select * FROM ',fromdb,'.multilevelapprovalrule where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mailnotification select * FROM ',fromdb,'.mailnotification where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mailnotification select * FROM ',fromdb,'.mailnotification where company is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.notifictionrulesrecurringdetail select * FROM ',fromdb,'.notifictionrulesrecurringdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.notetype select * FROM ',fromdb,'.notetype where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.extracompanypreferences select * FROM ',fromdb,'.extracompanypreferences where id = (select companyid from ',fromdb,'.company where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.exchangeratedetails select * FROM ',fromdb,'.exchangeratedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.girofileinfo select * FROM ',fromdb,'.girofileinfo where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.girofilelog select * FROM ',fromdb,'.girofilelog where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.yearlock select * FROM ',fromdb,'.yearlock where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.yearendchecklist select * FROM ',fromdb,'.yearendchecklist where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpaddressdetails select * FROM ',fromdb,'.mrpaddressdetails where mrpcontract in (select id from ',fromdb,'.mrpcontract where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workcentrecustomdata select * FROM ',fromdb,'.workcentrecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machinecustomdata select * FROM ',fromdb,'.machinecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workordercustomdata select * FROM ',fromdb,'.workordercustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractcustomdata select * FROM ',fromdb,'.mrpcontractcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractdetailscustomdata select * FROM ',fromdb,'.mrpcontractdetailscustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;                
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.routingtemplatecustomdata select * FROM ',fromdb,'.routingtemplatecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;                
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractdetails select * FROM ',fromdb,'.mrpcontractdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractdocmappingtemp select * FROM ',fromdb,'.mrpcontractdocmappingtemp where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractdocmapping select * FROM ',fromdb,'.mrpcontractdocmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.product_workcentre_mapping select * FROM ',fromdb,'.product_workcentre_mapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.material_workcentre_mapping select * FROM ',fromdb,'.material_workcentre_mapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machinemanratio select * FROM ',fromdb,'.machinemanratio where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machinecost select * FROM ',fromdb,'.machinecost where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machine_process_mapping select * FROM ',fromdb,'.machine_process_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.substitute_machine_mapping select * FROM ',fromdb,'.substitute_machine_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machine_work_center_mapping select * FROM ',fromdb,'.machine_work_center_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrp_job_order select * FROM ',fromdb,'.mrp_job_order where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.routing_template select * FROM ',fromdb,'.routing_template where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workorder select * FROM ',fromdb,'.workorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontractmapping select * FROM ',fromdb,'.mrpcontractmapping where mrpcontract in (select id from ',fromdb,'.mrpcontract where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workorder_labour_mapping select * FROM ',fromdb,'.workorder_labour_mapping where workorderid in (select id from ',fromdb,'.workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workorder_workcentre_mapping select * FROM ',fromdb,'.workorder_workcentre_mapping where workorderid in (select id from ',fromdb,'.workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workorder_machine_mapping select * FROM ',fromdb,'.workorder_machine_mapping where workorderid in (select id from ',fromdb,'.workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.routingtemplate_labour_mapping select * FROM ',fromdb,'.routingtemplate_labour_mapping where labourid in (select id from ',fromdb,'.labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.routingtemplate_machine_mapping select * FROM ',fromdb,'.routingtemplate_machine_mapping where machineid in (select id from ',fromdb,'.machine where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workordercomponentdetail select * FROM ',fromdb,'.workordercomponentdetail where workorder in (select id from ',fromdb,'.workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.creditterm select * FROM ',fromdb,'.creditterm where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.taxtermsmapping select * FROM ',fromdb,'.taxtermsmapping where tax in (select id from ',fromdb,'.tax where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.locationlevelmapping select * FROM ',fromdb,'.locationlevelmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.showcustomcolumninreport select * FROM ',fromdb,'.showcustomcolumninreport where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.globalheaderfooter select * FROM ',fromdb,'.globalheaderfooter where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gldescriptionconfig select * FROM ',fromdb,'.gldescriptionconfig where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.stockcustomdata select * FROM ',fromdb,'.stockcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicedoccompmaptemporary select * FROM ',fromdb,'.invoicedoccompmaptemporary where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.accounitng_period_lock_info select * FROM ',fromdb,'.accounitng_period_lock_info where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.resourcecost select * FROM ',fromdb,'.resourcecost where labour in (select id from ',fromdb,'.labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.labourcustomdata select * FROM ',fromdb,'.labourcustomdata where labourId in (select id from ',fromdb,'.labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.labourworkcentremapping select * FROM ',fromdb,'.labourworkcentremapping where labour in (select id from ',fromdb,'.labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.labour_skill_mapping select * FROM ',fromdb,'.labour_skill_mapping where labour in (select id from ',fromdb,'.labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.labour select * FROM ',fromdb,'.labour where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machine_asset_mapping select * FROM ',fromdb,'.machine_asset_mapping where machine in (select id from ',fromdb,'.machine where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.machine select * FROM ',fromdb,'.machine where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.mrpcontract select * FROM ',fromdb,'.mrpcontract where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.workcenter select * FROM ',fromdb,'.workcenter where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.jobworkcustomdata select * FROM ',fromdb,'.jobworkcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.widgetreportmaster select * FROM ',fromdb,'.widgetreportmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.forecastproductmapping select * FROM ',fromdb,'.forecastproductmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.forecasttemplate select * FROM ',fromdb,'.forecasttemplate where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.consolidationexchangeratedetails select * FROM ',fromdb,'.consolidationexchangeratedetails WHERE consolidationdata IN ( SELECT id FROM ',fromdb,'.consolidationdata WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.consolidationdata select * FROM ',fromdb,'.consolidationdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.forecastproductmapping select * FROM ',fromdb,'.forecastproductmapping WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.forecasttemplate select * FROM ',fromdb,'.forecasttemplate WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.documentemailsettings select * FROM ',fromdb,'.documentemailsettings WHERE id = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dashboard select * FROM ',fromdb,'.dashboard where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.favouritereportmaster select * FROM ',fromdb,'.favouritereportmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.uobbankdetails select * FROM ',fromdb,'.uobbankdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.girofilegenerationhistory select * FROM ',fromdb,'.girofilegenerationhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salescommissionrulecondition select * FROM ',fromdb,'.salescommissionrulecondition where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salescommissionrules select * FROM ',fromdb,'.salescommissionrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salescommissionschemamaster select * FROM ',fromdb,'.salescommissionschemamaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.companyreportconfiguration select * FROM ',fromdb,'.companyreportconfiguration where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.integrationparty select * FROM ',fromdb,'.integrationparty');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.integrationpartycountrymapping select * FROM ',fromdb,'.integrationpartycountrymapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.integrationdetails select * FROM ',fromdb,'.integrationdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.importfilecolumnmapping select * FROM ',fromdb,'.importfilecolumnmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.importfiledetails select * FROM ',fromdb,'.importfiledetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grid_config select * FROM ',fromdb,'.grid_config where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.erp_pos_mapping select * FROM ',fromdb,'.erp_pos_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cashouttransaction select * FROM ',fromdb,'.cashouttransaction where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.pospaydetail select * FROM ',fromdb,'.pospaydetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

         # start inventory tables
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_seqmodule SELECT * from ',fromdb,'.in_seqmodule');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_frequency SELECT * from ',fromdb,'.in_frequency');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_criteria_detail select * FROM ',fromdb,'.in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_interstoretransfer WHERE company = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_criteria_detail select * FROM ',fromdb,'.in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_goodsrequest WHERE company = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_criteria_detail select * FROM ',fromdb,'.in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_sa_detail_approval WHERE sa_approval IN(SELECT id FROM ',fromdb,'.in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'.in_stockadjustment WHERE company = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_detail select * FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_interstoretransfer WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_detail select * FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_goodsrequest WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_detail select * FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_sa_detail_approval WHERE sa_approval IN(SELECT id FROM ',fromdb,'.in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'.in_stockadjustment WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stocktransfer_detail_approval select * FROM ',fromdb,'.in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_interstoretransfer WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stocktransfer_detail_approval select * FROM ',fromdb,'.in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_goodsrequest WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sa_detail_approval select * FROM ',fromdb,'.in_sa_detail_approval WHERE sa_approval IN(SELECT id FROM ',fromdb,'.in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'.in_stockadjustment WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stocktransfer_approval select * FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_interstoretransfer WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stocktransfer_approval select * FROM ',fromdb,'.in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'.in_goodsrequest WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sa_approval select * FROM ',fromdb,'.in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'.in_stockadjustment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_criteria_detail select * FROM ',fromdb,'.in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_consignmentdetails WHERE consignment IN (SELECT id FROM ',fromdb,'.in_consignment WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_detail select * FROM ',fromdb,'.in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'.in_consignmentdetails WHERE consignment IN (SELECT id FROM ',fromdb,'.in_consignment WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_consignmentdetails select * FROM ',fromdb,'.in_consignmentdetails WHERE consignment IN (SELECT id FROM ',fromdb,'.in_consignment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_consignment select * FROM ',fromdb,'.in_consignment WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stockbooking_detail select * FROM ',fromdb,'.in_stockbooking_detail WHERE stockbooking IN (SELECT id FROM ',fromdb,'.in_stockbooking WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stockbooking select * FROM ',fromdb,'.in_stockbooking WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_documents select * FROM ',fromdb,'.in_documents WHERE id IN (SELECT documentid FROM ',fromdb,'.in_documentcompmap WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_documentcompmap select * FROM ',fromdb,'.in_documentcompmap WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_store_executive select * FROM ',fromdb,'.in_store_executive WHERE storeid IN (SELECT id FROM ',fromdb,'.in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_store_movementtype select * FROM ',fromdb,'.in_store_movementtype WHERE storeid IN (SELECT id FROM ',fromdb,'.in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_temp_stockadjustmentdetail select * FROM ',fromdb,'.in_temp_stockadjustmentdetail WHERE store IN (SELECT id FROM ',fromdb,'.in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_seqnumber select * FROM ',fromdb,'.in_seqnumber WHERE seqformat IN ( SELECT id FROM ',fromdb,'.in_seqformat WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_store_location select * FROM ',fromdb,'.in_store_location WHERE storeid IN (SELECT id FROM ',fromdb,'.in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_store_user select * FROM ',fromdb,'.in_store_user WHERE storeid IN (SELECT id FROM ',fromdb,'.in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_attachedserial select * FROM ',fromdb,'.in_attachedserial WHERE attachedbatch IN ( SELECT id FROM ',fromdb,'.in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sr_attachedbatch select * FROM ',fromdb,'.in_sr_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'.in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sa_attachedbatch select * FROM ',fromdb,'.in_sa_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'.in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_ist_attachedbatch select * FROM ',fromdb,'.in_ist_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'.in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sm_attachedbatch select * FROM ',fromdb,'.in_sm_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'.in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_cc_attachedbatch select * FROM ',fromdb,'.in_cc_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'.in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sr_detail select * FROM ',fromdb,'.in_sr_detail WHERE stockrequest IN ( SELECT id FROM ',fromdb,'.in_goodsrequest WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sa_detail select * FROM ',fromdb,'.in_sa_detail WHERE stockadjustment IN ( SELECT id FROM ',fromdb,'.in_stockadjustment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_ist_detail select * FROM ',fromdb,'.in_ist_detail WHERE istrequest IN ( SELECT id FROM ',fromdb,'.in_interstoretransfer WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sm_detail select * FROM ',fromdb,'.in_sm_detail WHERE stockmovement IN ( SELECT id FROM ',fromdb,'.in_stockmovement WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_cc_detail select * FROM ',fromdb,'.in_cc_detail WHERE cyclecount IN ( SELECT id FROM ',fromdb,'.in_cyclecount WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_sr_stockbuffer select * FROM ',fromdb,'.in_sr_stockbuffer WHERE stockrequest IN ( SELECT id FROM ',fromdb,'.in_goodsrequest WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_ist_stockbuffer select * FROM ',fromdb,'.in_ist_stockbuffer WHERE istrequest IN ( SELECT id FROM ',fromdb,'.in_interstoretransfer WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_cccalendar_frequency select * FROM ',fromdb,'.in_cccalendar_frequency WHERE cc_calendarid IN ( SELECT id FROM ',fromdb,'.in_cyclecount_calendar WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cyclecountcustomdata select * FROM ',fromdb,'.cyclecountcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_cyclecount_calendar select * FROM ',fromdb,'.in_cyclecount_calendar WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_cyclecount select * FROM ',fromdb,'.in_cyclecount WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_cyclecountdraft select * FROM ',fromdb,'.in_cyclecountdraft WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stock select * FROM ',fromdb,'.in_stock WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_goodsrequest select * FROM ',fromdb,'.in_goodsrequest WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_interstoretransfer select * FROM ',fromdb,'.in_interstoretransfer WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stockadjustment select * FROM ',fromdb,'.in_stockadjustment WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stockadjustmentdraft select * FROM ',fromdb,'.in_stockadjustmentdraft WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stockmovement select * FROM ',fromdb,'.in_stockmovement WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_packaging select * FROM ',fromdb,'.in_packaging WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_storemaster select * FROM ',fromdb,'.in_storemaster WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.storemaster select * FROM ',fromdb,'.storemaster WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_location select * FROM ',fromdb,'.in_location WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_seqformat select * FROM ',fromdb,'.in_seqformat WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inventoryconfig select * FROM ',fromdb,'.in_inventoryconfig WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.inventory_thread_running_status select * FROM ',fromdb,'.inventory_thread_running_status  WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.notifictionrulesrecurringdetail select * FROM ',fromdb,'.notifictionrulesrecurringdetail  WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.documentrecurringmailrecord select * FROM ',fromdb,'.documentrecurringmailrecord  WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_attachedbatch select * FROM ',fromdb,'.in_attachedbatch  WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_area select * FROM ',fromdb,'.in_inspection_area  WHERE inspection_template IN ( SELECT id FROM ',fromdb,'.in_inspection_template WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_inspection_template select * FROM ',fromdb,'.in_inspection_template WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_interstoretransfer_customdata select * FROM ',fromdb,'.in_interstoretransfer_customdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.in_stockadjustment_customdata select * FROM ',fromdb,'.in_stockadjustment_customdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        # End Inventory Tables

        # For Indonesia Country, Tax Currency tables.
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.taxexchangerate SELECT * from ',fromdb,'.taxexchangerate');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.taxexchangeratedetails select * FROM ',fromdb,'.taxexchangeratedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        # India Compliance Tables
        # No company column but used as foreign key.
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.state select * FROM ',fromdb,'.state WHERE id IN ( SELECT state FROM ',fromdb,'.company WHERE companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.default_tds_rate SELECT * from ',fromdb,'.default_tds_rate');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultstatevalues select * FROM ',fromdb,'.defaultstatevalues WHERE id IN ( SELECT state FROM ',fromdb,'.company WHERE companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.producttermsmap select * FROM ',fromdb,'.producttermsmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptdetailtermsmap select * FROM ',fromdb,'.receiptdetailtermsmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptorderdetailtermsmap select * FROM ',fromdb,'.receiptorderdetailtermsmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.deliveryorderdetailtermsmap select * FROM ',fromdb,'.deliveryorderdetailtermsmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.vendorquotationdetailstermmap select * FROM ',fromdb,'.vendorquotationdetailstermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchasereturndetailtermmap select * FROM ',fromdb,'.purchasereturndetailtermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesreturndetailtermmap select * FROM ',fromdb,'.salesreturndetailtermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesorderdetailtermmap select * FROM ',fromdb,'.salesorderdetailtermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotationdetailtermmap select * FROM ',fromdb,'.quotationdetailtermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.invoicedetailtermsmap select * FROM ',fromdb,'.invoicedetailtermsmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderdetailstermmap select * FROM ',fromdb,'.purchaseorderdetailstermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.securitygatedetailstermmap select * FROM ',fromdb,'.securitygatedetailstermmap WHERE term IN ( SELECT id FROM ',fromdb,'.linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.exciseInvoicedetails select * FROM ',fromdb,'.exciseInvoicedetails WHERE goodsreceipt IN ( SELECT id FROM ',fromdb,'.goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.salesinvoiceexcisedetailsmap select * FROM ',fromdb,'.salesinvoiceexcisedetailsmap WHERE invoice IN ( SELECT id FROM ',fromdb,'.invoice WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceiptpaymentmapping select * FROM ',fromdb,'.goodsreceiptpaymentmapping WHERE goodsreceiptid IN ( SELECT id FROM ',fromdb,'.goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.lccmanualwiseproductamount select * FROM ',fromdb,'.lccmanualwiseproductamount WHERE expenseInvoiceid IN ( SELECT id FROM ',fromdb,'.goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceiptid_landedInvoice select * FROM ',fromdb,'.goodsreceiptid_landedInvoice WHERE goodsreceiptid IN ( SELECT id FROM ',fromdb,'.goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productid_landingcostcategoryid select * FROM ',fromdb,'.productid_landingcostcategoryid WHERE productid in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.contractdetailtermsmap select * FROM ',fromdb,'.contractdetailtermsmap WHERE contractDetail IN ( SELECT id FROM ',fromdb,'.contractdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptadvancedetailstermmap select * FROM ',fromdb,'.receiptadvancedetailstermmap where entityterm in (select id from ',fromdb,'.entitybasedlineleveltermsrate where linelevelterms in (select id from ',fromdb,'.linelevelterms where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        # Tax Mapping Data for Avalara Integration (Modules -> Customer Invoice, Customer Quotation, Sales Order, Delivery Order, Sales Return)
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.transactiondetailavalarataxmapping select * FROM ',fromdb,'.transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'.invoicedetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.transactiondetailavalarataxmapping select * FROM ',fromdb,'.transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'.sodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.transactiondetailavalarataxmapping select * FROM ',fromdb,'.transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'.dodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.transactiondetailavalarataxmapping select * FROM ',fromdb,'.transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'.quotationdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.transactiondetailavalarataxmapping select * FROM ',fromdb,'.transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'.srdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.productavalaraidmapping select * FROM ',fromdb,'.productavalaraidmapping WHERE productid IN (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        # have company column
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tds_rate select * FROM ',fromdb,'.tds_rate where company is null');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tds_rate select * FROM ',fromdb,'.tds_rate WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tdsdetails select * FROM ',fromdb,'.tdsdetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.excisedetailstemplatemap select * FROM ',fromdb,'.excisedetailstemplatemap WHERE companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.linelevelterms select * FROM ',fromdb,'.linelevelterms WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customdesigntemplate13 select * FROM ',fromdb,'.customdesigntemplate13 WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dealerexcisedetails select * FROM ',fromdb,'.dealerexcisedetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.supplierexcisedetails select * FROM ',fromdb,'.supplierexcisedetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dealerexciseterm select * FROM ',fromdb,'.dealerexciseterm WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.indiacompliancecompanypreferences SELECT * from ',fromdb,'.indiacompliancecompanypreferences WHERE id=?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.t_landingcostcategory SELECT * from ',fromdb,'.t_landingcostcategory WHERE company=?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseinvoiceurd_jedetail SELECT * from ',fromdb,'.purchaseinvoiceurd_jedetail WHERE company=?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        # No company column or no forign key used.
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.reportschema SELECT * from ',fromdb,'.reportschema');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultchequelayout SELECT * from ',fromdb,'.defaultchequelayout');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultterms SELECT * from ',fromdb,'.defaultterms');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.serverspecificoptions SELECT * from ',fromdb,'.serverspecificoptions');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;

        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultfieldcombovalues SELECT * from ',fromdb,'.defaultfieldcombovalues');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.defaultcustomfields select * FROM ',fromdb,'.defaultcustomfields where stateid in (select id from ',fromdb,'.state where id in (select state from ',fromdb,'.company where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customcurrency select * FROM ',fromdb,'.customcurrency where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.customreportcharts select * FROM ',fromdb,'.customreportcharts where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.brdetailhistory select * FROM ',fromdb,'.brdetailhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.securitygatedetails select * FROM ',fromdb,'.securitygatedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.securitygateentry select * FROM ',fromdb,'.securitygateentry where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.securitygateentrycustomdata select * FROM ',fromdb,'.securitygateentrycustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.securitygateentrydetailcustomdata select * FROM ',fromdb,'.securitygateentrydetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.cashdenomination select * FROM ',fromdb,'.cashdenomination where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.companyregister select * FROM ',fromdb,'.companyregister where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.grodetailistmapping select * FROM ',fromdb,'.grodetailistmapping where grodetail in (select id from ',fromdb,'.grodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repairgrodistmapping select * FROM ',fromdb,'.repairgrodistmapping where repairstoreistrequest in (select id from ',fromdb,'.in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.wocdetailistmapping select * FROM ',fromdb,'.wocdetailistmapping where wocdetail in (select id from ',fromdb,'.workordercomponentdetail where workorder in (SELECT id from ',fromdb,'.workorder WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.repairwocdistmapping select * FROM ',fromdb,'.repairwocdistmapping where repairstoreistrequest in (select id from ',fromdb,'.in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.dodqcistmapping select * FROM ',fromdb,'.dodqcistmapping where qcistrequest in (select id from ',fromdb,'.in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.rejectdodistmapping select * FROM ',fromdb,'.rejectdodistmapping where repairistrequest in (select id from ',fromdb,'.in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tempproductcompanyid select * FROM ',fromdb,'.tempproductcompanyid where productids in (select id from ',fromdb,'.product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.tdsjemapping select * FROM ',fromdb,'.tdsjemapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.receiptinvoicejemapping select * FROM ',fromdb,'.receiptinvoicejemapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.goodsreceiptdetailpaymentmapping select * FROM ',fromdb,'.goodsreceiptdetailpaymentmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.landingcostdetailmapping select * FROM ',fromdb,'.landingcostdetailmapping where expenseinvoiceid IN (Select id from ',fromdb,'.goodsreceipt where company=?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstreturn select * FROM ',fromdb,'.gstreturn where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstr2submission select * FROM ',fromdb,'.gstr2submission where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderversion select * FROM ',fromdb,'.purchaseorderversion where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderversioncustomdata select * FROM ',fromdb,'.purchaseorderversioncustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.poversiondetails select * FROM ',fromdb,'.poversiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderversiondetailcustomdata select * FROM ',fromdb,'.purchaseorderversiondetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.expensepoversiondetails select * FROM ',fromdb,'.expensepoversiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.expensepoversiondetailcustomdata select * FROM ',fromdb,'.expensepoversiondetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderversiondetailstermmap select * FROM ',fromdb,'.purchaseorderversiondetailstermmap where povdetails IN (select id FROM ',fromdb,'.poversiondetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.purchaseorderversiontermmap select * FROM ',fromdb,'.purchaseorderversiontermmap where purchaseorderversion IN (select id FROM ',fromdb,'.purchaseorderversion where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.quotationdetailsvendormapping SELECT * from ',fromdb,'.quotationdetailsvendormapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.sodetailsvendormapping SELECT * from ',fromdb,'.sodetailsvendormapping');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.bankaccountcoamapping select * FROM ',fromdb,'.bankaccountcoamapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gstform5esubmissiondetails select * FROM ',fromdb,'.gstform5esubmissiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.gsttransactionlistingsubmissiondetails select * FROM ',fromdb,'.gsttransactionlistingsubmissiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        SET @sql_text = concat('INSERT IGNORE INTO ',todb,'.company select * FROM ',fromdb,'.company where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        
        SET foreign_key_checks = 1;
END//
delimiter ;
