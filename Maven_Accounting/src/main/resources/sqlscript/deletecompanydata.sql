DROP PROCEDURE IF EXISTS deletecompanydata;
delimiter //
CREATE PROCEDURE deletecompanydata(fromdb varchar(50),dmn varchar(50))
BEGIN
SET @x_subdomain = dmn;

SET foreign_key_checks = 0;

    IF fromdb<>'' THEN
       SET fromdb = concat(fromdb,'.');
    END IF;

SET @sql_text = concat('SELECT DISTINCT companyid into @x_companyid from ',fromdb,'company where subdomain =?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_subdomain;DEALLOCATE PREPARE stmt;
	
--         SET @sql_text = concat('DELETE FROM ',fromdb,'.croneschedule');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        # For India Compliance
        # No company column but used as foreign key.
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'quotation WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'salesorder WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'invoice WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'deliveryorder WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'salesreturn WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'receipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'creditnote WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'vendorquotation WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'purchaseorder WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'grorder WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'purchasereturn WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'payment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstdocumenthistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'debitnote WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'quotationdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'sodetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'invoicedetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'dodetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'srdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'receiptadvancedetail WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'cntaxentry WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'vendorquotationdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'podetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'grdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'grodetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'prdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'advancedetail WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttaxclasshistory  WHERE refdocid IN ( SELECT id FROM ',fromdb,'dntaxentry WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'exciseInvoicedetails  WHERE goodsreceipt IN ( SELECT id FROM ',fromdb,'goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesinvoiceexcisedetailsmap  WHERE invoice IN ( SELECT id FROM ',fromdb,'invoice WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderversiondetailstermmap where povdetails IN (select id FROM ',fromdb,'poversiondetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderversiontermmap where purchaseorderversion IN (select id FROM ',fromdb,'purchaseorderversion where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderversiondetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderversioncustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'expensepoversiondetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'poversiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'expensepoversiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderversion where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'landingcostdetailmapping WHERE expenseinvoiceid IN ( SELECT id FROM ',fromdb,'goodsreceipt WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productbranddiscountdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceiptdetailpaymentmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'taxadjustment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptinvoicejemapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'baddebtinvoicemapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'baddebtpurchaseinvoicemapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailpaymenttoadvancepayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailreceipttoadvancepayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailreceipttodebitnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailpaymenttocreditnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailreceipttoadvancepayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailpaymenttoadvancepayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptdetails where receipt in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptadvancedetail where receipt in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailreceipt where receipt in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptdetailotherwise where receipt in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptdetailsloan where receipt in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'openingbalancereceiptcustomdata where openingbalancereceiptid in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptwriteoff where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptlinking where docid in (select id from receipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receipt where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cndiscount where creditnote in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cndetailsgst where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'cndetails where creditNote in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditnotedetailtermmap where creditnotetaxentry in (select id from cntaxentry where creditnote in (select id from creditnote where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cntaxentry where creditnote in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditnotetermmap where creditnote in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultgroupaccmap where defaultlayoutgroup in (select id from defaultlayoutgroup  where template in (select id from defaulttemplatepnl where country in (select id from country where id in (select id from company where companyid = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultgroupmapfortotal where groupid in (select id from defaultlayoutgroup  where template in (select id from defaulttemplatepnl where country in (select id from country where id in (select id from company where companyid = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultlayoutgroup where template in (select id from defaulttemplatepnl where country in (select id from country where id in (select id from company where companyid = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaulttemplatepnl where country in (select id from country where id in (select id from company where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditnotpayment where cnid in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'openingbalancecreditnotecustomdata where openingbalancecreditnoteid in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditterm where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditnotelinking where docid in (select id from creditnote where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditnoteinvoicemappinginfo where creditnote in (select id from creditnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'cnoverchargelinkamountdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'loanrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'repaymentdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'disbursement where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicedetails where invoice in (select id from invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'excludedoutstandingrecords  where invoice in (select id from invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'openingbalanceinvoicecustomdata  where openingbalanceinvoiceid in (select id from invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicecontractmapping where invoice in (select id from invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicedoccompmap where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicedocuments where id in (select documentid from invoicedoccompmap where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicetermsmap where invoice in (select id from invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receipttermsmap where goodsreceipt in (select id from goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('update ',fromdb,'invoice set parentinvoice = null  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoice where parentinvoice is not null and company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'repeatedinvoices where id in (select repeateinvoice from ',fromdb,'invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'repeatedinvoices where id in (select repeateinvoice from ',fromdb,'goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'repeatedsalesorders where id in (select repeateso from ',fromdb,'salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'deliveryplannerannouncement where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'deliveryplanner where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicewriteoff where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicelinking where docid in (select id from invoice where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoice where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoiceinused where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dndiscount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dndetailsgst where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'dndetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'debitnotepayment where dnid in (select id from debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'debitnotetermmap where debitnote in (select id from debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'debitnotedetailtermmap where debitnotetaxentry in (select id from dntaxentry where debitnote in (select id from debitnote where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dntaxentry where debitnote in (select id from debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'openingbalancedebitnotecustomdata where openingbalancedebitnoteid in (select id from debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'debitnotelinking where docid in (select id from debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'debitnoteinvoicemappinginfo where debitnote in (select id from debitnote  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'challannumber where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'compprintersetting where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'debitnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'paymentdetailotherwise where payment in (select id from payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'paymentdetail where payment in (select id from payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linkdetailpayment where payment in (select id from payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'advancedetailtermmap where advanceDetail in (select id from ',fromdb,'advancedetail where payment in (select id from ',fromdb,'payment where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'advancedetail where payment in (select id from payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'openingbalancemakepaymentcustomdata where openingbalancemakepaymentid in (select id from payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'repeatedpaymentchequedetail where repeatedpaymentid in (select repeatpayment from ',fromdb,'payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;       
        SET @sql_text = concat('DELETE FROM ',fromdb,'repeatedpayment where id in (select repeatpayment from ',fromdb,'payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'paymentlinking where docid in (select id from ',fromdb,'payment where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'payment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'expenseggrdetails where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'lccmanualwiseproductamount where grdetailid in (select id from grdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'openingbalancevendorinvoicecustomdata where openingbalancevendorinvoiceid in (select id from goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceiptlinking where docid in (select id from goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceiptid_landedInvoice where goodsreceiptid in (select id from goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceiptpaymentmapping where goodsreceiptid in (select id from goodsreceipt where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceipt where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'tdsjemapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'prdetailscustomdata where prdetailsid in (select id from prdetails  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'prdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'prflowtargets where flowid in (select id from prflow where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'prflow where companyid= ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchasereturntermsmap where purchasereturn in (select id from purchasereturn where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchasereturncustomdata where purchasereturnid in (select id from purchasereturn where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchasereturnlinking where docid in (select id from purchasereturn where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchasereturn where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'srdetailscustomdata where srdetailsid in (select id from srdetails where salesreturn in (select id from salesreturn where  company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'srdetails where salesreturn in (select id from salesreturn where  company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesreturntermsmap where salesreturn in (select id from salesreturn where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesreturncustomdata where salesreturnid in (select id from salesreturn where  company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesreturnlinking where docid in (select id from salesreturn where  company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesreturn where  company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grodetailscustomdata where grodetailsid in (select id from grodetails where grorder in (select id from grorder where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grodstockoutistmapping where grodetails in (select id from grodetails where grorder in (select id from grorder where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grodetails where grorder in (select id from grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grordercustomdata where goodsreceiptorderid in (select id from grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceiptordertermmap where goodsreceiptorder in (select id from grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'goodsreceiptorderlinking where docid in (select id from grorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'grorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingcndiscount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingcndetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingcreditnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingreceiptdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingreceiptdetailotherwise where billingreceipt in (select id from billingreceipt  where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingreceipt where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billinginvoicedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('update ',fromdb,'billinginvoice set parentinvoice = null  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billinginvoice where parentinvoice is not null and  company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billinginvoice where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingdndiscount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingdndetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingdebitnote where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingpaymentdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingpaymentdetailotherwise where billingpayment in (select id from billingpayment  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingpayment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billinggrdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billinggr where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetdetailspurchaserequisitiondetailmapping where purchaserequisitionassetdetails in (select id from purchaserequisitionassetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaserequisitionassetdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'depriciationdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetdepreciationdetail where assetdetail in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetdetailsinvdetailmapping where assetdetails in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'fixedassetopeningmapping where assetdetails in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetmaintenancescheduler where assetdetails in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetmaintenanceschedulerobject where assetdetails in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetdetailcustomdata where assetDetailsId in (select id from assetdetail where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'asset where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pbdetails where build in (select id from productbuild where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'jedetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'jedetail_optimized where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accjedetailcustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accjecustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'repeatedjechequedetail where repeatedjeid in (select repeateje from ',fromdb,'journalentry where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;                
        SET @sql_text = concat('DELETE FROM ',fromdb,'revenuejeinvoicemapping where jeid in (select id from ',fromdb,'journalentry where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;                
        SET @sql_text = concat('DELETE FROM ',fromdb,'journalentryupdatehistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'bankreconciliationdraft where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'journalentry where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesorderdetailcustomdata where soDetailID in (select id from sodetails where salesorder in (select id from salesorder where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'sodetailsapprovermapping where sodetails in (select id from sodetails where salesorder in (select id from salesorder where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;                   
        SET @sql_text = concat('DELETE FROM ',fromdb,'sodetailproductcustomdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'sodetails where salesorder in (select id from salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesordercustomdata where soID in (select id from salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesordertermmap where salesorder in (select id from salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'solinking where docid in (select id from salesorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingshippingaddresses  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'podetailproductcustomdata where poDetailID in (select id from podetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pootherdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderdetailcustomdata where poDetailID in (select id from podetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'podetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseordercustomdata where poID in (select id from purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseordertermmap where purchaseorder in (select id from purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'excisedetailsassets where purchaseorder in (select id from purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'polinking where docid in (select id from purchaseorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'requestforquotationlinking where docid in (select id from requestforquotation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'requestforquotationdetail where requestforquotation in (select id from requestforquotation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'rfqcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'requestforquotationdetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'requestforquotation where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaserequisitiondetail where purchaserequisition in (select id from purchaserequisition where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaserequisitioncustomdata where purchaserequisitionid in (select id from purchaserequisition where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaserequisitiondetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaserequisitionlinking where docid in (select id from purchaserequisition where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaserequisition where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingsodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingsalesorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingpodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'billingpurchaseorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'quotationdetailscustomdata where quotationdetailsid in (select id from quotationdetails where quotation in (select id from quotation where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cqdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vqdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'prdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'srdetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grodetailproductcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'quotationdetails where quotation in (select id from quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'quotationcustomdata where quotationid in (select id from quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'quotationtermmap where quotation in (select id from quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cqlinking where docid in (select id from quotation where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'quotation where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'discount where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productdiscountmapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptadvancedetailstermmap where entityterm in (select id from entitybasedlineleveltermsrate where linelevelterms in (select id from linelevelterms where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'discountmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'locationbatchdocumentapprovermapping where locationmapping in (select id from locationbatchdocumentmapping where batchmapid in (select id from newproductbatch where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'locationbatchrejectormapping where locationdocumentmapping in (select id from locationbatchdocumentmapping where batchmapid in (select id from newproductbatch where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'locationbatchdocumentmapping where batchmapid in (select id from newproductbatch where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'serialcustomdata where serialdocumentmappingid in (select id from serialdocumentmapping where serialid in (select id from newbatchserial where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'serialdocumentapprovermapping where serialdocumentmapping in (select id from serialdocumentmapping where serialid in (select id from newbatchserial where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;           
        SET @sql_text = concat('DELETE FROM ',fromdb,'serialdocumentmapping where serialid in (select id from newbatchserial where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'newproductbatch where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'newbatchserial where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'consignreqapprovermapping where consignmentrequest in (select id from ',fromdb,'consignreqapprovalrules where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'consignreqapprovalrules where warehouse in (select id from ',fromdb,'inventorywarehouse where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'inventorywarehouse where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'consignreqlocmapping where inventorylocation in (select id from ',fromdb,'inventorylocation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'inventorylocation where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'inventory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'budgeting where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productcyclecount where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pricelist where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cyclecount where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpqualitycontrol where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accountopeningtransaction where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'bomdetail where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productassembly where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assemblysubproductbatchserialmapping where mainproductserial in (select id from batchserial where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assemblysubproductbatchserialmapping where subproductbatch in (select id from productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'batchserialmapping where purchaseSerial in (select id from batchserial where batch in (select id from productbatch where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'replacementproductbatchdetailsmapping where batchserial in (select id from batchserial where batch in (select id from productbatch where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'qa_of_buildassemblyproduct where prbuildid in (select id from productbuild where product in (select id from product where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'returnserialmapping where mapserial in (select id from batchserial where batch in (select id from productbatch where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'batchserial where batch in (select id from productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'returnbatchmapping where batchmap in (select id from productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salespurchasebatchmapping where salesBatch in (select id from productbatch where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productbatch where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accjedetailproductcustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accproductcustomdata  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'fixedassetopening where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'lockassemblyquantitymapping where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productbuild where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productcategorymapping where productid in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productcustomfieldhistory where product in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productserial where product in (select id from product where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productstockpricelist  where product in (select id from product where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pricingbandmasterdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pricingbandmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pricingbandmappingwithvolumedisc where id in (select id from pricingbandmaster where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('update ',fromdb,'product set parent = null  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'packingdodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'itemdetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'packingdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productid_landingcostcategoryid where productid in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'product where company = ? and parent is not null');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'docs where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'comment where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'locationlevelmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customcurrency where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customreportcharts where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicedoccompmaptemporary where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accounitng_period_lock_info where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'labourcustomdata where labourId in (select id from labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'labourworkcentremapping where labour in (select id from labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'labour_skill_mapping where labour in (select id from labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'resourcecost where labour in (select id from labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'machine_asset_mapping where machine in (select id from machine where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        # inventory table
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_product_frequency WHERE productid IN ( SELECT id FROM ',fromdb,'product WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt; 
        
        SET @sql_text = concat('DELETE FROM ',fromdb,'customwidgetreports WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'product where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'approvalrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'approvalhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('update ',fromdb,'account set parent = null  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultcap where vendoraccount in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'ibgreceivingbankdetails where vendor in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cimbreceivingdetails where vendor in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'ocbcreceivingdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendoraddresses where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorcategorymapping where vendorid in (select id from vendor where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorcustomdata where vendorId in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorproductmapping where vendorid in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendoragentmapping where vendorid in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationversiondetailscustomdata where quotationdetailsid in (select id from vendorquotationversiondetails  where quotationversion in (select id from vendorquotationversion where vendor in (select id from vendor where company = ?) ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationversioncustomdata where quotationid in (select id from vendorquotationversion where vendor in (select id from vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationversiondetails where quotationversion in (select id from vendorquotationversion where vendor in (select id from vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationversion where vendor in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationcustomdata where vendorquotationid in (select id from vendorquotation where vendor in (select id from vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationdetailscustomdata where vendorquotationdetailsid in (select id from vendorquotationdetails  where vendorquotation in (select id from vendorquotation where vendor in (select id from vendor where company = ?) ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationtermmap where vendorquotation in (select id from vendorquotation where vendor in (select id from vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationdetails where vendorquotation in (select id from vendorquotation where vendor in (select id from vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vqlinking where docid in (select id from vendorquotation where vendor in (select id from vendor where company = ?) )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotation where vendor in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstvendorhistory where vendor in (select id from vendor where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendoraddressdetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'contractdetailcustomdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendor where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'contractcustomdata where contractid in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'contractdetailtermsmap  WHERE contractDetail IN ( SELECT id FROM ',fromdb,'contractdetails WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'contractdetails where contract in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'contractfile where contractid  in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'docontractmapping where contract in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'maintenance where contract in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productreplacement where contract in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productreplacementdetail where contract in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'servicedetails where contract in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'contractdates where contract  in (select id from contract where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'contract where customer in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customeraddresses where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customercategorymapping where customerid in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customercustomdata where customerId  in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customerproductmapping where  customerid in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customervendormapping where customeraccountid in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultcap where customeraccount in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'deliveryordercustomdata where deliveryOrderId in (select id from deliveryorder where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dodetailscustomdata where dodetailsid in (select id from dodetails where deliveryorder in (select id from deliveryorder where customer in (select id from customer where company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dodetailproductcustomdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'wastagedetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dodistmapping where dod in (select id from dodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'shippingdeliverydetails where shippingdo in (select id from shippingdelivery where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'shippingdelivery where customer in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dodetails where deliveryorder in (select id from deliveryorder where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'deliveryordertermmap where deliveryorder in (select id from deliveryorder where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dolinking where docid in (select id from deliveryorder where customer in (select id from customer where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'deliveryorder where customer in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstcustomerhistory where customer in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customerwarehousemap where customer in (select id from customer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customeraddressdetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'uobreceivingdetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'customer where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customizedagedduration  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customizereportmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productfieldsandmodulesmapping where productfieldsandmodulesmapping.fieldid in(select customizereportmapping.id from customizereportmapping where  customizereportmapping.company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'taxlist where tax in (select id from tax where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'tax where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'tax1099accounts where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'tax1099category where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'paydetail where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'chequelayout where paymentmethod in (select id from paymentmethod where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'labourcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'labour where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'paymentmethod where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'compaccpreferences where id = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'companyholiday  where id = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'companymapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('update ',fromdb,'account set depreciationaccont = null  where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accountbudget where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accountforecast  where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accountmapping  where childaccountid in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accountcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assethistory where assetid in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'bankreconciliationdetail where bankReconciliation in (select id from bankreconciliation where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'bankreconciliation where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'depriciationdetail where account  in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'closingaccountbalance where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pnlaccountmap where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'groupaccmap where layoutgroup in (select id from layoutgroup where template in (select id from templatepnl where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'groupmapfortotal where groupid in (select id from layoutgroup where template in (select id from templatepnl where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'layoutgroup where template in (select id from templatepnl where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'templatepnl where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'ibgbankdetails where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cimbbankdetails where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'ocbcbankdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicetermssales where account in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'distributebalance where accountid in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'limitedaccountsmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'bankaccountcoamapping where id in (select id from account where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'account where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'costcenter where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultaccount where groupname in (select id from accgroup where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accgroup where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'userlogin where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('update ',fromdb,'company set creator = null where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'rolepermission where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstformgenerationhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'multientitymapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'taxperiod where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'defaultmobilefieldsetup where id in (select moduleid from mobilefieldsetup where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mobilefieldsetup where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customreports where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'accounitng_period_lock_info where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'userpermission where roleusermapping in (select id from role_user_mapping where userid in (select userid from users where company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'role_user_mapping where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'role where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'rolelist where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salescomissionscehma where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salescommission where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;    
        SET @sql_text = concat('DELETE FROM ',fromdb,'pdfreporttemplate where user in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'SAVED_SEARCH_QUERY where user in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'audittraildetails WHERE auditid IN (SELECT id FROM audit_trail WHERE user IN (SELECT id FROM users WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'audit_trail  where user in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'revaltime where userid  in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'revaluationhistory where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'column_header where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'department where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customdesigntemplate where createdby in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'emailtemplatefiles  where creator in  (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'importlog where user in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'projreport_template where userid in (select userid from users where company = ?) and tempid!="ff80808140a555fe0140a588bcee0007"');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'widgetmanagement where user in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'useractivedaysdetails where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'usergroupfieldcombomapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'usersgroupmapping where user in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'usersgroup where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'disposerevertassets where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'loanrules where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'revaluationjecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'rest_client_details where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'userpreferences where userid in (select userid from users where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'users where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'passwordpolicy where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'uomschematype where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'uomschema where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'uom where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'prodcategorygstmapping where prodcategory in (select id from fieldcombodata where fieldid in (select id from fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'entitybasedlineleveltermsrate where entity in (select id from fieldcombodata where fieldid in (select id from fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'addressfielddimensionmapping where dimension in (select id from fieldparams where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'fieldcombodatamapping where childid in (select id from fieldcombodata where fieldid in (select id from fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'multientitydimesioncustomdata where fcdid in (select id from fieldcombodata where fieldid in (select id from fieldparams where companyid = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'fieldcombodata where fieldid in (select id from fieldparams where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'fieldparams where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'apiresponse where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'chequesequenceformat where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'sequenceformat where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cheque where BankMasterItem in (select id from masteritem where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'masteritemprice where type in (select id from pricetype where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'masteritempriceformula where type in (select id collate utf8_general_ci from pricetype where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'shelflocation where  company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pdftemplateconfig where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pricetype where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productpricerule where category in (select id from masteritem where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetmaintenanceworkorderdetail where assetmaintenanceworkorder in (select id from assetmaintenanceworkorder where assignedto in (select id from masteritem where company = ? ))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'assetmaintenanceworkorder where assignedto in (select id from masteritem where company = ? )');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'itempackingdetails where packingdolistdetails in (select id from packingdolistdetails  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'shipingdodetails where packingdolistdetails in (select id from packingdolistdetails  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'packingdolistdetails where packingdolist in (select id from packingdolist  where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'packingdolist where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'packages where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'upspackagedetails where packing in (select id from packing where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'packing where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'masteritem where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'moduletemplate where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'multilevelapprovalruletargetusers where ruleid in (select id from multilevelapprovalrule where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'multilevelapprovalrule where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mailnotification where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'notetype where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'extracompanypreferences where id = (select companyid from company where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'exchangeratedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'girofileinfo where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'girofilelog where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'yearendchecklist where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'yearlock where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'creditterm where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grid_config where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'expensepodetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'expensepodetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'taxtermsmapping where tax in (select id from tax where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        # MRP Related tables       
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpaddressdetails where mrpcontract in (select id from mrpcontract where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'workcentrecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'machinecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workordercustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontractcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontractdetailscustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'routingtemplatecustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontractdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontractdocmappingtemp where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontractdocmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'product_workcentre_mapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'material_workcentre_mapping where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'machinemanratio where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'machinecost where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'machine_process_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'substitute_machine_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'machine_work_center_mapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrp_job_order where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'routing_template where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workorder where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontractmapping where mrpcontract in (select id from mrpcontract where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workorder_labour_mapping where workorderid in (select id from workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workorder_workcentre_mapping where workorderid in (select id from workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workorder_machine_mapping where workorderid in (select id from workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'routingtemplate_labour_mapping where labourid in (select id from labour where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'routingtemplate_machine_mapping where machineid in (select id from machine where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workordercomponentdetail where workorder in (select id from workorder where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        SET @sql_text = concat('DELETE FROM ',fromdb,'machine where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'mrpcontract where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'workcenter where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'jobworkcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'widgetreportmaster where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'labour where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'forecastproductmapping where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'forecasttemplate where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'consolidationexchangeratedetails  WHERE consolidationdata IN ( SELECT id FROM ',fromdb,'consolidationdata WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'consolidationdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'forecastproductmapping WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'forecasttemplate WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'documentemailsettings WHERE id = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dashboard WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'favouritereportmaster WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'uobbankdetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'girofilegenerationhistory WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salescommissionrulecondition WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salescommissionrules WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salescommissionschemamaster WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'companyreportconfiguration WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'integrationdetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'importfilecolumnmapping WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'importfiledetails WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grid_config WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'erp_pos_mapping WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cashouttransaction WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'pospaydetail WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

 # start inventory tables
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_interstoretransfer WHERE company = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_goodsrequest WHERE company = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_sa_detail_approval WHERE sa_approval IN(SELECT id FROM ',fromdb,'in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'in_stockadjustment WHERE company = ?))))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_interstoretransfer WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_goodsrequest WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_sa_detail_approval WHERE sa_approval IN(SELECT id FROM ',fromdb,'in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'in_stockadjustment WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_interstoretransfer WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stocktransfer_detail_approval WHERE stocktransfer_approval IN(SELECT id FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_goodsrequest WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sa_detail_approval WHERE sa_approval IN(SELECT id FROM ',fromdb,'in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'in_stockadjustment WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_interstoretransfer WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stocktransfer_approval WHERE stocktransferid IN (SELECT id FROM ',fromdb,'in_goodsrequest WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sa_approval WHERE stock_adjustment IN (SELECT id FROM ',fromdb,'in_stockadjustment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_criteria_detail WHERE inspection_detail IN(SELECT id FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_consignmentdetails WHERE consignment IN (SELECT id FROM ',fromdb,'in_consignment WHERE company = ?)))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_detail WHERE id IN(SELECT inspection_detail FROM ',fromdb,'in_consignmentdetails WHERE consignment IN (SELECT id FROM ',fromdb,'in_consignment WHERE company = ?))');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_consignmentdetails WHERE consignment IN (SELECT id FROM ',fromdb,'in_consignment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_consignment WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stockbooking_detail WHERE stockbooking IN (SELECT id FROM ',fromdb,'in_stockbooking WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stockbooking WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_documents WHERE id IN (SELECT documentid FROM ',fromdb,'in_documentcompmap WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_documentcompmap WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_store_executive WHERE storeid IN (SELECT id FROM ',fromdb,'in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_store_movementtype WHERE storeid IN (SELECT id FROM ',fromdb,'in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_temp_stockadjustmentdetail WHERE store IN (SELECT id FROM ',fromdb,'in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_seqnumber WHERE seqformat IN ( SELECT id FROM ',fromdb,'in_seqformat WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_store_location WHERE storeid IN (SELECT id FROM ',fromdb,'in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_store_user WHERE storeid IN (SELECT id FROM ',fromdb,'in_storemaster WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_attachedserial WHERE attachedbatch IN ( SELECT id FROM ',fromdb,'in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sr_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sa_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_ist_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sm_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_cc_attachedbatch WHERE id IN ( SELECT id FROM ',fromdb,'in_attachedbatch WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sr_detail WHERE stockrequest IN ( SELECT id FROM ',fromdb,'in_goodsrequest WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sa_detail WHERE stockadjustment IN ( SELECT id FROM ',fromdb,'in_stockadjustment WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_ist_detail WHERE istrequest IN ( SELECT id FROM ',fromdb,'in_interstoretransfer WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sm_detail WHERE stockmovement IN ( SELECT id FROM ',fromdb,'in_stockmovement WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_cc_detail WHERE cyclecount IN ( SELECT id FROM ',fromdb,'in_cyclecount WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_sr_stockbuffer WHERE stockrequest IN ( SELECT id FROM ',fromdb,'in_goodsrequest WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_ist_stockbuffer WHERE istrequest IN ( SELECT id FROM ',fromdb,'in_interstoretransfer WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_cccalendar_frequency WHERE cc_calendarid IN ( SELECT id FROM ',fromdb,'in_cyclecount_calendar WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cyclecountcustomdata where ccid in (select id from in_cyclecount where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_cyclecount_calendar WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_cyclecount WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_cyclecountdraft WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stock WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_goodsrequest WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'grodetailistmapping WHERE istrequest in (select id from in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'repairgrodistmapping WHERE repairstoreistrequest in (select id from in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'wocdetailistmapping WHERE istrequest in (select id from in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'repairwocdistmapping WHERE repairstoreistrequest in (select id from in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dodqcistmapping WHERE qcistrequest in (select id from in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'rejectdodistmapping WHERE repairistrequest in (select id from in_interstoretransfer where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_interstoretransfer WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stockadjustment WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stockadjustmentdraft WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stockmovement WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_packaging WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_storemaster WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'storemaster WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_location WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_seqformat WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inventoryconfig WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'inventory_thread_running_status WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'notifictionrulesrecurringdetail WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'documentrecurringmailrecord WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_attachedbatch  WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_area  WHERE inspection_template IN ( SELECT id FROM ',fromdb,'in_inspection_template WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_inspection_template WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'showcustomcolumninreport WHERE companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;    
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_interstoretransfer_customdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'in_stockadjustment_customdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        
        # End Inventory Tables

        SET @sql_text = concat('DELETE FROM ',fromdb,'globalheaderfooter WHERE companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gldescriptionconfig WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'stockcustomdata WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        
        # For Indonesia Country, Tax Currency table.
        SET @sql_text = concat('DELETE FROM ',fromdb,'taxexchangeratedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        # India Compliance Tables
        # No company column but used as foreign key.
        SET @sql_text = concat('DELETE FROM ',fromdb,'producttermsmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptdetailtermsmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'receiptorderdetailtermsmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'deliveryorderdetailtermsmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'vendorquotationdetailstermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchasereturndetailtermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesreturndetailtermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'salesorderdetailtermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'quotationdetailtermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'invoicedetailtermsmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseorderdetailstermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'securitygatedetailstermmap  WHERE term IN ( SELECT id FROM ',fromdb,'linelevelterms WHERE company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'indiacompliancecompanypreferences where id = (select companyid from company where companyid = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
      
        # Tax Mapping Data for Avalara Integration (Modules -> Customer Invoice, Customer Quotation, Sales Order, Delivery Order, Sales Return)
        SET @sql_text = concat('DELETE FROM ',fromdb,'transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'invoicedetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'sodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'dodetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'quotationdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'transactiondetailavalarataxmapping WHERE parentrecordid IN (select id from ',fromdb,'srdetails where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'productavalaraidmapping WHERE productid IN (select id from ',fromdb,'product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        # have company column
        SET @sql_text = concat('DELETE FROM ',fromdb,'tds_rate WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'tdsdetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'excisedetailstemplatemap where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'linelevelterms where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customdesigntemplate13 where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dealerexcisedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'supplierexcisedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'dealerexciseterm where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'t_landingcostcategory WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'purchaseinvoiceurd_jedetail WHERE company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        # No company column or no forign key used.
        # SET @sql_text = concat('DELETE FROM ',fromdb,'reportschema');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        # SET @sql_text = concat('DELETE FROM ',fromdb,'defaultchequelayout');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        # SET @sql_text = concat('DELETE FROM ',fromdb,'defaultterms');PREPARE stmt FROM @sql_text;EXECUTE stmt;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'customcurrency where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'brdetailhistory where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'securitygatedetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'securitygateentry where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'securitygateentrycustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'securitygateentrydetailcustomdata where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'cashdenomination where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'companyregister where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'tempproductcompanyid where productids in (select id from product where company = ?)');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;        
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstreturn where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstr2submission where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gstform5esubmissiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'gsttransactionlistingsubmissiondetails where company = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;
        SET @sql_text = concat('DELETE FROM ',fromdb,'company where companyid = ?');PREPARE stmt FROM @sql_text;EXECUTE stmt using @x_companyid;DEALLOCATE PREPARE stmt;

        SET foreign_key_checks = 1;
SELECT 1; # Please don't delete this line. It is used for deletecompany() method in remoteapi.java to execute Native SQL query.
END//
delimiter ;
