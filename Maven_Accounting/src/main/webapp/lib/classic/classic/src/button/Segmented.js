Ext.define("Ext.button.Segmented",{extend:"Ext.container.Container",xtype:"segmentedbutton",requires:["Ext.button.Button","Ext.layout.container.SegmentedButton"],config:{allowDepress:false,allowMultiple:false,forceSelection:false,allowToggle:true,vertical:false,defaultUI:"default"},beforeRenderConfig:{value:undefined},defaultBindProperty:"value",publishes:["value"],twoWayBindable:["value"],layout:"segmentedbutton",defaultType:"button",maskOnDisable:false,isSegmentedButton:true,baseCls:Ext.baseCSSPrefix+"segmented-button",itemCls:Ext.baseCSSPrefix+"segmented-button-item",_firstCls:Ext.baseCSSPrefix+"segmented-button-first",_lastCls:Ext.baseCSSPrefix+"segmented-button-last",_middleCls:Ext.baseCSSPrefix+"segmented-button-middle",applyValue:function(I,A){var H=this,L=H.getAllowMultiple(),D,E,J,K,G,C,F,B;J=(I instanceof Array)?I:(I==null)?[]:[I];K=(A instanceof Array)?A:(A==null)?[]:[A];H._isApplyingValue=true;if(!H.rendered){G=H.items.items;for(C=G.length-1;C>=0;C--){E=G[C];if(H.forceSelection&&!C&&!B){E.pressed=true}if(E.pressed){B=true;D=E.value;if(D==null){D=H.items.indexOf(E)}if(!Ext.Array.contains(J,D)){J.unshift(D)}}}}F=J.length;if(F>1&&!L){Ext.raise("Cannot set multiple values when allowMultiple is false")}for(C=0;C<F;C++){I=J[C];E=H._lookupButtonByValue(I);if(E){D=E.value;if((D!=null)&&D!==I){J[C]=D}if(!E.pressed){E.setPressed(true)}}else{Ext.raise("Invalid value '"+I+"' for segmented button: '"+H.id+"'")}}I=L?J:F?J[0]:null;for(C=0,F=K.length;C<F;C++){A=K[C];if(!Ext.Array.contains(J,A)){H._lookupButtonByValue(A).setPressed(false)}}H._isApplyingValue=false;if(H.hasListeners.change&&!Ext.Array.equals(J,K)){H.fireEvent("change",H,J,K)}return I},beforeRender:function(){var A=this;A.addCls(A.baseCls+A._getClsSuffix());A._syncItemClasses(true);A.callParent()},onAdd:function(F){var E=this,C="_syncItemClasses";var A=E.items.items,D=A.length,B=0,G,H;if(F.ui==="default"&&!F.hasOwnProperty("ui")){H=E.getDefaultUI();if(H!=="default"){F.ui=H}}for(;B<D;B++){if(A[B]!==F){G=A[B].value;if(G!=null&&G===F.value){Ext.raise("Segmented button '"+E.id+"' cannot contain multiple items with value: '"+G+"'")}}}E.mon(F,{hide:C,show:C,beforetoggle:"_onBeforeItemToggle",toggle:"_onItemToggle",scope:E});if(E.getAllowToggle()){F.enableToggle=true;if(!E.getAllowMultiple()){F.toggleGroup=E.getId();F.allowDepress=E.getAllowDepress()}}F.addCls(E.itemCls+E._getClsSuffix());E._syncItemClasses();E.callParent([F])},onRemove:function(B){var A=this;B.removeCls(A.itemCls+A._getClsSuffix());A._syncItemClasses();A.callParent([B])},beforeLayout:function(){if(Ext.isChrome){this.el.dom.offsetWidth}this.callParent()},updateDefaultUI:function(E){var A=this.items,D,B,C;if(this.rendered){Ext.raise("Changing the ui config of a segmented button after render is not supported.")}else{if(A){if(A.items){A=A.items}for(B=0,C=A.length;B<C;B++){D=A[B];if(D.ui==="default"&&E!=="default"&&!D.hasOwnProperty("ui")){A[B].ui=E}}}}},updateAllowDepress:function(B,A){if(this.rendered&&(B!==A)){Ext.raise("Changing the allowDepress config of a segmented button after render is not supported.")}},updateAllowMultiple:function(B,A){if(this.rendered&&(B!==A)){Ext.raise("Changing the allowMultiple config of a segmented button after render is not supported.")}},updateAllowToggle:function(A,B){if(this.rendered&&(A!==B)){Ext.raise("Changing the allowToggle config of a segmented button after render is not supported.")}},updateVertical:function(A,B){if(this.rendered&&(A!==B)){Ext.raise("Changing the orientation of a segmented button after render is not supported.")}},privates:{_getClsSuffix:function(){return this.getVertical()?"-vertical":"-horizontal"},_getFirstCls:function(){return this._firstCls},_getLastCls:function(){return this._lastCls},_lookupButtonByValue:function(G){var B=this.items.items,F=B.length,E=0,D=null,A,C;for(;E<F;E++){C=B[E];A=C.value;if((A!=null)&&A===G){D=C;break}}if(!D&&typeof G==="number"){D=B[G]}return D},_onBeforeItemToggle:function(A,B){if(this.allowMultiple&&this.forceSelection&&!B&&this.getValue().length===1){return false}},_onItemToggle:function(C,G){if(this._isApplyingValue){return }var E=this,D=Ext.Array,B=E.allowMultiple,A=(C.value!=null)?C.value:E.items.indexOf(C),F=E.getValue(),H;if(B){H=D.indexOf(F,A)}if(G){if(B){if(H===-1){F=D.slice(F);F.push(A)}}else{F=A}}else{if(B){if(H>-1){F=D.slice(F);F.splice(H,1)}}else{if(F===A){F=null}}}E.setValue(F);E.fireEvent("toggle",E,C,G)},_syncItemClasses:function(A){var G=this,B,D,I,F,E,J,H,C;if(!A&&!G.rendered){return }B=G._getFirstCls();D=G._middleCls;I=G._getLastCls();F=G.items.items;E=F.length;J=[];for(C=0;C<E;C++){H=F[C];if(!H.hidden){J.push(H)}}E=J.length;for(C=0;C<E;C++){J[C].removeCls([B,D,I])}if(E>1){J[0].addCls(B);for(C=1;C<E-1;C++){J[C].addCls(D)}J[E-1].addCls(I)}}}})