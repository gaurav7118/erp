Ext.define("Ext.dashboard.DropZone",{extend:"Ext.dd.DropTarget",ddScrollConfig:{vthresh:75,hthresh:-1,animate:true,increment:200},containerScroll:true,overClass:Ext.baseCSSPrefix+"dashboard-dd-over",constructor:function(B,A){this.dashboard=B;B.body.ddScrollConfig=this.ddScrollConfig;this.callParent([B.body,A])},getOverEvent:function(S,Q,U){var L=this.dashboard,B=L.body,K=L.items.items,C=B.getBox(),E=K.length,D=Q.getXY(),H=D[0]-C.x+B.getScrollLeft(),G=D[1]-C.y+B.getScrollTop(),N={columnIndex:0,column:null,dashboard:L,above:null,extensible:false,beforeAfter:0,data:U,panel:U.panel,rawEvent:Q,source:S,status:this.dropAllowed},J,T,O,M,R,I,P,A,F;for(O=0;O<E;O+=2){R=K[O];I=R.lastBox.width;if(K[O+1]){I+=K[O+1].lastBox.width}if(Q.within(R.el)){N.columnIndex=O;N.column=R;N.extensible=this.isRowExtensible(R.rowIndex);J=Math.min(80,I*0.2);N.beforeAfter=J=(N.extensible&&((H<J)?-1:((H>I-J)?1:0)));if(!J||!N.extensible){A=R.items.items;for(M=0,P=A.length;M<P;++M){F=A[M];T=F.el.getHeight();if(G<T/2){N.above=F;break}G-=T}}break}H-=I}return N},notifyOver:function(N,G,F){var K=this,L=K.dashboard,H=K.getOverEvent(N,G,F),C=H.column&&H.column.el,J=N.proxy,B,D=H.above,E,A=0,M,I=L.hasListeners;F.lastOver=H;if((!I.validatedrop||L.fireEvent("validatedrop",H)!==false)&&(!I.beforedragover||L.fireEvent("beforedragover",H)!==false)){B=N.panelProxy.getProxy();J.getProxy().setWidth("auto");if(C){A=E=C.getWidth();if(H.beforeAfter){N.panelProxy.moveProxy(C.dom,C.dom.firstChild);A=E/2;B.setWidth(A)}else{if(D){N.panelProxy.moveProxy(D.el.dom.parentNode,D.el.dom)}else{N.panelProxy.moveProxy(C.dom,null)}B.setWidth("auto")}if(A){}B.setStyle({"float":"none","clear":"none","margin-left":(H.beforeAfter>0)?(E-A-C.getPadding("lr"))+"px":"","margin-top":"7px"})}else{M=L.body.getPadding("lr");B.setStyle({"float":"left","clear":"left","margin":"0 7px 0 7px"});B.setWidth(L.body.getWidth()-M);N.panelProxy.moveProxy(L.body.dom.firstChild.firstChild,null)}this.scrollPos=L.body.getScroll();if(I.dragover){L.fireEvent("dragover",H)}}return H.status},isRowExtensible:function(D){var C=this,B=C.dashboard,A=B.getMaxColumns()||1;return Ext.Array.from(B.query(">dashboard-column[rowIndex="+D+"]")).length<A},notifyDrop:function(N,F,C){this.callParent(arguments);var J=this.dashboard,G=C.lastOver,A=G.panel,K=A.ownerCt,D=G.column,I=D?G.beforeAfter:1,E=K.items.indexOf(A),M=D?(G.above?D.items.indexOf(G.above):D.items.getCount()):0,L,B,H=J.hasListeners;if(K===D){if(K.items.getCount()===1){return }if(!I){if(E<M){--M}if(E===M){return }}}if((H.validatedrop&&J.fireEvent("validatedrop",G)===false)||(H.beforedrop&&J.fireEvent("beforedrop",G)===false)){return }Ext.suspendLayouts();A.isMoving=true;if(I){L=J.items.indexOf(D);if(L<0){L=J.items.getCount()}else{if(I>0){++L}}B=J.createColumn();if(D){B.columnWidth=D.columnWidth=D.columnWidth/2;delete D.width}else{B.columnWidth=1}D=J.insert(L,B);M=0}A.el.dom.style.display="";D.insert(M,A);A.isMoving=false;D.updateLayout();Ext.resumeLayouts(true);if(H.drop){J.fireEvent("drop",G)}}})