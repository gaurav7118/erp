Ext.define("Ext.dd.DD",{extend:"Ext.dd.DragDrop",requires:["Ext.dd.DragDropManager"],constructor:function(C,A,B){if(C){this.init(C,A,B)}},scroll:true,autoOffset:function(C,B){var A=C-this.startPageX,D=B-this.startPageY;this.setDelta(A,D)},setDelta:function(B,A){this.deltaX=B;this.deltaY=A},setDragElPos:function(C,B){var A=this.getDragEl();this.alignElWithMouse(A,C,B)},alignElWithMouse:function(B,E,C){var F=this.getTargetCoord(E,C),D=B.dom?B:Ext.fly(B,"_dd"),K=D.getSize(),H=Ext.Element,I,A,J,G;if(!this.deltaSetXY){I=this.cachedViewportSize={width:H.getDocumentWidth(),height:H.getDocumentHeight()};A=[Math.max(0,Math.min(F.x,I.width-K.width)),Math.max(0,Math.min(F.y,I.height-K.height))];D.setXY(A);J=this.getLocalX(D);G=D.getLocalY();this.deltaSetXY=[J-F.x,G-F.y]}else{I=this.cachedViewportSize;this.setLocalXY(D,Math.max(0,Math.min(F.x+this.deltaSetXY[0],I.width-K.width)),Math.max(0,Math.min(F.y+this.deltaSetXY[1],I.height-K.height)))}this.cachePosition(F.x,F.y);this.autoScroll(F.x,F.y,B.offsetHeight,B.offsetWidth);return F},cachePosition:function(B,A){if(B){this.lastPageX=B;this.lastPageY=A}else{var C=Ext.fly(this.getEl()).getXY();this.lastPageX=C[0];this.lastPageY=C[1]}},autoScroll:function(J,I,E,K){if(this.scroll){var L=Ext.Element.getViewportHeight(),B=Ext.Element.getViewportWidth(),N=this.DDMInstance.getScrollTop(),D=this.DDMInstance.getScrollLeft(),H=E+I,M=K+J,G=(L+N-I-this.deltaY),F=(B+D-J-this.deltaX),C=40,A=(document.all)?80:30;if(H>L&&G<C){window.scrollTo(D,N+A)}if(I<N&&N>0&&I-N<C){window.scrollTo(D,N-A)}if(M>B&&F<C){window.scrollTo(D+A,N)}if(J<D&&D>0&&J-D<C){window.scrollTo(D-A,N)}}},getTargetCoord:function(C,B){var A=C-this.deltaX,D=B-this.deltaY;if(this.constrainX){if(A<this.minX){A=this.minX}if(A>this.maxX){A=this.maxX}}if(this.constrainY){if(D<this.minY){D=this.minY}if(D>this.maxY){D=this.maxY}}A=this.getTick(A,this.xTicks);D=this.getTick(D,this.yTicks);return{x:A,y:D}},applyConfig:function(){this.callParent();this.scroll=(this.config.scroll!==false)},b4MouseDown:function(B){var A=B.getXY();this.autoOffset(A[0],A[1])},b4Drag:function(B){var A=B.getXY();this.setDragElPos(A[0],A[1])},toString:function(){return("DD "+this.id)},getLocalX:function(A){return A.getLocalX()},setLocalXY:function(B,A,C){B.setLocalXY(A,C)}})