Ext.define("Ext.form.FieldSet",{extend:"Ext.container.Container",mixins:{fieldAncestor:"Ext.form.FieldAncestor"},alias:"widget.fieldset",uses:["Ext.form.field.Checkbox","Ext.panel.Tool","Ext.layout.container.Anchor","Ext.layout.component.FieldSet"],checkboxUI:"default",collapsed:false,toggleOnTitleClick:true,baseCls:Ext.baseCSSPrefix+"fieldset",layout:"anchor",descriptionText:"{0} field set",expandText:"Expand field set",componentLayout:"fieldset",ariaRole:"group",focusable:false,autoEl:"fieldset",childEls:["body"],renderTpl:["{%this.renderLegend(out,values);%}",'<div id="{id}-body" data-ref="body" class="{baseCls}-body {baseCls}-body-{ui} {bodyTargetCls}" ','role="presentation"<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values);%}","</div>"],stateEvents:["collapse","expand"],maskOnDisable:false,beforeDestroy:function(){var B=this,A=B.legend;if(A){delete A.ownerCt;A.destroy();B.legend=null}B.callParent()},initComponent:function(){var B=this,A=B.baseCls;if(B.ariaRole&&!B.ariaLabel){B.ariaLabel=Ext.String.formatEncode(B.descriptionText,B.title||"")}B.ariaRenderAttributes=B.ariaRenderAttributes||{};B.ariaRenderAttributes["aria-expanded"]=!B.collapsed;B.initFieldAncestor();B.callParent();B.layout.managePadding=B.layout.manageOverflow=false;if(B.collapsed){B.addCls(A+"-collapsed");B.collapse()}if(B.title||B.checkboxToggle||B.collapsible){B.addTitleClasses();B.legend=B.createLegendCt()}B.initMonitor()},initRenderData:function(){var A=this,B=A.callParent();B.bodyTargetCls=A.bodyTargetCls;A.protoBody.writeTo(B);delete A.protoBody;return B},getState:function(){var A=this.callParent();A=this.addPropertyToState(A,"collapsed");return A},afterCollapse:Ext.emptyFn,afterExpand:Ext.emptyFn,collapsedHorizontal:function(){return true},collapsedVertical:function(){return true},createLegendCt:function(){var C=this,A=[],D={baseCls:C.baseCls+"-header",layout:"container",ui:C.ui,id:C.id+"-legend",autoEl:"legend",ariaRole:null,items:A,ownerCt:C,shrinkWrap:true,ownerLayout:C.componentLayout},B;if(C.checkboxToggle){A.push(C.createCheckboxCmp())}else{if(C.collapsible){A.push(C.createToggleCmp())}}A.push(C.createTitleCmp());B=new Ext.container.Container(D);B.collapseImmune=true;B.getInherited().collapseImmune=true;return B},createTitleCmp:function(){var B=this,A={html:B.title,ui:B.ui,cls:B.baseCls+"-header-text",id:B.id+"-legendTitle",ariaRole:"presentation"};if(B.collapsible&&B.toggleOnTitleClick){A.listeners={click:{element:"el",scope:B,fn:B.toggle}};A.cls+=" "+B.baseCls+"-header-text-collapsible"}B.titleCmp=new Ext.Component(A);return B.titleCmp},createCheckboxCmp:function(){var B=this,D="-checkbox",A=B.baseCls+"-header"+D,C;A+=" "+A+"-"+B.ui;B.checkboxCmp=C=new Ext.form.field.Checkbox({hideEmptyLabel:true,name:B.checkboxName||B.id+D,cls:A,id:B.id+"-legendChk",ui:B.checkboxUI,checked:!B.collapsed,msgTarget:"none",listeners:{change:B.onCheckChange,scope:B},ariaLabel:B.expandText});return C},createToggleCmp:function(){var A=this,B;A.toggleCmp=B=new Ext.panel.Tool({cacheHeight:false,cls:A.baseCls+"-header-tool-"+A.ui,type:"toggle",handler:A.toggle,id:A.id+"-legendToggle",scope:A,ariaRole:"checkbox",ariaLabel:A.expandText,ariaRenderAttributes:{"aria-checked":!A.collapsed}});return B},doRenderLegend:function(B,E){var D=E.$comp,C=D.legend,A;if(C){C.ownerLayout.configureItem(C);A=C.getRenderTree();Ext.DomHelper.generateMarkup(A,B)}},getCollapsed:function(){return this.collapsed?"top":false},getCollapsedDockedItems:function(){var A=this.legend;return A?[A]:[]},setTitle:function(C){var B=this,A=B.legend;B.title=C;B.ariaLabel=Ext.String.formatEncode(B.descriptionText,C||"");if(B.rendered){if(!A){B.legend=A=B.createLegendCt();B.addTitleClasses();A.ownerLayout.configureItem(A);A.render(B.el,0)}B.titleCmp.update(C);B.ariaEl.dom.setAttribute("aria-label",B.ariaLabel)}else{if(A){B.titleCmp.update(C)}else{B.addTitleClasses();B.legend=B.createLegendCt()}}return B},addTitleClasses:function(){var B=this,C=B.title,A=B.baseCls;if(C){B.addCls(A+"-with-title")}if(C||B.checkboxToggle||B.collapsible){B.addCls(A+"-with-legend")}},expand:function(){return this.setExpanded(true)},collapse:function(){return this.setExpanded(false)},setExpanded:function(B){var C=this,D=C.checkboxCmp,E=C.toggleCmp,A=B?"expand":"collapse";if(!C.rendered||C.fireEvent("before"+A,C)!==false){B=!!B;if(D){D.setValue(B)}else{if(E&&E.ariaEl.dom){E.ariaEl.dom.setAttribute("aria-checked",B)}}if(B){C.removeCls(C.baseCls+"-collapsed")}else{C.addCls(C.baseCls+"-collapsed")}if(C.ariaEl.dom){C.ariaEl.dom.setAttribute("aria-expanded",!!B)}C.collapsed=!B;if(B){delete C.getInherited().collapsed}else{C.getInherited().collapsed=true}if(C.rendered){C.updateLayout({isRoot:false});C.fireEvent(A,C)}}return C},getRefItems:function(A){var C=this.callParent(arguments),B=this.legend;if(B){C.unshift(B);if(A){C.unshift.apply(C,B.getRefItems(true))}}return C},toggle:function(){this.setExpanded(!!this.collapsed)},privates:{applyTargetCls:function(A){this.bodyTargetCls=A},finishRender:function(){var A=this.legend;this.callParent();if(A){A.finishRender()}},getProtoBody:function(){var B=this,A=B.protoBody;if(!A){B.protoBody=A=new Ext.util.ProtoElement({styleProp:"bodyStyle",styleIsText:true})}return A},getDefaultContentTarget:function(){return this.body},getTargetEl:function(){return this.body||this.frameBody||this.el},initPadding:function(E){var C=this,A=C.getProtoBody(),D=C.padding,B;if(D!==undefined){if(Ext.isIE8){D=C.parseBox(D);B=Ext.Element.parseBox(0);B.top=D.top;D.top=0;A.setStyle("padding",C.unitizeBox(B))}E.setStyle("padding",C.unitizeBox(D))}},onCheckChange:function(B,A){this.setExpanded(A)},setupRenderTpl:function(A){this.callParent(arguments);A.renderLegend=this.doRenderLegend}}})