Ext.define("Ext.form.field.File",{extend:"Ext.form.field.Text",alias:["widget.filefield","widget.fileuploadfield"],alternateClassName:["Ext.form.FileUploadField","Ext.ux.form.FileUploadField","Ext.form.File"],requires:["Ext.form.field.FileButton","Ext.form.trigger.Component"],emptyText:undefined,needArrowKeys:false,triggers:{filebutton:{type:"component",hideOnReadOnly:false,preventMouseDown:false}},buttonText:"Browse...",buttonOnly:false,buttonMargin:3,clearOnSubmit:true,extraFieldBodyCls:Ext.baseCSSPrefix+"form-file-wrap",inputCls:Ext.baseCSSPrefix+"form-text-file",readOnly:true,editable:false,submitValue:false,triggerNoEditCls:"",childEls:["browseButtonWrap"],applyTriggers:function(A){var B=this,C=(A||{}).filebutton;if(C){C.component=Ext.apply({xtype:"filebutton",ownerCt:B,id:B.id+"-button",ui:B.ui,disabled:B.disabled,text:B.buttonText,style:B.buttonOnly?"":B.getButtonMarginProp()+B.buttonMargin+"px",inputName:B.getName(),listeners:{scope:B,change:B.onFileChange}},B.buttonConfig);return B.callParent([A])}else{Ext.raise(B.$className+' requires a valid trigger config containing "filebutton" specification')}},getSubTplData:function(A){var B=this.callParent([A]);B.tabIdx=-1;return B},onRender:function(){var D=this,E,C,A,B;D.callParent(arguments);E=D.inputEl;E.dom.name="";E.on("focus",D.onInputFocus,D);E.on("mousedown",D.onInputMouseDown,D);B=D.getTrigger("filebutton");C=D.button=B.component;D.fileInputEl=C.fileInputEl;A=C.el;if(D.buttonOnly){D.inputWrap.setDisplayed(false);D.shrinkWrap=3}B.el.setWidth(A.getWidth()+A.getMargin("lr"));if(Ext.isIE){D.button.getEl().repaint()}},getTriggerMarkup:function(){return'<td id="'+this.id+'-browseButtonWrap" data-ref="browseButtonWrap" role="presentation"></td>'},onFileChange:function(A,C,B){this.duringFileSelect=true;Ext.form.field.File.superclass.setValue.call(this,B);delete this.duringFileSelect},didValueChange:function(){return !!this.duringFileSelect},setEmptyText:Ext.emptyFn,setValue:Ext.emptyFn,reset:function(){var B=this,A=B.clearOnSubmit;if(B.rendered){B.button.reset(A);B.fileInputEl=B.button.fileInputEl;if(A){B.inputEl.dom.value="";Ext.form.field.File.superclass.setValue.call(this,null)}}B.callParent()},onShow:function(){this.callParent();this.button.updateLayout()},onDisable:function(){this.callParent();this.button.disable()},onEnable:function(){this.callParent();this.button.enable()},isFileUpload:Ext.returnTrue,extractFileInput:function(){var B=this,A;if(B.rendered){A=B.button.fileInputEl.dom;B.reset()}else{A=document.createElement("input");A.type="file";A.className=Ext.baseCSSPrefix+"hidden-display";A.name=B.getName()}return A},restoreInput:function(B){if(this.rendered){var A=this.button;A.restoreInput(B);this.fileInputEl=A.fileInputEl}},onDestroy:function(){this.fileInputEl=this.button=null;this.callParent()},getButtonMarginProp:function(){return"margin-left:"},onInputFocus:function(A){this.focus();if(Ext.isIE9m){this.fileInputEl.addCls(Ext.baseCSSPrefix+"position-relative");this.fileInputEl.removeCls(Ext.baseCSSPrefix+"position-relative")}},onInputMouseDown:function(A){A.preventDefault();this.focus()},privates:{getFocusEl:function(){return this.button},getFocusClsEl:Ext.privateFn}})