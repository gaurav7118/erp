Ext.define("Ext.fx.Animator",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.fx.Manager"],isAnimator:true,duration:250,delay:0,delayStart:0,dynamic:false,easing:"ease",running:false,paused:false,damper:1,iterations:1,currentIteration:0,keyframeStep:0,animKeyFramesRE:/^(from|to|\d+%?)$/,constructor:function(A){var B=this;A=Ext.apply(B,A||{});B.config=A;B.id=Ext.id(null,"ext-animator-");B.mixins.observable.constructor.call(B,A);B.timeline=[];B.createTimeline(B.keyframes);if(B.target){B.applyAnimator(B.target);Ext.fx.Manager.addAnim(B)}},sorter:function(B,A){return B.pct-A.pct},createTimeline:function(D){var G=this,J=[],H=G.to||{},B=G.duration,K,A,C,F,I,E;for(I in D){if(D.hasOwnProperty(I)&&G.animKeyFramesRE.test(I)){E={attrs:Ext.apply(D[I],H)};if(I==="from"){I=0}else{if(I==="to"){I=100}}E.pct=parseInt(I,10);J.push(E)}}Ext.Array.sort(J,G.sorter);F=J.length;for(C=0;C<F;C++){K=(J[C-1])?B*(J[C-1].pct/100):0;A=B*(J[C].pct/100);G.timeline.push({duration:A-K,attrs:J[C].attrs})}},applyAnimator:function(D){var G=this,H=[],J=G.timeline,F=J.length,B,E,A,I,C;if(G.fireEvent("beforeanimate",G)!==false){for(C=0;C<F;C++){B=J[C];I=B.attrs;E=I.easing||G.easing;A=I.damper||G.damper;delete I.easing;delete I.damper;B=new Ext.fx.Anim({target:D,easing:E,damper:A,duration:B.duration,paused:true,to:I});H.push(B)}G.animations=H;G.target=B.target;for(C=0;C<F-1;C++){B=H[C];B.nextAnim=H[C+1];B.on("afteranimate",function(){this.nextAnim.paused=false});B.on("afteranimate",function(){this.fireEvent("keyframe",this,++this.keyframeStep)},G)}H[F-1].on("afteranimate",function(){this.lastFrame()},G)}},start:function(D){var E=this,C=E.delay,B=E.delayStart,A;if(C){if(!B){E.delayStart=D;return }else{A=D-B;if(A<C){return }else{D=new Date(B.getTime()+C)}}}if(E.fireEvent("beforeanimate",E)!==false){E.startTime=D;E.running=true;E.animations[E.keyframeStep].paused=false}},lastFrame:function(){var C=this,A=C.iterations,B=C.currentIteration;B++;if(B<A){C.startTime=new Date();C.currentIteration=B;C.keyframeStep=0;C.applyAnimator(C.target);C.animations[C.keyframeStep].paused=false}else{C.currentIteration=0;C.end()}},end:function(){var A=this;A.fireEvent("afteranimate",A,A.startTime,new Date()-A.startTime)},isReady:function(){return this.paused===false&&this.running===false&&this.iterations>0},isRunning:function(){return false}})