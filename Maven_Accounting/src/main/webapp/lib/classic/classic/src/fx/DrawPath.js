Ext.define("Ext.fx.DrawPath",{singleton:true,pathToStringRE:/,?([achlmqrstvxz]),?/gi,pathCommandRE:/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,pathValuesRE:/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,stopsRE:/^(\d+%?)$/,radian:Math.PI/180,is:function(B,A){A=String(A).toLowerCase();return(A=="object"&&B===Object(B))||(A=="undefined"&&typeof B==A)||(A=="null"&&B===null)||(A=="array"&&Array.isArray&&Array.isArray(B))||(Object.prototype.toString.call(B).toLowerCase().slice(8,-1))==A},path2string:function(){return this.join(",").replace(Ext.fx.DrawPath.pathToStringRE,"$1")},pathToString:function(A){return A.join(",").replace(Ext.fx.DrawPath.pathToStringRE,"$1")},parsePathString:function(A){if(!A){return null}var D={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},C=[],B=this;if(B.is(A,"array")&&B.is(A[0],"array")){C=B.pathClone(A)}if(!C.length){String(A).replace(B.pathCommandRE,function(F,E,I){var H=[],G=E.toLowerCase();I.replace(B.pathValuesRE,function(K,J){if(J){H.push(+J)}});if(G=="m"&&H.length>2){C.push([E].concat(Ext.Array.splice(H,0,2)));G="l";E=(E=="m")?"l":"L"}while(H.length>=D[G]){C.push([E].concat(Ext.Array.splice(H,0,D[G])));if(!D[G]){break}}})}C.toString=B.path2string;return C},pathClone:function(F){var C=[],A,E,B,D;if(!this.is(F,"array")||!this.is(F&&F[0],"array")){F=this.parsePathString(F)}for(B=0,D=F.length;B<D;B++){C[B]=[];for(A=0,E=F[B].length;A<E;A++){C[B][A]=F[B][A]}}C.toString=this.path2string;return C},pathToAbsolute:function(C){if(!this.is(C,"array")||!this.is(C&&C[0],"array")){C=this.parsePathString(C)}var H=[],J=0,I=0,L=0,K=0,F=0,G=C.length,B,D,E,A;if(G&&C[0][0]=="M"){J=+C[0][1];I=+C[0][2];L=J;K=I;F++;H[0]=["M",J,I]}for(;F<G;F++){B=H[F]=[];D=C[F];if(D[0]!=D[0].toUpperCase()){B[0]=D[0].toUpperCase();switch(B[0]){case"A":B[1]=D[1];B[2]=D[2];B[3]=D[3];B[4]=D[4];B[5]=D[5];B[6]=+(D[6]+J);B[7]=+(D[7]+I);break;case"V":B[1]=+D[1]+I;break;case"H":B[1]=+D[1]+J;break;case"M":L=+D[1]+J;K=+D[2]+I;default:E=1;A=D.length;for(;E<A;E++){B[E]=+D[E]+((E%2)?J:I)}}}else{E=0;A=D.length;for(;E<A;E++){H[F][E]=D[E]}}switch(B[0]){case"Z":J=L;I=K;break;case"H":J=B[1];break;case"V":I=B[1];break;case"M":D=H[F];A=D.length;L=D[A-2];K=D[A-1];default:D=H[F];A=D.length;J=D[A-2];I=D[A-1]}}H.toString=this.path2string;return H},interpolatePaths:function(O,J){var H=this,D=H.pathToAbsolute(O),K=H.pathToAbsolute(J),L={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},A={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},B=function(P,Q){if(P[Q].length>7){P[Q].shift();var R=P[Q];while(R.length){Ext.Array.splice(P,Q++,0,["C"].concat(Ext.Array.splice(R,0,6)))}Ext.Array.erase(P,Q,1);M=Math.max(D.length,K.length||0)}},C=function(T,S,Q,P,R){if(T&&S&&T[R][0]=="M"&&S[R][0]!="M"){Ext.Array.splice(S,R,0,["M",P.x,P.y]);Q.bx=0;Q.by=0;Q.x=T[R][1];Q.y=T[R][2];M=Math.max(D.length,K.length||0)}},G,M,F,N,E,I;for(G=0,M=Math.max(D.length,K.length||0);G<M;G++){D[G]=H.command2curve(D[G],L);B(D,G);(K[G]=H.command2curve(K[G],A));B(K,G);C(D,K,L,A,G);C(K,D,A,L,G);F=D[G];N=K[G];E=F.length;I=N.length;L.x=F[E-2];L.y=F[E-1];L.bx=parseFloat(F[E-4])||L.x;L.by=parseFloat(F[E-3])||L.y;A.bx=(parseFloat(N[I-4])||A.x);A.by=(parseFloat(N[I-3])||A.y);A.x=N[I-2];A.y=N[I-1]}return[D,K]},command2curve:function(C,B){var A=this;if(!C){return["C",B.x,B.y,B.x,B.y,B.x,B.y]}if(C[0]!="T"&&C[0]!="Q"){B.qx=B.qy=null}switch(C[0]){case"M":B.X=C[1];B.Y=C[2];break;case"A":C=["C"].concat(A.arc2curve.apply(A,[B.x,B.y].concat(C.slice(1))));break;case"S":C=["C",B.x+(B.x-(B.bx||B.x)),B.y+(B.y-(B.by||B.y))].concat(C.slice(1));break;case"T":B.qx=B.x+(B.x-(B.qx||B.x));B.qy=B.y+(B.y-(B.qy||B.y));C=["C"].concat(A.quadratic2curve(B.x,B.y,B.qx,B.qy,C[1],C[2]));break;case"Q":B.qx=C[1];B.qy=C[2];C=["C"].concat(A.quadratic2curve(B.x,B.y,C[1],C[2],C[3],C[4]));break;case"L":C=["C"].concat(B.x,B.y,C[1],C[2],C[1],C[2]);break;case"H":C=["C"].concat(B.x,B.y,C[1],B.y,C[1],B.y);break;case"V":C=["C"].concat(B.x,B.y,B.x,C[1],B.x,C[1]);break;case"Z":C=["C"].concat(B.x,B.y,B.X,B.Y,B.X,B.Y);break}return C},quadratic2curve:function(B,D,G,E,A,C){var F=1/3,H=2/3;return[F*B+H*G,F*D+H*E,F*A+H*G,F*C+H*E,A,C]},rotate:function(B,G,A){var D=Math.cos(A),C=Math.sin(A),F=B*D-G*C,E=B*C+G*D;return{x:F,y:E}},arc2curve:function(O,AE,a,Y,S,J,F,N,AD,T){var Q=this,D=Math.PI,R=Q.radian,X=D*120/180,B=R*(+S||0),f=[],c=Math,p=c.cos,A=c.sin,r=c.sqrt,P=c.abs,K=c.asin,b,j,g,z,C,n,q,V,U,I,H,M,G,AC,E,AB,l,o,m,AA,w,v,s,e,u,d,W,Z,L;if(!T){b=Q.rotate(O,AE,-B);O=b.x;AE=b.y;b=Q.rotate(N,AD,-B);N=b.x;AD=b.y;j=(O-N)/2;g=(AE-AD)/2;z=(j*j)/(a*a)+(g*g)/(Y*Y);if(z>1){z=r(z);a=z*a;Y=z*Y}C=a*a;n=Y*Y;q=(J==F?-1:1)*r(P((C*n-C*g*g-n*j*j)/(C*g*g+n*j*j)));V=q*a*g/Y+(O+N)/2;U=q*-Y*j/a+(AE+AD)/2;I=K(((AE-U)/Y).toFixed(7));H=K(((AD-U)/Y).toFixed(7));I=O<V?D-I:I;H=N<V?D-H:H;if(I<0){I=D*2+I}if(H<0){H=D*2+H}if(F&&I>H){I=I-D*2}if(!F&&H>I){H=H-D*2}}else{I=T[0];H=T[1];V=T[2];U=T[3]}M=H-I;if(P(M)>X){W=H;Z=N;L=AD;H=I+X*(F&&H>I?1:-1);N=V+a*p(H);AD=U+Y*A(H);f=Q.arc2curve(N,AD,a,Y,S,0,F,Z,L,[H,W,V,U])}M=H-I;G=p(I);AC=A(I);E=p(H);AB=A(H);l=c.tan(M/4);o=4/3*a*l;m=4/3*Y*l;AA=[O,AE];w=[O+o*AC,AE-m*G];v=[N+o*AB,AD-m*E];s=[N,AD];w[0]=2*AA[0]-w[0];w[1]=2*AA[1]-w[1];if(T){return[w,v,s].concat(f)}else{f=[w,v,s].concat(f).join().split(",");e=[];d=f.length;for(u=0;u<d;u++){e[u]=u%2?Q.rotate(f[u-1],f[u],B).y:Q.rotate(f[u],f[u+1],B).x}return e}}})