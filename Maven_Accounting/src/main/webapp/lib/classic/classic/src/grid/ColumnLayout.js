Ext.define("Ext.grid.ColumnLayout",{extend:"Ext.layout.container.HBox",alias:"layout.gridcolumn",type:"gridcolumn",requires:["Ext.panel.Table"],firstHeaderCls:Ext.baseCSSPrefix+"column-header-first",lastHeaderCls:Ext.baseCSSPrefix+"column-header-last",initLayout:function(){this.callParent();if(this.scrollbarWidth===undefined){this.self.prototype.scrollbarWidth=Ext.getScrollbarSize().width}},beginLayout:function(C){var H=this,A=H.owner,D=H.firstHeaderCls,J=H.lastHeaderCls,B=[D,J],G=H.getVisibleItems(),F=G.length,E,I;H.callParent([C]);for(E=0;E<F;E++){I=G[E];if(F===1){I.addCls(B)}else{if(E===0){I.addCls(D);I.removeCls(J)}else{if(E===F-1){I.removeCls(D);I.addCls(J)}else{I.removeCls(B)}}}}H.scrollbarWidth=0;if(A.isRootHeader){H.determineScrollbarWidth(C)}if(!H.scrollbarWidth){C.manageScrollbar=false}},moveItemBefore:function(B,C){var A=B.ownerCt;if(B!==C&&A){A.remove(B,false)}return this.callParent([B,C])},determineScrollbarWidth:function(G){var F=this,A=F.owner,E=A.grid,C=A.reserveScrollbar===false,B=E.reserveScrollbar&&!C,D=!B&&!C&&E.view.scrollFlags.y;G.manageScrollbar=D;if(!E.ownerGrid.collapsed&&(B||D)){delete F.scrollbarWidth}},calculate:function(D){var N=this,A=N.owner.grid,J=D.viewContext,B=D.state,C=D.context,I,O,K,G,M,L,F,H,E;N.callParent([D]);if(A&&B.parallelDone){I=J.lockingPartnerContext;O=A.ownerGrid;if(O.forceFit&&!B.reflexed){if(N.convertWidthsToFlexes(D)){N.cacheFlexes(D);N.done=false;D.invalidate({state:{reflexed:true,scrollbarAdjustment:N.getScrollbarAdjustment(D)}});return }}if((K=B.columnsChanged)===undefined){G=D.target.getVisibleGridColumns();K=false;for(L=0,M=G.length;L<M;L++){F=C.getCmp(G[L]);if(!F.lastBox||F.props.width!==F.lastBox.width){(K||(K=[]))[L]=F}}B.columnsChanged=K;D.setProp("columnsChanged",K)}if(D.manageScrollbar){H=N.getScrollbarAdjustment(D);if(H){E=J.getProp("viewOverflowY");if(E===undefined){N.done=false;return }if(!E){if(I){I.invalidate();I.headerContext.invalidate()}J.invalidate();D.invalidate({state:{scrollbarAdjustment:0}})}}}}},finishedLayout:function(A){this.callParent([A]);if(this.owner.ariaRole==="rowgroup"){this.innerCt.dom.setAttribute("role","row")}A.props.columnsChanged=null},convertWidthsToFlexes:function(A){var F=this,D=0,G=F.sizeModels.calculated,C,E,B,I,H;C=A.childItems;E=C.length;for(B=0;B<E;B++){I=C[B];H=I.target;D+=I.props.width;if(!(H.fixed||H.resizable===false)){H.flex=A.childItems[B].flex=I.props.width;H.width=null;I.widthModel=G}}return D!==A.props.width},getScrollbarAdjustment:function(D){var B=this,C=D.state,A=B.owner.grid,E=C.scrollbarAdjustment;if(E===undefined){E=0;if(A.reserveScrollbar||(D.manageScrollbar&&!A.ownerGrid.layout.ownerContext.heightModel.shrinkWrap)){E=B.scrollbarWidth}C.scrollbarAdjustment=E}return E},getContainerSize:function(B){var E=this,F,H,G,C,D,A,I,J;if(E.owner.isRootHeader){J=E.callParent([B]);if(J.gotWidth){J.width-=E.getScrollbarAdjustment(B)}}else{G=B.paddingContext.getPaddingInfo();F=H=0;if(!B.widthModel.shrinkWrap){++H;A=B.getProp("innerWidth");C=(typeof A==="number");if(C){++F;A-=G.width;if(A<0){A=0}}}if(!B.heightModel.shrinkWrap){++H;I=B.getProp("innerHeight");D=(typeof I==="number");if(D){++F;I-=G.height;if(I<0){I=0}}}return{width:A,height:I,needed:H,got:F,gotAll:F===H,gotWidth:C,gotHeight:D}}return J},publishInnerCtSize:function(E){var D=this,A=D.owner,B=E.peek("contentWidth"),C=0;if(B!=null&&A.isRootHeader){C=-E.state.scrollbarAdjustment}return D.callParent([E,C])}})