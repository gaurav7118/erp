Ext.define("Ext.grid.plugin.Clipboard",{extend:"Ext.plugin.AbstractClipboard",alias:"plugin.clipboard",requires:["Ext.util.Format","Ext.util.TSV"],formats:{cell:{get:"getCells"},html:{get:"getCellData"},raw:{get:"getCellData"}},getCellData:function(M,B){var J=this.getCmp(),G=J.getSelectionModel(),H=[],L=M==="raw",F=M==="text",P,N,D,K,A,C,E,O,I;G.getSelected().eachCell(function(Q){C=Q.column,I=Q.column.getView();E=Q.record;if(C.ignoreExport){return }if(A!==E){A=E;H.push(O=[])}K=C.dataIndex;if(L){D=E.data[K]}else{P=I.all.item(Q.rowIdx);if(!P){P=Ext.fly(I.createRowElement(E,Q.rowIdx))}N=P.down(C.getCellInnerSelector());D=N.dom.innerHTML;if(F){D=Ext.util.Format.stripTags(D)}}O.push(D);if(B&&K){E.set(K,null)}});return Ext.util.TSV.encode(H)},getCells:function(H,B){var F=this.getCmp(),D=F.getSelectionModel(),E=[],G,A,C,I;D.getSelected().eachCell(function(J){C=J.record;if(A!==C){A=C;E.push(I={model:C.self,fields:[]})}G=J.column.dataIndex;I.fields.push({name:G,value:C.data[G]});if(B&&G){C.set(G,null)}});return E},getTextData:function(B,A){return this.getCellData(B,A)},putCellData:function(F,L){var N=Ext.util.TSV.decode(F),O,P=N.length,M=P?N[0].length:0,G,J,I=this.getCmp().getView(),A=I.dataSource.getCount()-1,E=I.getVisibleColumnManager().getColumns().length-1,C=I.getNavigationModel(),H=C.getPosition(),K,B,D={};if(!H){I.getSelectionModel().getSelected().eachCell(function(Q){H=Q;return false})}if(H){H=new Ext.grid.CellContext(I).setPosition(H.record,H.column)}else{H=new Ext.grid.CellContext(I).setPosition(0,0)}B=H.colIdx;for(G=0;G<P;G++){O=N[G];for(J=0;J<M;J++){K=H.column.dataIndex;if(K){switch(L){case"raw":D[K]=O[J];break;case"text":D[K]=O[J];break;case"html":break}}if(H.colIdx===E){break}H.setColumn(H.colIdx+1)}H.record.set(D);if(H.rowIdx===A){break}H.setPosition(H.rowIdx+1,B)}},putTextData:function(A,B){this.putCellData(A,B)},getTarget:function(A){return A.body}})