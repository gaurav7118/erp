Ext.define("Ext.grid.selection.Cells",{extend:"Ext.grid.selection.Selection",type:"cells",isCells:true,clone:function(){var B=this,A=new B.self(B.view);if(B.startCell){A.startCell=B.startCell.clone();A.endCell=B.endCell.clone()}return A},contains:function(A){var B;if(!A||!A.isCellContext){return false}if(this.startCell){B=this.getRowRange();if(A.rowIdx>=B[0]&&A.rowIdx<=B[1]){B=this.getColumnRange();return(A.colIdx>=B[0]&&A.colIdx<=B[1])}}return false},eachRow:function(C,B){var E=this,F=E.getRowRange(),A=new Ext.grid.CellContext(E.view),D;for(D=F[0];D<=F[1];D++){A.setRow(D);if(C.call(B||E,A.record)===false){return }}},eachColumn:function(D,C){var E=this,A=E.getColumnRange(),B=new Ext.grid.CellContext(E.view),F;for(F=A[0];F<=A[1];F++){B.setColumn(F);if(D.call(C||E,B.column,F)===false){return }}},eachCell:function(D,C){var F=this,G=F.getRowRange(),A=F.getColumnRange(),B=new Ext.grid.CellContext(F.view),E,H;for(E=G[0];E<=G[1];E++){B.setRow(E);for(H=A[0];H<=A[1];H++){B.setColumn(H);if(D.call(C||F,B,H,E)===false){return }}}},getFirstRowIndex:function(){return this.startCell?Math.min(this.startCell.rowIdx,this.endCell.rowIdx):0},getLastRowIndex:function(){return this.startCell?Math.max(this.startCell.rowIdx,this.endCell.rowIdx):-1},getFirstColumnIndex:function(){return this.startCell?Math.min(this.startCell.colIdx,this.endCell.colIdx):0},getLastColumnIndex:function(){return this.startCell?Math.max(this.startCell.colIdx,this.endCell.colIdx):-1},privates:{clear:function(){var B=this,A=B.view;B.eachCell(function(C){A.onCellDeselect(C)});B.startCell=B.endCell=null},setRangeStart:function(B,A){this.startCell=(this.endCell=B.clone()).clone();this.view.onCellSelect(B)},setRangeEnd:function(B){var J=this,H,G,C,I,F,M,A,E,K=J.view,N=K.all,L=new Ext.grid.CellContext(K),D=K.getVisibleColumnManager().getColumns().length-1;J.endCell=B.clone();H=J.getRange();G=J.lastRange||H;C=Math.max(Math.min(H[0][1],G[0][1]),N.startIndex);I=Math.min(Math.max(H[1][1],G[1][1]),N.endIndex);F=Math.min(H[0][0],G[0][0]);M=Math.min(Math.max(H[1][0],G[1][0]),D);for(A=C;A<=I;A++){for(E=F;E<=M;E++){L.setPosition(A,E);if(A<H[0][1]||A>H[1][1]||E<H[0][0]||E>H[1][0]){K.onCellDeselect(L)}else{K.onCellSelect(L)}}}J.lastRange=H},extendRange:function(B){var C=this,A;if(B[B.type]<0){A=C.endCell.clone().setPosition(C.getLastRowIndex(),C.getLastColumnIndex());C.startCell=B.start.clone();C.setRangeEnd(A);C.view.getNavigationModel().setPosition(B.start)}else{C.startCell=C.startCell.setPosition(C.getFirstRowIndex(),C.getFirstColumnIndex());C.setRangeEnd(B.end);C.view.getNavigationModel().setPosition(B.end)}},getRange:function(){return[[this.getFirstColumnIndex(),this.getFirstRowIndex()],[this.getLastColumnIndex(),this.getLastRowIndex()]]},getRangeSize:function(){return this.getCount()},getCount:function(){var A=this.getRange();return(A[1][0]-A[0][0]+1)*(A[1][1]-A[0][1]+1)},selectAll:function(){var B=this,A=B.view;B.clear();B.setRangeStart(new Ext.grid.CellContext(A).setPosition(0,0));B.setRangeEnd(new Ext.grid.CellContext(A).setPosition(A.dataSource.getCount()-1,A.getVisibleColumnManager().getColumns().length-1))},isAllSelected:function(){var B=this.rangeStart,A=this.rangeEnd;if(B){if(!B.colIdx&&!B.rowIdx){return A.colIdx===A.view.getVisibleColumnManager().getColumns().length-1&&A.rowIdx===A.view.dataSource.getCount-1}}return false},getColumnRange:function(){return[this.getFirstColumnIndex(),this.getLastColumnIndex()]},getRowRange:function(){return[this.getFirstRowIndex(),this.getLastRowIndex()]},onSelectionFinish:function(){var A=this;if(A.getCount()){A.view.getSelectionModel().onSelectionFinish(A,new Ext.grid.CellContext(A.view).setPosition(A.getFirstRowIndex(),A.getFirstColumnIndex()),new Ext.grid.CellContext(A.view).setPosition(A.getLastRowIndex(),A.getLastColumnIndex()))}else{A.view.getSelectionModel().onSelectionFinish(A)}}}})