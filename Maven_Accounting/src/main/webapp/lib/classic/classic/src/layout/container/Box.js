Ext.define("Ext.layout.container.Box",{extend:"Ext.layout.container.Container",alias:"layout.box",alternateClassName:"Ext.layout.BoxLayout",requires:["Ext.layout.container.boxOverflow.None","Ext.layout.container.boxOverflow.Scroller","Ext.util.Format","Ext.dd.DragDropManager","Ext.resizer.Splitter"],type:"box",config:{align:"begin",constrainAlign:false,enableSplitters:true,overflowHandler:{$value:null,merge:function(B,A){if(typeof B==="string"){B={type:B}}return Ext.merge(A?Ext.Object.chain(A):{},B)}},padding:0,pack:"start",stretchMaxPartner:undefined,vertical:false,alignRoundingMethod:"round"},itemCls:Ext.baseCSSPrefix+"box-item",targetCls:Ext.baseCSSPrefix+"box-layout-ct",targetElCls:Ext.baseCSSPrefix+"box-target",innerCls:Ext.baseCSSPrefix+"box-inner",manageMargins:true,createsInnerCt:true,childEls:["innerCt","targetEl"],renderTpl:['{%var oc,l=values.$comp.layout,oh=l.overflowHandler;if (oh && oh.getPrefixConfig!==Ext.emptyFn) {if(oc=oh.getPrefixConfig())dh.generateMarkup(oc, out)}%}<div id="{ownerId}-innerCt" data-ref="innerCt" role="presentation" class="{[l.innerCls]}{[oh ? (" " + oh.getOverflowCls(l.direction)) : ""]}"><div id="{ownerId}-targetEl" data-ref="targetEl" class="{targetElCls}" role="presentation">{%this.renderBody(out, values)%}</div></div>{%if (oh && oh.getSuffixConfig!==Ext.emptyFn) {if(oc=oh.getSuffixConfig())dh.generateMarkup(oc, out)}%}',{disableFormats:true,definitions:"var dh=Ext.DomHelper;"}],constructor:function(A){var C=this,B;C.callParent(arguments);C.setVertical(C.vertical);C.flexSortFn=C.flexSort.bind(C);B=typeof C.padding;if(B==="string"||B==="number"){C.padding=Ext.util.Format.parseBox(C.padding);C.padding.height=C.padding.top+C.padding.bottom;C.padding.width=C.padding.left+C.padding.right}},_beginRe:/^(?:begin|left|top)$/,_centerRe:/^(?:center|middle)$/,_endRe:/^(?:end|right|bottom)$/,_percentageRe:/^\s*(\d+(?:\.\d*)?)\s*[%]\s*$/,getItemSizePolicy:function(P,Q){var K=this,I=K.sizePolicy,G=K.align,F=P.flex,N=G,J=K.names,H=J.height,M=J.width,B=P[M],O=P[H],D=K._percentageRe,C=D.test(B),E=(G==="stretch"),A=(G==="stretchmax"),L=K.constrainAlign;if(!Q&&(E||F||C||(L&&!A))){Q=K.owner.getSizeModel()}if(E){if(!D.test(O)&&Q[H].shrinkWrap){N="stretchmax"}}else{if(!A){if(D.test(O)){N="stretch"}else{if(L&&!Q[H].shrinkWrap){N="stretchmax"}else{N=""}}}}if(F||C){if(!Q[M].shrinkWrap){I=I.flex}}return I[N]},flexSort:function(L,K){var I=this.names.maxWidth,C=this.names.minWidth,J=Infinity,H=L.target,O=K.target,F=H.flex,E=O.flex,P=0,A,M,G,B,N,D;G=H[I]||J;B=O[I]||J;A=H[C]||0;M=O[C]||0;N=isFinite(A)||isFinite(M);D=isFinite(G)||isFinite(B);if(N||D){if(D){P=G-B}if(P===0&&N){P=M-A}if(P===0){if(D){P=E-F}else{P=F-E}}}return P},isItemBoxParent:function(A){return true},isItemShrinkWrap:function(A){return true},roundFlex:function(A){return Math.floor(A)},beginCollapse:function(B){var A=this;if(A.direction==="vertical"&&B.collapsedVertical()){B.collapseMemento.capture(["flex"]);delete B.flex}else{if(A.direction==="horizontal"&&B.collapsedHorizontal()){B.collapseMemento.capture(["flex"]);delete B.flex}}},beginExpand:function(A){A.collapseMemento.restore(["flex"])},beginLayout:function(E){var H=this,B=H.owner,D=B.stretchMaxPartner,A=H.innerCt.dom.style,G=H.names,F=H.overflowHandler,I=B.getScrollable(),C;E.boxNames=G;if(F){F.beginLayout(E)}if(typeof D==="string"){D=Ext.getCmp(D)||B.query(D)[0]}E.stretchMaxPartner=D&&E.context.getCmp(D);H.callParent(arguments);E.innerCtContext=E.getEl("innerCt",H);E.targetElContext=E.getEl("targetEl",H);if(I){E.ownerScrollable=I;C=I.getPosition();if(C.x||C.y){E.scrollRestore=C}}A.width=A.height=""},beginLayoutCycle:function(D,M){var J=this,A=D.state,K=D.ownerScrollable,H=J.align,I=D.boxNames,L=J.pack,C=J._centerRe,E=J.overflowHandler,B=D.state.canScroll,G,F;if(E){E.beginLayoutCycle(D,M)}J.callParent(arguments);D.parallelSizeModel=G=D[I.widthModel];D.perpendicularSizeModel=F=D[I.heightModel];D.boxOptions={align:H={stretch:H==="stretch",stretchmax:H==="stretchmax",center:C.test(H),bottom:J._endRe.test(H)},pack:L={center:C.test(L),end:L==="end"}};if(K){if(!B){A.canScroll={parallel:!G.shrinkWrap&&K[I.getX](),perpendicular:!F.shrinkWrap&&K[I.getY]()}}if(!A.actualScroll){A.actualScroll={parallel:false,perpendicular:false}}}if(H.stretch&&F.shrinkWrap){H.stretchmax=true;H.stretch=false}H.nostretch=!(H.stretch||H.stretchmax);if(G.shrinkWrap){L.center=L.end=false}J.cacheFlexes(D);J.targetEl.setWidth(20000)},cacheFlexes:function(K){var Z=this,L=K.boxNames,A=L.widthModel,G=L.heightModel,C=K.boxOptions.align.nostretch,R=0,B=K.childItems,T=B.length,X=[],M=0,U=0,Q=0,J=L.minWidth,W=L.minHeight,H=Z._percentageRe,V=0,Y=0,F,O,S,I,D,E,P,N;while(T--){O=B[T];F=O.target;E=O[A];if(E.calculated){O.flex=S=F.flex;if(S){R+=S;X.push(O);M+=F[J]||0}else{I=H.exec(F[L.width]);O.percentageParallel=parseFloat(I[1])/100;++V}}if(E.configured){P=F[L.width]}else{P=F[J]||0}Q+=P;D=O[G];if(C&&D.calculated){I=H.exec(F[L.height]);O.percentagePerpendicular=parseFloat(I[1])/100;++Y}if(D.configured){N=F[L.height]}else{N=F[W]||0}if(N>U){U=N}}K.flexedItems=X;K.flexedMinWidth=M;K.smallestWidth=Q;K.smallestHeight=U;K.totalFlex=R;K.percentageWidths=V;K.percentageHeights=Y;Ext.Array.sort(X,Z.flexSortFn)},calculate:function(C){var G=this,F=C.boxNames,A=C.state,E=A.actualScroll,I=A.needsScroll,B=A.canScroll,H=A.boxPlan||(A.boxPlan={}),D=G.overflowHandler;H.targetSize=G.getContainerSize(C);if(B&&!I){A.needsScroll=I={parallel:B.parallel&&H.targetSize[F.width]<C.smallestWidth,perpendicular:B.perpendicular&&H.targetSize[F.height]<C.smallestHeight}}if(!A.parallelDone){A.parallelDone=G.calculateParallel(C,F,H)}if(!A.perpendicularDone){A.perpendicularDone=G.calculatePerpendicular(C,F,H)}if(A.parallelDone&&A.perpendicularDone){if(B&&!A.scrollPass){if(I.parallel!==E.parallel||I.perpendicular!==E.perpendicular){C.invalidate({state:{scrollPass:true,canScroll:B,needsScroll:E}});G.done=false;return }}G.publishInnerCtSize(C);if(G.done&&C.boxOptions.align.stretchmax&&!A.stretchMaxDone){G.calculateStretchMax(C,F,H);A.stretchMaxDone=true}if(D){D.calculate(C)}}else{G.done=false}},calculateParallel:function(V,k,a){var P=this,M=V.parallelSizeModel.shrinkWrap,b=k.width,G=V.childItems,R=k.beforeX,f=k.afterX,J=k.setWidth,Y=G.length,U=V.flexedItems,e=U.length,O=V.boxOptions.pack,g=P.padding,B=a.targetSize,N=B[b],l=V.state,X=l.needsScroll,Q=l.canScroll,Z=0,H=g[R],d=H+g[f],S=Ext.getScrollbarSize(),E=S[k.width],A=S[k.height],h,W,F,K,L,I,C,j,c,T,D;if(!M&&!B[k.gotWidth]){return false}for(h=0;h<Y;++h){L=G[h];W=L.marginInfo||L.getMarginInfo();Z+=W[b];if(!L[k.widthModel].calculated){c=L.getProp(b);d+=c;if(isNaN(d)){return false}}}d+=Z;if(V.percentageWidths){T=N-Z;if(isNaN(T)){return false}for(h=0;h<Y;++h){L=G[h];if(L.percentageParallel){c=Math.ceil(T*L.percentageParallel);c=L.setWidth(c);d+=c}}}if(M){D=0;a.tooNarrow=false}else{D=N-d;if(X&&X.perpendicular){D-=A}a.tooNarrow=D<V.flexedMinWidth;if(a.tooNarrow&&Q&&Q.parallel){l.actualScroll.parallel=true}}j=d;F=D;K=V.totalFlex;for(h=0;h<e;h++){L=U[h];I=L.flex;C=P.roundFlex((I/K)*F);C=L[J](C);j+=C;F=Math.max(0,F-C);K-=I}if(O.center){H+=F/2;if(H<0){H=0}}else{if(O.end){H+=F}}for(h=0;h<Y;++h){L=G[h];W=L.marginInfo;H+=W[R];L.setProp(k.x,H);H+=W[f]+L.props[b]}j+=V.targetContext.getPaddingInfo()[b];V.state.contentWidth=j;if(X&&X.perpendicular){if(M){j+=E}V[k.hasOverflowY]=true;V.target.componentLayout[k.setWidthInDom]=true;V[k.invalidateScrollY]=Ext.isIE8}V[k.setContentWidth](j);return true},calculatePerpendicular:function(T,l,Z){var R=this,p=T.state,V=p.needsScroll,S=p.canScroll,D=T.perpendicularSizeModel.shrinkWrap,B=Z.targetSize,H=T.childItems,Y=H.length,K=Math.max,J=l.height,L=l.setHeight,G=l.beforeY,Q=l.y,h=R.padding,I=h[G],M=B[J]-I-h[l.afterY],e=T.boxOptions.align,N=e.stretch,O=e.stretchmax,o=e.center,n=e.bottom,g=R.constrainAlign,f=0,b=0,d=R.onBeforeConstrainInvalidateChild,a=R.onAfterConstrainInvalidateChild,A=Ext.getScrollbarSize().height,X,j,c,U,W,C,P,E,m,k,F;if(!D&&!B[l.gotHeight]){return false}if(N||((o||n)&&!D)){if(isNaN(M)){return false}}if(V&&V.parallel){if(D){k=true}else{M-=A;Z.targetSize[J]-=A}}if(N){C=M;f=K(C,T.smallestHeight)}else{for(j=0;j<Y;j++){P=H[j];U=(P.marginInfo||P.getMarginInfo())[J];if(!(F=P.percentagePerpendicular)){c=P.getProp(J)}else{++b;if(D){continue}else{c=F*M-U;c=P[l.setHeight](c)}}if(!D&&g&&P[l.heightModel].shrinkWrap&&c>M){P.invalidate({before:d,after:a,layout:R,childHeight:M,names:l});T.state.parallelDone=false}if(isNaN(f=K(f,c+U,P.target[l.minHeight]||0))){return false}}}if(k){f+=A;T[l.hasOverflowX]=true;T.target.componentLayout[l.setHeightInDom]=true;T[l.invalidateScrollX]=Ext.isIE8}E=T.stretchMaxPartner;if(E){T.setProp("maxChildHeight",f);m=E.childItems;if(m&&m.length){f=K(f,E.getProp("maxChildHeight"));if(isNaN(f)){return false}}}T[l.setContentHeight](f+R.padding[J]+T.targetContext.getPaddingInfo()[J]);if(k){f-=A}if(f>B[J]&&S&&S.perpendicular){p.actualScroll.perpendicular=true}Z.maxSize=f;if(O){C=f}else{if(o||n||b){if(g){C=D?f:M}else{C=D?f:K(M,f)}C-=T.innerCtContext.getBorderInfo()[J]}}for(j=0;j<Y;j++){P=H[j];U=P.marginInfo||P.getMarginInfo();X=I+U[G];if(N){P[L](C-U[J])}else{F=P.percentagePerpendicular;if(D&&F){U=P.marginInfo||P.getMarginInfo();c=F*C-U[J];c=P.setHeight(c)}if(o){W=C-P.props[J];if(W>0){X=I+Math[R.alignRoundingMethod](W/2)}}else{if(n){X=K(0,C-X-P.props[J])}}}P.setProp(Q,X)}return true},onBeforeConstrainInvalidateChild:function(B,A){var C=A.names.heightModel;if(!B[C].constrainedMin){B[C]=Ext.layout.SizeModel.calculated}},onAfterConstrainInvalidateChild:function(B,A){var C=A.names;B.setProp(C.beforeY,0);if(B[C.heightModel].calculated){B[C.setHeight](A.childHeight)}},calculateStretchMax:function(C,I,K){var J=this,G=I.height,L=I.width,F=C.childItems,A=F.length,N=K.maxSize,M=J.onBeforeStretchMaxInvalidateChild,E=J.onAfterStretchMaxInvalidateChild,O,H,D,B;for(D=0;D<A;++D){O=F[D];H=O.props;B=N-O.getMarginInfo()[G];if(B!==H[G]||O[I.heightModel].constrained){O.invalidate({before:M,after:E,layout:J,childWidth:H[L],childHeight:B,childX:H.x,childY:H.y,names:I})}}},onBeforeStretchMaxInvalidateChild:function(B,A){var C=A.names.heightModel;if(!B[C].constrainedMax){B[C]=Ext.layout.SizeModel.calculated}},onAfterStretchMaxInvalidateChild:function(D,C){var E=C.names,A=C.childHeight,B=C.childWidth;D.setProp("x",C.childX);D.setProp("y",C.childY);if(D[E.heightModel].calculated){D[E.setHeight](A)}if(D[E.widthModel].calculated){D[E.setWidth](B)}},completeLayout:function(B){var I=this,H=B.invalidateScrollX,G=B.invalidateScrollY,C=I.overflowHandler,J=B.scrollRestore,E,A,F,D,K;if(C){C.completeLayout(B)}if(H||G){A=I.getTarget();E=A.dom;K=E.style;if(H){F=A.getStyle("overflowX");if(F==="auto"){F=K.overflowX;K.overflowX="scroll"}else{H=false}}if(G){D=A.getStyle("overflowY");if(D==="auto"){D=K.overflowY;K.overflowY="scroll"}else{G=false}}if(H||G){E.scrollWidth;if(H){K.overflowX=F}if(G){K.overflowY=D}}}if(J){B.ownerScrollable.scrollTo(J.x,J.y)}},finishedLayout:function(B){var A=this.overflowHandler;if(A){A.finishedLayout(B)}this.callParent(arguments)},getLayoutItems:function(){var H=this.callParent(),B=H.length,E,D,C,I,G,F,A;for(C=0;C<B;++C){if((I=H[C]).isSplitter){continue}A=I.splitter;if(I.hidden){if(A){if(!A.hidden){A.hidden=true;if(A.el){A.el.hide()}}}continue}if(A){F=A.collapseTarget==="next"}else{F=false}D=null;if(E&&G){if(G.hidden){G.hidden=false;if(G.el){G.el.show()}}if(F){D=true}}else{if(F){D=!E}}if(D!==null&&A.hidden!==D){A.hidden=D;if(A.el){A.el.setVisible(!D)}}G=!F&&A;E=I}if(E&&G&&!G.hidden){G.hidden=true;if(G.el){G.el.hide()}}return H},getScrollerEl:function(){return this.innerCt},insertSplitter:function(D,C,F,B){var E={xtype:"splitter",id:D.id+"-splitter",hidden:F,splitterFor:D,synthetic:true},A=C+((B.collapseTarget==="prev")?1:0);E[this.names.height]="100%";if(B){Ext.apply(E,B)}D.splitter=this.owner.add(A,E)},publishInnerCtSize:function(B,D){D=D||0;var I=this,A=B.state,H=B.boxNames,G=H.height,K=H.width,F=B.boxOptions.align,M=I.padding,J=A.boxPlan,E=J.targetSize,O=J.maxSize,L=A.needsScroll,P=B.innerCtContext,C,N;if(B.parallelSizeModel.shrinkWrap||(J.tooNarrow&&A.canScroll)){C=A.contentWidth-B.targetContext.getPaddingInfo()[K]}else{C=E[K];if(L&&L.perpendicular){C-=Ext.getScrollbarSize()[K]}}C-=D;I.owner.tooNarrow=J.tooNarrow;if(F.stretch){N=O}else{N=J.maxSize+M[H.beforeY]+M[H.afterY]+P.getBorderInfo()[G];if(!B.perpendicularSizeModel.shrinkWrap&&(F.center||F.bottom)){N=Math.max(E[G],N)}}P[H.setWidth](C);P[H.setHeight](N);B.targetElContext.setWidth(B.innerCtContext.props.width-(I.vertical?0:(D||0)));if(isNaN(C+N)){I.done=false}},onAdd:function(D,A){var C=this,B=C.enableSplitters&&D.split&&!D.isButton;C.callParent(arguments);if(B){if(B===true){B={collapseTarget:"next"}}else{if(Ext.isString(B)){B={collapseTarget:B==="before"?"next":"prev"}}else{B=Ext.apply({collapseTarget:B.side==="before"?"next":"prev"},B)}}C.insertSplitter(D,A,!!D.hidden,B)}},onRemove:function(B,E){var F=this,H=F.names,A=F.owner,G=B.splitter,C=F.overflowHandler,D;F.callParent(arguments);if(G&&A.contains(G)){A.doRemove(G,true);B.splitter=null}if(C){C.onRemove(B)}if(B.layoutMarginCap===F.id){delete B.layoutMarginCap}if(!A.destroying&&!E&&B.rendered){D=B.getEl();if(D){D.setStyle(H.beforeY,"");D.setStyle(H.beforeX,"");D.setStyle("margin","")}}},applyOverflowHandler:function(B,A){var C;if(typeof B==="string"){B={type:B}}C=B.type;if(A&&A.type===B.type){delete B.type;A.setConfig(B);return A}B.layout=this;return Ext.Factory.boxOverflow(B)},getRenderTarget:function(){return this.targetEl},getElementTarget:function(){return this.innerCt},calculateChildBox:Ext.deprecated(),calculateChildBoxes:Ext.deprecated(),updateChildBoxes:Ext.deprecated(),destroy:function(){var A=this;Ext.destroy(A.innerCt,A.overflowHandler);A.flexSortFn=A.innerCt=null;A.callParent()},getRenderData:function(){var A=this.callParent();A.targetElCls=this.targetElCls;return A},updateVertical:function(B){var E=this,C=E.overflowHandler,A=E.owner,D=E._props;Ext.apply(E,B?D.vbox:D.hbox);if(C&&A&&A.rendered){C.setVertical(B)}},_props:{"hbox":{direction:"horizontal",oppositeDirection:"vertical",horizontal:true,vertical:false,names:{beforeX:"left",beforeScrollX:"left",leftCap:"Left",afterX:"right",width:"width",contentWidth:"contentWidth",minWidth:"minWidth",maxWidth:"maxWidth",widthCap:"Width",widthModel:"widthModel",widthIndex:0,x:"x",getX:"getX",setX:"setX",scrollLeft:"scrollLeft",overflowX:"overflowX",hasOverflowX:"hasOverflowX",invalidateScrollX:"invalidateScrollX",parallelMargins:"lr",center:"middle",beforeY:"top",afterY:"bottom",height:"height",contentHeight:"contentHeight",minHeight:"minHeight",maxHeight:"maxHeight",heightCap:"Height",heightModel:"heightModel",heightIndex:1,y:"y",getY:"getY",setY:"setY",overflowY:"overflowY",hasOverflowY:"hasOverflowY",invalidateScrollY:"invalidateScrollY",perpendicularMargins:"tb",getWidth:"getWidth",getHeight:"getHeight",setWidth:"setWidth",setHeight:"setHeight",gotWidth:"gotWidth",gotHeight:"gotHeight",setContentWidth:"setContentWidth",setContentHeight:"setContentHeight",setWidthInDom:"setWidthInDom",setHeightInDom:"setHeightInDom",getScrollLeft:"getScrollLeft",setScrollLeft:"setScrollLeft",scrollTo:"scrollTo"},sizePolicy:{flex:{"":{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:1}}},"vbox":{direction:"vertical",oppositeDirection:"horizontal",horizontal:false,vertical:true,names:{beforeX:"top",beforeScrollX:"top",leftCap:"Top",afterX:"bottom",width:"height",contentWidth:"contentHeight",minWidth:"minHeight",maxWidth:"maxHeight",widthCap:"Height",widthModel:"heightModel",widthIndex:1,x:"y",getX:"getY",setX:"setY",scrollLeft:"scrollTop",overflowX:"overflowY",hasOverflowX:"hasOverflowY",invalidateScrollX:"invalidateScrollY",parallelMargins:"tb",center:"center",beforeY:"left",afterY:"right",height:"width",contentHeight:"contentWidth",minHeight:"minWidth",maxHeight:"maxWidth",heightCap:"Width",heightModel:"widthModel",heightIndex:0,y:"x",getY:"getX",setY:"setX",overflowY:"overflowX",hasOverflowY:"hasOverflowX",invalidateScrollY:"invalidateScrollX",perpendicularMargins:"lr",getWidth:"getHeight",getHeight:"getWidth",setWidth:"setHeight",setHeight:"setWidth",gotWidth:"gotHeight",gotHeight:"gotWidth",setContentWidth:"setContentHeight",setContentHeight:"setContentWidth",setWidthInDom:"setHeightInDom",setHeightInDom:"setWidthInDom",getScrollLeft:"getScrollTop",setScrollLeft:"setScrollTop",scrollTo:"scrollTo"},sizePolicy:{flex:{"":{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:0,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:1,setsHeight:0}}}}})