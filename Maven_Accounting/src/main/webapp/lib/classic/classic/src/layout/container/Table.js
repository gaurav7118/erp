Ext.define("Ext.layout.container.Table",{alias:["layout.table"],extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.TableLayout",type:"table",createsInnerCt:true,targetCls:Ext.baseCSSPrefix+"table-layout-ct",tableCls:Ext.baseCSSPrefix+"table-layout",cellCls:Ext.baseCSSPrefix+"table-layout-cell",childEls:["table","tbody"],tableAttrs:null,getItemSizePolicy:function(A){return this.autoSizePolicy},initInheritedState:function(B,A){A.inShrinkWrapTable=true},getLayoutItems:function(){var F=this,B=[],C=F.callParent(),A=C.length,E,D;for(D=0;D<A;D++){E=C[D];if(!E.hidden){B.push(E)}}return B},getHiddenItems:function(){var B=[],C=this.owner.items.items,A=C.length,D,E;for(D=0;D<A;++D){E=C[D];if(E.rendered&&E.hidden){B.push(E)}}return B},renderChildren:function(){var H=this,G=H.getLayoutItems(),E=H.tbody.dom,N=E.rows,F=G.length,C=H.getHiddenItems(),M,K,B,A,L,J,I,D;M=H.calculateCells(G);for(D=0;D<F;D++){K=M[D];B=K.rowIdx;A=K.cellIdx;L=G[D];J=N[B];if(!J){J=E.insertRow(B);if(H.trAttrs){J.set(H.trAttrs)}}I=Ext.get(J.cells[A]||J.insertCell(A));if(!L.rendered){H.renderItem(L,I,0)}else{if(!H.isValidParent(L,I,B,A,E)){H.moveItem(L,I,0)}}if(H.tdAttrs){I.set(H.tdAttrs)}if(L.tdAttrs){I.set(L.tdAttrs)}I.set({colSpan:L.colspan||1,rowSpan:L.rowspan||1,cls:H.cellCls+" "+(L.cellCls||"")});if(!M[D+1]||M[D+1].rowIdx!==B){A++;while(J.cells[A]){J.deleteCell(A)}}}B++;while(E.rows[B]){E.deleteRow(B)}for(D=0,F=C.length;D<F;++D){H.ensureInDocument(C[D].getEl())}},ensureInDocument:function(A){var B=A.dom.parentNode;while(B){if(B.tagName.toUpperCase()==="BODY"){return }B=B.parentNode}Ext.getDetachedBody().appendChild(A)},calculate:function(F){if(!F.hasDomProp("containerChildrenSizeDone")){this.done=false}else{var C=F.targetContext,B=F.widthModel.shrinkWrap,A=F.heightModel.shrinkWrap,G=A||B,D=G&&this.table.dom,E=G&&C.getPaddingInfo();if(B){F.setContentWidth(D.offsetWidth+E.width,true)}if(A){F.setContentHeight(D.offsetHeight+E.height,true)}}},calculateCells:function(H){var J=[],B=0,E=0,A=0,F=this.columns||Infinity,K=[],G=H.length,I,D,C;for(D=0;D<G;D++){I=H[D];while(E>=F||K[E]>0){if(E>=F){E=0;A=0;B++;for(C=0;C<F;C++){if(K[C]>0){K[C]--}}}else{E++}}J.push({rowIdx:B,cellIdx:A});for(C=I.colspan||1;C;--C){K[E]=I.rowspan||1;++E}++A}return J},getRenderTree:function(){var H=this,F=H.getLayoutItems(),M=[],N=Ext.apply({tag:"table",id:H.owner.id+"-table","data-ref":"table",role:"presentation",cls:H.tableCls,cellspacing:0,cellpadding:0,cn:{tag:"tbody",id:H.owner.id+"-tbody","data-ref":"tbody",role:"presentation",cn:M}},H.tableAttrs),C=H.tdAttrs,D,E=F.length,L,J,G,B,A,I,K;K=H.calculateCells(F);for(D=0;D<E;D++){L=F[D];J=K[D];B=J.rowIdx;A=J.cellIdx;G=M[B];if(!G){G=M[B]={tag:"tr",role:"presentation",cn:[]};if(H.trAttrs){Ext.apply(G,H.trAttrs)}}I=G.cn[A]={tag:"td",role:"presentation"};if(C){Ext.apply(I,C)}Ext.apply(I,{colSpan:L.colspan||1,rowSpan:L.rowspan||1,cls:H.cellCls+" "+(L.cellCls||"")});H.configureItem(L);I.cn=L.getRenderTree()}return N},isValidParent:function(C,D,B,A){if(arguments.length===3){return this.table.isAncestor(C.el)}return C.el.dom.parentNode===this.tbody.dom.rows[B].cells[A]}})