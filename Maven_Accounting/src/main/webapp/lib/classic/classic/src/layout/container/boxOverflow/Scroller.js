Ext.define("Ext.layout.container.boxOverflow.Scroller",{extend:"Ext.layout.container.boxOverflow.None",requires:["Ext.util.ClickRepeater","Ext.Element"],alternateClassName:"Ext.layout.boxOverflow.Scroller",alias:["box.overflow.scroller","box.overflow.Scroller"],mixins:{observable:"Ext.mixin.Observable"},animateScroll:false,scrollIncrement:20,wheelIncrement:10,scrollRepeatInterval:60,scrollDuration:400,scrollerCls:Ext.baseCSSPrefix+"box-scroller",beforeSuffix:"-before-scroller",afterSuffix:"-after-scroller",constructor:function(A){var B=this;B.mixins.observable.constructor.call(B,A);B.scrollPosition=0;B.scrollSize=0},getPrefixConfig:function(){return{role:"presentation",id:this.layout.owner.id+this.beforeSuffix,cls:this.createScrollerCls("beforeX"),style:"display:none"}},getSuffixConfig:function(){return{role:"presentation",id:this.layout.owner.id+this.afterSuffix,cls:this.createScrollerCls("afterX"),style:"display:none"}},createScrollerCls:function(E){var G=this,F=G.layout,B=F.owner,D=G.getOwnerType(B),A=G.scrollerCls,C=A+" "+A+"-"+F.names[E]+" "+A+"-"+D+" "+A+"-"+D+"-"+B.ui;if(B.plain){C+=" "+A+"-plain"}return C},getOverflowCls:function(A){return this.scrollerCls+"-body-"+A},beginLayout:function(A){A.innerCtScrollPos=this.getScrollPosition();this.callParent(arguments)},finishedLayout:function(D){var C=this,F=D.state.boxPlan,B=C.layout,E=B.names,G=Math.min(C.getMaxScrollPosition(),D.innerCtScrollPos),A;if(F&&F.tooNarrow){A=D.childItems[D.childItems.length-1].props;C.scrollSize=A[E.x]+A[E.width];C.updateScrollButtons();B.innerCt[E.setScrollLeft](G)}C.callParent([D])},handleOverflow:function(B){var G=this,F=G.layout.names,H=F.getWidth,I=F.parallelMargins,C,E,D,A;G.showScrollers();D=G.getBeforeScroller();A=G.getAfterScroller();C=D[H]()+A[H]()+D.getMargin(I)+A.getMargin(I);E=B.targetContext.getPaddingInfo()[F.width];return{reservedSpace:Math.max(C-E,0)}},getBeforeScroller:function(){var A=this;return A._beforeScroller||(A._beforeScroller=A.createScroller(A.beforeSuffix,"beforeRepeater","scrollLeft"))},getAfterScroller:function(){var A=this;return A._afterScroller||(A._afterScroller=A.createScroller(A.afterSuffix,"afterRepeater","scrollRight"))},createScroller:function(F,D,G){var E=this,C=E.layout.owner,B=E.scrollerCls,A;A=C.el.getById(C.id+F);A.addClsOnOver(B+"-hover");A.addClsOnClick(B+"-pressed");A.setVisibilityMode(Ext.Element.DISPLAY);E[D]=new Ext.util.ClickRepeater(A,{interval:E.scrollRepeatInterval,handler:G,scope:E});return A},createWheelListener:function(){var A=this;A.wheelListener=A.layout.innerCt.on("mousewheel",A.onMouseWheel,A,{destroyable:true})},onMouseWheel:function(A){A.stopEvent();this.scrollBy(this.getWheelDelta(A)*this.wheelIncrement*-1,false)},getWheelDelta:function(A){return A.getWheelDelta()},clearOverflow:function(){this.hideScrollers()},showScrollers:function(){var A=this;if(!A.wheelListener){A.createWheelListener()}A.getBeforeScroller().show();A.getAfterScroller().show();A.layout.owner.addClsWithUI(A.layout.direction==="vertical"?"vertical-scroller":"scroller")},hideScrollers:function(){var B=this,C=B.getBeforeScroller(),A=B.getAfterScroller();if(C){C.hide();A.hide();B.layout.owner.removeClsWithUI(B.layout.direction==="vertical"?"vertical-scroller":"scroller")}},destroy:function(){Ext.destroyMembers(this,"beforeRepeater","afterRepeater","_beforeScroller","_afterScroller","wheelListener");this.callParent()},scrollBy:function(B,A){this.scrollTo(this.getScrollPosition()+B,A)},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},updateScrollButtons:function(){var B=this,D=B.getBeforeScroller(),A=B.getAfterScroller(),C;if(!D||!A){return }C=B.scrollerCls+"-disabled";D[B.atExtremeBefore()?"addCls":"removeCls"](C);A[B.atExtremeAfter()?"addCls":"removeCls"](C);B.scrolling=false},scrollLeft:function(){this.scrollBy(-this.scrollIncrement,false)},scrollRight:function(){this.scrollBy(this.scrollIncrement,false)},getScrollPosition:function(){var C=this,B=C.layout,A;if(isNaN(C.scrollPosition)){A=B.innerCt[B.names.getScrollLeft]()}else{A=C.scrollPosition}return A},getMaxScrollPosition:function(){var B=this,A=B.layout,C=B.scrollSize-A.innerCt.lastBox[A.names.width];return(C<0)?0:C},atExtremeBefore:function(){return !this.getScrollPosition()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollPosition()},setVertical:function(){var C=this,D=C.getBeforeScroller(),B=C.getAfterScroller(),E=C.layout.names,A=C.scrollerCls;D.removeCls(A+"-"+E.beforeY);B.removeCls(A+"-"+E.afterY);D.addCls(A+"-"+E.beforeX);B.addCls(A+"-"+E.afterX);this.callParent()},scrollTo:function(A,B){var F=this,E=F.layout,G=E.names,D=F.getScrollPosition(),C=Ext.Number.constrain(A,0,F.getMaxScrollPosition());if(C!==D&&!F.scrolling){F.scrollPosition=NaN;if(B===undefined){B=F.animateScroll}E.innerCt[G.scrollTo](G.beforeScrollX,C,B?F.getScrollAnim():false);if(B){F.scrolling=true}else{F.updateScrollButtons()}F.fireEvent("scroll",F,C,B?F.getScrollAnim():false)}},scrollToItem:function(J,C){var I=this,F=I.layout,D=F.owner,H=F.names,B=F.innerCt,A,E,G;J=I.getItem(J);if(J!==undefined){if(J===D.items.first()){G=0}else{if(J===D.items.last()){G=I.getMaxScrollPosition()}else{A=I.getItemVisibility(J);if(!A.fullyVisible){E=J.getBox(false,true);G=E[H.x];if(A.hiddenEnd){G-=(B[H.getWidth]()-E[H.width])}}}}if(G!==undefined){I.scrollTo(G,C)}}},getItemVisibility:function(I){var G=this,B=G.getItem(I).getBox(true,true),C=G.layout,F=C.names,E=B[F.x],D=E+B[F.width],A=G.getScrollPosition(),H=A+C.innerCt[F.getWidth]();return{hiddenStart:E<A,hiddenEnd:D>H,fullyVisible:E>=A&&D<=H}}})