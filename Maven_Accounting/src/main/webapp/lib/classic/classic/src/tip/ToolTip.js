Ext.define("Ext.tip.ToolTip",{extend:"Ext.tip.Tip",alias:"widget.tooltip",alternateClassName:"Ext.ToolTip",autoHide:true,showDelay:500,hideDelay:200,dismissDelay:5000,trackMouse:false,anchorToTarget:true,anchorOffset:0,targetCounter:0,quickShowInterval:250,hideAction:"hide",fadeOutDuration:1000,ariaRole:"tooltip",initComponent:function(){var A=this;A.callParent(arguments);A.lastActive=new Date();A.setTarget(A.target);A.origAnchor=A.anchor},onRender:function(B,A){var C=this;C.callParent(arguments);C.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+C.getAnchorPosition();if(C.sticky){C.el.dom.setAttribute("data-sticky",true)}C.anchorEl=C.el.createChild({role:"presentation",cls:Ext.baseCSSPrefix+"tip-anchor "+C.anchorCls})},setTarget:function(D){var B=this,A=Ext.get(D),C;if(B.target){C=Ext.get(B.target);if(Ext.supports.Touch){B.mun(C,"tap",B.onTargetOver,B)}else{B.mun(C,{mouseover:B.onTargetOver,mouseout:B.onTargetOut,mousemove:B.onMouseMove,scope:B})}}B.target=A;if(A){if(Ext.supports.Touch){B.mon(A,{tap:B.onTargetOver,scope:B})}else{B.mon(A,{mouseover:B.onTargetOver,mouseout:B.onTargetOut,mousemove:B.onMouseMove,scope:B})}}if(B.anchor){B.anchorTarget=B.target}},onMouseMove:function(D){var B=this,A,C;if(!B.target||B.target.contains(D.target)){A=B.delegate?D.getTarget(B.delegate):(B.triggerElement=true);if(A){B.targetXY=D.getXY();if(A===B.triggerElement){if(!B.hidden&&B.trackMouse){C=B.getTargetXY();if(B.constrainPosition){C=B.el.adjustForConstraints(C,B.el.parent())}B.setPagePosition(C)}}else{B.hide();B.lastActive=new Date(0);B.onTargetOver(D)}}else{if((!B.closable&&B.isVisible())&&B.autoHide!==false){B.delayHide()}}}},getTargetXY:function(){var I=this,D,C,M,A,H,K,E,L,J,B,G,F;if(I.delegate){I.anchorTarget=I.triggerElement}if(I.anchor){I.targetCounter++;C=I.getOffsets();M=(I.anchorToTarget&&!I.trackMouse)?I.getAlignToXY(I.anchorTarget,I.getAnchorAlign()):I.targetXY;A=Ext.Element.getViewportWidth()-5;H=Ext.Element.getViewportHeight()-5;K=document.documentElement;E=document.body;L=(K.scrollLeft||E.scrollLeft||0)+5;J=(K.scrollTop||E.scrollTop||0)+5;B=[M[0]+C[0],M[1]+C[1]];G=I.getSize();F=I.constrainPosition;I.anchorEl.removeCls(I.anchorCls);if(I.targetCounter<2&&F){if(B[0]<L){if(I.anchorToTarget){I.defaultAlign="l-r";if(I.mouseOffset){I.mouseOffset[0]*=-1}}I.anchor="left";return I.getTargetXY()}if(B[0]+G.width>A){if(I.anchorToTarget){I.defaultAlign="r-l";if(I.mouseOffset){I.mouseOffset[0]*=-1}}I.anchor="right";return I.getTargetXY()}if(B[1]<J){if(I.anchorToTarget){I.defaultAlign="t-b";if(I.mouseOffset){I.mouseOffset[1]*=-1}}I.anchor="top";return I.getTargetXY()}if(B[1]+G.height>H){if(I.anchorToTarget){I.defaultAlign="b-t";if(I.mouseOffset){I.mouseOffset[1]*=-1}}I.anchor="bottom";return I.getTargetXY()}}I.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+I.getAnchorPosition();I.anchorEl.addCls(I.anchorCls);I.targetCounter=0;return B}else{D=I.getMouseOffset();return(I.targetXY)?[I.targetXY[0]+D[0],I.targetXY[1]+D[1]]:D}},calculateConstrainedPosition:function(B){var C=this,E,A,D;if(!B&&C.isContainedFloater()){E=C.isVisible();if(!E){C.el.show()}A=C.getTargetXY();if(!E){C.el.hide()}D=C.floatParent.getTargetEl().getViewRegion();A[0]-=D.left;A[1]-=D.top}else{A=C.callOverridden(arguments)}return A},getMouseOffset:function(){var A=this,B=A.anchor?[0,0]:[15,18];if(A.mouseOffset){B[0]+=A.mouseOffset[0];B[1]+=A.mouseOffset[1]}return B},fadeOut:function(){var A=this;A.el.fadeOut({duration:A.fadeOutDuration,callback:function(){A.hide();A.el.setOpacity("")}})},getAnchorPosition:function(){var B=this,A;if(B.anchor){B.tipAnchor=B.anchor.charAt(0)}else{A=B.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!A){Ext.raise('The AnchorTip.defaultAlign value "'+B.defaultAlign+'" is invalid.')}B.tipAnchor=A[1].charAt(0)}switch(B.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var C=this,D,B,A=C.getAnchorPosition().charAt(0);if(C.anchorToTarget&&!C.trackMouse){switch(A){case"t":B=[0,9];break;case"b":B=[0,-13];break;case"r":B=[-13,0];break;default:B=[9,0];break}}else{switch(A){case"t":B=[-15-C.anchorOffset,30];break;case"b":B=[-19-C.anchorOffset,-13-C.el.dom.offsetHeight];break;case"r":B=[-15-C.el.dom.offsetWidth,-13-C.anchorOffset];break;default:B=[25,-13-C.anchorOffset];break}}D=C.getMouseOffset();B[0]+=D[0];B[1]+=D[1];return B},onTargetOver:function(D){var C=this,B=C.delegate,A;if(C.disabled||D.within(C.target.dom,true)){return }A=B?D.getTarget(B):true;if(A){C.triggerElement=A;C.triggerEvent=D;C.clearTimer("hide");C.targetXY=D.getXY();C.delayShow()}},delayShow:function(C){var A=this,B=A.el&&(C===false||!A.trackMouse)&&A.getTargetXY();if(A.hidden&&!A.showTimer){if(Ext.Date.getElapsed(A.lastActive)<A.quickShowInterval){A.show()}else{A.showTimer=Ext.defer(A.showFromDelay,A.showDelay,A,[B])}}else{if(!A.hidden&&A.autoHide!==false){A.show(B)}}},showFromDelay:function(B){var A=this;if(A.disabled){return }A.fromDelayShow=true;A.show(B);delete A.fromDelayShow},onShowVeto:function(){this.callParent();delete this.triggerElement;this.clearTimer("show")},onTargetOut:function(D){var B=this,A=B.triggerElement,C=A===true?B.target:A;if(B.disabled||!A||D.within(C,true)){return }if(B.showTimer){B.clearTimer("show");B.triggerElement=null}if(B.autoHide!==false){B.delayHide()}},delayHide:function(){var A=this;if(!A.hidden&&!A.hideTimer){A.hideTimer=Ext.defer(A[A.hideAction],A.hideDelay,A)}},hide:function(){var A=this;A.clearTimer("dismiss");A.lastActive=new Date();if(A.anchorEl){A.anchorEl.hide()}A.callParent(arguments);delete A.triggerElement},show:function(B){var A=this;this.callParent();if(this.hidden===false){if(A.anchor){A.anchor=A.origAnchor}if(!A.calledFromShowAt){A.showAt(B||A.getTargetXY())}}},showAt:function(B){var A=this;A.lastActive=new Date();A.clearTimers();A.calledFromShowAt=true;if(!A.isVisible()){this.callParent(arguments)}if(A.isVisible()){A.setPagePosition(B[0],B[1]);if(A.constrainPosition||A.constrain){A.doConstrain()}A.toFront(true);A.el.syncUnderlays();if(A.dismissDelay&&A.autoHide!==false){A.dismissTimer=Ext.defer(A.hide,A.dismissDelay,A)}}delete A.calledFromShowAt},syncAnchor:function(){var C=this,A,B,D;switch(C.tipAnchor.charAt(0)){case"t":A="b";B="tl";D=[20+C.anchorOffset,1];break;case"r":A="l";B="tr";D=[-1,12+C.anchorOffset];break;case"b":A="t";B="bl";D=[20+C.anchorOffset,-1];break;default:A="r";B="tl";D=[1,12+C.anchorOffset];break}C.anchorEl.alignTo(C.el,A+"-"+B,D);C.anchorEl.setStyle("z-index",parseInt(C.el.getZIndex(),10)||0+1).setVisibilityMode(Ext.Element.DISPLAY)},afterSetPosition:function(A,C){var B=this;B.callParent(arguments);if(B.anchor){B.syncAnchor();if(!B.anchorEl.isVisible()){B.anchorEl.show()}}else{B.anchorEl.hide()}},_timerNames:{},clearTimer:function(A){var B=this,D=B._timerNames,C=D[A]||(D[A]=A+"Timer"),E=B[C];if(E){clearTimeout(E);B[C]=null}},clearTimers:function(){var A=this;A.clearTimer("show");A.clearTimer("dismiss");A.clearTimer("hide")},onShow:function(){var A=this;A.callParent();A.mon(Ext.getDoc(),"mousedown",A.onDocMouseDown,A)},onHide:function(){var A=this;A.callParent();A.mun(Ext.getDoc(),"mousedown",A.onDocMouseDown,A)},onDocMouseDown:function(B){var A=this;if(!A.closable&&!B.within(A.el.dom)){A.disable();Ext.defer(A.doEnable,100,A)}},doEnable:function(){if(!this.destroyed){this.enable()}},onDisable:function(){this.callParent();this.clearTimers();this.hide()},beforeDestroy:function(){var A=this;A.clearTimers();Ext.destroy(A.anchorEl);delete A.anchorEl;delete A.target;delete A.anchorTarget;delete A.triggerElement;A.callParent()},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this);this.callParent()}})