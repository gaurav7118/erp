Ext.define("Ext.view.BoundListKeyNav",{extend:"Ext.view.NavigationModel",alias:"view.navigation.boundlist",navigateOnSpace:true,initKeyNav:function(A){var B=this,C=A.pickerField;if(!B.keyNav){B.callParent([A]);B.keyNav.map.addBinding({key:Ext.event.Event.ESC,fn:B.onKeyEsc,scope:B})}if(!C){return }if(!C.rendered){C.on("render",Ext.Function.bind(B.initKeyNav,B,[A],0),B,{single:true});return }B.fieldKeyNav=new Ext.util.KeyNav({disabled:true,target:C.inputEl,forceKeyDown:true,up:B.onKeyUp,down:B.onKeyDown,right:B.onKeyRight,left:B.onKeyLeft,pageDown:B.onKeyPageDown,pageUp:B.onKeyPageUp,home:B.onKeyHome,end:B.onKeyEnd,tab:B.onKeyTab,space:B.onKeySpace,enter:B.onKeyEnter,A:{ctrl:true,handler:B.onSelectAllKeyPress},priority:1001,scope:B})},processViewEvent:function(B,A,E,C,D){if(D.within(B.listWrap)){return D}if(D.getKey()===D.ESC){if(Ext.fly(D.target).isInputField()){D.target=D.target.parentNode}return D}},enable:function(){this.fieldKeyNav.enable();this.callParent()},disable:function(){this.fieldKeyNav.disable();this.callParent()},onItemMouseDown:function(B,A,E,C,D){this.callParent([B,A,E,C,D]);D.preventDefault()},onKeyUp:function(G){var E=this,B=E.view,D=B.all,F=B.highlightedItem,C=F?B.indexOf(F):-1,A=C>0?C-1:D.getCount()-1;E.setPosition(A);G.preventDefault()},onKeyDown:function(G){var E=this,B=E.view,D=B.all,F=B.highlightedItem,C=F?B.indexOf(F):-1,A=C<D.getCount()-1?C+1:0;E.setPosition(A);G.preventDefault()},onKeyLeft:Ext.returnTrue,onKeyRight:Ext.returnTrue,onKeyTab:function(C){var A=this.view,B=A.pickerField;if(A.isVisible()){if(B.selectOnTab){this.selectHighlighted(C)}if(B.collapse){B.collapse()}}return true},onKeyEnter:function(E){var A=this.view,B=A.getSelectionModel(),D=A.pickerField,C=B.getCount();E.stopEvent();this.selectHighlighted(E);if(!D.multiSelect&&C===B.getCount()&&D.collapse){D.collapse()}return false},onKeySpace:function(){if(this.navigateOnSpace){this.callParent(arguments)}return true},onKeyEsc:function(){if(this.view.pickerField){this.view.pickerField.collapse()}},focusItem:function(C){var B=this,A=B.view;if(typeof C==="number"){C=A.all.item(C)}if(C){C=C.dom;A.highlightItem(C);A.getScrollable().scrollIntoView(C,false)}},selectHighlighted:function(F){var E=this,B=E.view,A=B.getSelectionModel(),C,D=E.recordIndex;if(B.all.getCount()){C=E.getRecord();if(C){if(F.getKey()===F.ENTER||!A.isSelected(C)){A.selectWithEvent(C,F);if(!B.store.data.contains(C)){E.setPosition(Math.min(D,B.store.getCount()-1))}}}}},destroy:function(){this.fieldKeyNav=Ext.destroy(this.fieldKeyNav);this.callParent()}})