Ext.define("Ext.view.DragZone",{extend:"Ext.dd.DragZone",containerScroll:false,constructor:function(B){var E=this,A,D,C;Ext.apply(E,B);if(!E.ddGroup){E.ddGroup="view-dd-zone-"+E.view.id}A=E.view;D=A.ownerCt;if(D){C=D.getTargetEl().dom}else{C=A.el.dom.parentNode}E.callParent([C]);E.ddel=document.createElement("div");E.ddel.className=Ext.baseCSSPrefix+"grid-dd-wrap"},init:function(E,A,C){var D=this,B={itemmousedown:D.onItemMouseDown,scope:D};if(Ext.supports.touchScroll){B["itemlongpress"]=D.onItemMouseDown}D.initTarget(E,A,C);D.view.mon(D.view,B)},onValidDrop:function(B,A,C){this.callParent([B,A,C]);B.el.focus()},onItemMouseDown:function(B,A,E,C,F){var D;if((F.pointerType==="touch"&&F.type!=="longpress")||(F.position&&F.position.isEqual(F.view.actionPosition))){return }if(!this.isPreventDrag(F,A,E,C)){D=B.getNavigationModel();if(F.position){D.setPosition(F.position)}else{D.setPosition(C)}this.handleMouseDown(F)}},isPreventDrag:function(D,A,C,B){return false},getDragData:function(C){var A=this.view,B=C.getTarget(A.getItemSelector());if(B){return{copy:A.copy||(A.allowCopy&&C.ctrlKey),event:C,view:A,ddel:this.ddel,item:B,records:A.getSelectionModel().getSelection(),fromPosition:Ext.fly(B).getXY()}}},onInitDrag:function(B,G){var E=this,F=E.dragData,D=F.view,A=D.getSelectionModel(),C=D.getRecord(F.item);if(!A.isSelected(C)){A.selectWithEvent(C,E.DDMInstance.mousedownEvent)}F.records=A.getSelection();Ext.fly(E.ddel).setHtml(E.getDragText());E.proxy.update(E.ddel);E.onStartDrag(B,G);return true},getDragText:function(){var A=this.dragData.records.length;return Ext.String.format(this.dragText,A,A===1?"":"s")},getRepairXY:function(B,A){return A?A.fromPosition:false}})