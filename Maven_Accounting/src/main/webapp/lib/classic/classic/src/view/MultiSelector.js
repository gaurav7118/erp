Ext.define("Ext.view.MultiSelector",{extend:"Ext.grid.Panel",xtype:"multiselector",config:{search:{xtype:"multiselector-search",width:200,height:200,store:{autoLoad:true}}},fieldName:"name",fieldTitle:null,removeRowText:"\u2716",removeRowTip:"Remove this item",emptyText:"Nothing selected",addToolText:"Search for items to add",initComponent:function(){var F=this,A=F.emptyText,C=F.getStore(),E=F.getSearch(),G=F.fieldTitle,B,D;if(!E){Ext.raise("The search configuration is required for the multi selector")}B=E.store;if(B.isStore){D=B.getModel()}else{D=B.model}if(!C){F.store={model:D}}if(A&&!F.viewConfig){F.viewConfig={deferEmptyText:false,emptyText:A}}if(!F.columns){F.hideHeaders=!G;F.columns=[{text:G,dataIndex:F.fieldName,flex:1},F.makeRemoveRowColumn()]}F.callParent()},addTools:function(){this.addTool({type:"plus",tooltip:this.addToolText,callback:"onShowSearch",scope:this})},convertSearchRecord:Ext.identityFn,convertSelectionRecord:Ext.identityFn,makeRemoveRowColumn:function(){var A=this;return{width:22,menuDisabled:true,tdCls:Ext.baseCSSPrefix+"multiselector-remove",processEvent:A.processRowEvent.bind(A),renderer:A.renderRemoveRow,updater:Ext.emptyFn,scope:A}},processRowEvent:function(F,C,A,D,E,G,B,H){if(G.type!=="click"){return }if(Ext.fly(A).hasCls(Ext.baseCSSPrefix+"multiselector-remove")){this.store.remove(B);if(this.searchPopup){this.searchPopup.deselectRecords(B)}}},renderRemoveRow:function(){return'<span data-qtip="'+this.removeRowTip+'" role="button">'+this.removeRowText+"</span>"},beforeDestroy:function(){Ext.un({mousedown:"onDismissSearch",scope:this});this.callParent()},privates:{onDismissSearch:function(B){var A=this.searchPopup;if(A&&!(A.owns(B.getTarget())||this.owns(B.getTarget()))){Ext.un({mousedown:"onDismissSearch",scope:this});A.hide()}},onShowSearch:function(B,D){var E=this,A=E.searchPopup,C=E.getStore();if(!A){A=Ext.merge({owner:E,field:E.fieldName,floating:true},E.getSearch());E.searchPopup=A=E.add(A);if(C.getCount()){A.selectRecords(C.getRange())}}A.showBy(E,"tl-tr?");Ext.on({mousedown:"onDismissSearch",scope:E})}}})