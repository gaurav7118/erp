Ext.define("Ext.window.MessageBox",{extend:"Ext.window.Window",requires:["Ext.toolbar.Toolbar","Ext.form.field.Text","Ext.form.field.TextArea","Ext.button.Button","Ext.layout.container.Anchor","Ext.layout.container.HBox","Ext.ProgressBar"],alias:"widget.messagebox",OK:1,YES:2,NO:4,CANCEL:8,OKCANCEL:9,YESNO:6,YESNOCANCEL:14,INFO:Ext.baseCSSPrefix+"message-box-info",WARNING:Ext.baseCSSPrefix+"message-box-warning",QUESTION:Ext.baseCSSPrefix+"message-box-question",ERROR:Ext.baseCSSPrefix+"message-box-error",hideMode:"offsets",closeAction:"hide",resizable:false,scrollable:true,title:"&#160;",defaultMinWidth:250,defaultMaxWidth:600,defaultMinHeight:110,defaultMaxHeight:500,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,constrain:true,cls:[Ext.baseCSSPrefix+"message-box",Ext.baseCSSPrefix+"hidden-offsets"],layout:{type:"vbox",align:"stretch"},shrinkWrapDock:true,defaultTextHeight:75,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel"},buttonIds:["ok","yes","no","cancel"],titleText:{confirm:"Confirm",prompt:"Prompt",wait:"Loading...",alert:"Attention"},baseIconCls:Ext.baseCSSPrefix+"message-box-icon",ariaRole:"alertdialog",makeButton:function(A){var B=this.buttonIds[A];return new Ext.button.Button({handler:this.btnCallback,itemId:B,scope:this,text:this.buttonText[B],minWidth:75})},btnCallback:function(A,C){var B=this,D,E;if(C&&C.type==="keydown"&&!C.isSpecialKey()){C.getTarget(null,null,true).on({keyup:function(F){B.btnCallback(A,F)},single:true});return }if(B.cfg.prompt||B.cfg.multiline){if(B.cfg.multiline){E=B.textArea}else{E=B.textField}D=E.getValue();E.reset()}B.hide();B.userCallback(A.itemId,D,B.cfg)},hide:function(){var B=this,A=B.cfg?B.cfg.cls:"";B.progressBar.reset();if(A){B.removeCls(A)}B.callParent(arguments)},constructor:function(A){var B=this;B.callParent(arguments);B.minWidth=B.defaultMinWidth=(B.minWidth||B.defaultMinWidth);B.maxWidth=B.defaultMaxWidth=(B.maxWidth||B.defaultMaxWidth);B.minHeight=B.defaultMinHeight=(B.minHeight||B.defaultMinHeight);B.maxHeight=B.defaultMaxHeight=(B.maxHeight||B.defaultMaxHeight)},initComponent:function(A){var E=this,B=E.id,D,C;E.title=E.title||"&#160;";E.iconCls=E.iconCls||"";E.topContainer=new Ext.container.Container({layout:"hbox",padding:10,style:{overflow:"hidden"},items:[E.iconComponent=new Ext.Component({cls:E.baseIconCls}),E.promptContainer=new Ext.container.Container({flex:1,layout:{type:"vbox",align:"stretch"},items:[E.msg=new Ext.Component({id:B+"-msg",cls:E.baseCls+"-text"}),E.textField=new Ext.form.field.Text({id:B+"-textfield",enableKeyEvents:true,listeners:{keydown:E.onPromptKey,scope:E}}),E.textArea=new Ext.form.field.TextArea({id:B+"-textarea",height:75})]})]});E.progressBar=new Ext.ProgressBar({id:B+"-progressbar",margin:"0 10 10 10"});E.items=[E.topContainer,E.progressBar];E.msgButtons=[];for(D=0;D<4;D++){C=E.makeButton(D);E.msgButtons[C.itemId]=C;E.msgButtons.push(C)}E.bottomTb=new Ext.toolbar.Toolbar({id:B+"-toolbar",ui:"footer",dock:"bottom",layout:{pack:"center"},items:[E.msgButtons[0],E.msgButtons[1],E.msgButtons[2],E.msgButtons[3]]});E.dockedItems=[E.bottomTb];E.on("close",E.onClose,E);E.callParent()},onClose:function(){var A=this.header.child("[type=close]");if(A){A.itemId="cancel";this.btnCallback(A);delete A.itemId}},onPromptKey:function(A,C){var B=this;if(C.keyCode===C.RETURN||C.keyCode===10){if(B.msgButtons.ok.isVisible()){B.msgButtons.ok.handler.call(B,B.msgButtons.ok)}else{if(B.msgButtons.yes.isVisible()){B.msgButtons.yes.handler.call(B,B.msgButtons.yes)}}}},reconfigure:function(C){var R=this,O=0,F=true,S=R.buttonText,E=R.resizer,M=R.header,Q=M&&!M.isHeader,D=C&&(C.message||C.msg),T,K,H,N,P,G,B,I,L,J,A;R.updateButtonText();R.cfg=C=C||{};J=C.wait;if(C.width){K=C.width}if(C.height){H=C.height}R.minWidth=C.minWidth||R.defaultMinWidth;R.maxWidth=C.maxWidth||R.defaultMaxWidth;R.minHeight=C.minHeight||R.defaultMinHeight;R.maxHeight=C.maxHeight||R.defaultMaxHeight;if(E){T=E.resizeTracker;E.minWidth=T.minWidth=R.minWidth;E.maxWidth=T.maxWidth=R.maxWidth;E.minHeight=T.minHeight=R.minHeight;E.maxHeight=T.maxHeight=R.maxHeight}delete R.defaultFocus;if(C.defaultFocus){R.defaultFocus=C.defaultFocus}R.animateTarget=C.animateTarget||undefined;R.modal=C.modal!==false;R.setTitle(C.title||(Q&&M.title)||R.title);R.setIconCls(C.iconCls||(Q&&M.iconCls)||R.iconCls);if(Ext.isObject(C.buttons)){R.buttonText=C.buttons;O=0}else{R.buttonText=C.buttonText||R.buttonText;O=Ext.isNumber(C.buttons)?C.buttons:0}O=O|R.updateButtonText();R.buttonText=S;Ext.suspendLayouts();R.width=R.height=null;if(K||H){if(K){R.setWidth(K)}if(H){R.setHeight(H)}}R.hidden=false;if(!R.rendered){R.render(Ext.getBody())}R.closable=C.closable!==false&&!J;M=R.header;if(M){A=M.child("[type=close]");if(A){A.setVisible(R.closable)}if(!C.title&&!R.closable&&!C.iconCls){M.hide()}else{M.show()}}R.liveDrag=!C.proxyDrag;R.userCallback=Ext.Function.bindCallback(C.callback||C.fn||Ext.emptyFn,C.scope||Ext.global);R.setIcon(C.icon);B=R.msg;if(D){B.setHtml(D);B.show()}else{B.hide()}P=R.textArea;G=R.textField;if(C.prompt||C.multiline){R.multiline=C.multiline;if(C.multiline){P.setValue(C.value);P.setHeight(C.defaultTextHeight||R.defaultTextHeight);P.show();G.hide();R.defaultFocus=P}else{G.setValue(C.value);P.hide();G.show();R.defaultFocus=G}}else{P.hide();G.hide()}I=R.progressBar;if(C.progress||J){I.show();R.updateProgress(0,C.progressText);if(J){I.wait(J===true?C.waitConfig:J)}}else{I.hide()}L=R.msgButtons;for(N=0;N<4;N++){if(O&Math.pow(2,N)){if(!R.defaultFocus){R.defaultFocus=L[N]}L[N].show();F=false}else{L[N].hide()}}if(F){R.bottomTb.hide()}else{R.bottomTb.show()}Ext.resumeLayouts(true)},updateButtonText:function(){var D=this,C=D.buttonText,B=0,E,A;for(E in C){if(C.hasOwnProperty(E)){A=D.msgButtons[E];if(A){if(D.cfg&&D.cfg.buttonText){B=B|Math.pow(2,Ext.Array.indexOf(D.buttonIds,E))}if(A.text!==C[E]){A.setText(C[E])}}}}return B},show:function(A){var C=this,B;A=A||{};if(Ext.Component.layoutSuspendCount){Ext.on({resumelayouts:function(){C.show(A)},single:true});return C}C.reconfigure(A);if(A.cls){C.addCls(A.cls)}B=C.query("textfield:not([hidden]),textarea:not([hidden]),button:not([hidden])");C.preventFocusOnActivate=!B.length;C.hidden=true;C.callParent();return C},onShow:function(){this.callParent(arguments);this.center()},updateText:function(A){this.msg.setHtml(A)},setIcon:function(D,C,A){var E=this,F=E.iconComponent,B=E.messageIconCls;if(B){F.removeCls(B)}if(D){F.show();if(C||A){F.setSize(C||F.getWidth(),A||F.getHeight())}F.addCls(Ext.baseCSSPrefix+"dlg-icon");F.addCls(E.messageIconCls=D)}else{F.removeCls(Ext.baseCSSPrefix+"dlg-icon");F.hide()}return E},updateProgress:function(C,A,B){this.progressBar.updateProgress(C,A);if(B){this.updateText(B)}return this},onEsc:function(){if(this.closable!==false){this.callParent(arguments)}},confirm:function(A,D,C,B){if(Ext.isString(A)){A={title:A,icon:this.QUESTION,message:D,buttons:this.YESNO,callback:C,scope:B}}return this.show(A)},prompt:function(F,D,C,B,A,E){if(Ext.isString(F)){F={prompt:true,title:F,minWidth:this.minPromptWidth,message:D,buttons:this.OKCANCEL,callback:C,scope:B,multiline:A,value:E}}return this.show(F)},wait:function(B,C,A){if(Ext.isString(B)){B={title:C,message:B,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:A}}return this.show(B)},alert:function(D,C,B,A){if(Ext.isString(D)){D={title:D,message:C,buttons:this.OK,fn:B,scope:A,minWidth:this.minWidth}}return this.show(D)},progress:function(C,B,A){if(Ext.isString(C)){C={title:C,message:B,progress:true,progressText:A}}return this.show(C)}},function(A){Ext.onInternalReady(function(){Ext.MessageBox=Ext.Msg=new A()})})