describe("Ext.tab.Bar",function(){var A;function C(E){A=new Ext.tab.Bar(Ext.apply({},E))}function B(E,F){A.onClick({getTarget:function(){return(F)?F.el:null}},{id:E})}function D(I,H){var F=[],E,G;H=H||"text";for(E=1;E<=I;++E){G={};G[H]="ItemText"+E;F.push(G)}return F}afterEach(function(){Ext.destroy(A);A=null});describe("layout",function(){var E;beforeEach(function(){C();E=A.layout});xit("should be hbox by default",function(){expect(E.type).toEqual("hbox")});xit("should have pack start by default",function(){expect(E.pack).toEqual("start")});it("should have a default height when there are no tabs",function(){var F=Ext.create({xtype:"tabpanel",renderTo:document.body,width:100,height:100});expect(F.getTabBar().getHeight()).toBe(27);F.destroy()})});describe("closing a tab",function(){var I,H,J,F,G,E;beforeEach(function(){I=jasmine.createSpy();H=jasmine.createSpy();J=Ext.create("Ext.tab.Panel",{renderTo:Ext.getBody(),width:200,height:100,items:[{id:"item1",title:"Tab 1",closable:true,listeners:{close:I,destroy:H}},{id:"item2",title:"Tab 2",closable:true}]});spyOn(J,"remove").andCallThrough();spyOn(J.getTabBar(),"remove").andCallThrough();F=Ext.getCmp("item1");G=F.tab.closeEl.dom;E=Ext.getCmp("item2")});afterEach(function(){J.destroy()});it("should fire 'close' event in the item",function(){jasmine.fireMouseEvent(G,"click");expect(I).toHaveBeenCalled()});it("should fire 'destroy' event in the item",function(){jasmine.fireMouseEvent(G,"click");expect(H).toHaveBeenCalled()});it("should remove card from tabPanel",function(){jasmine.fireMouseEvent(G,"click");expect(J.remove).toHaveBeenCalledWith(F)});it("should remove tab from tabBar",function(){var K=F.tab;jasmine.fireMouseEvent(G,"click");expect(J.getTabBar().remove).toHaveBeenCalledWith(K)});it("should activate next tab",function(){jasmine.fireMouseEvent(G,"click");expect(J.activeTab).toBe(E)})});xdescribe("clicking on a tab",function(){var E,F;describe("if the tab is enabled",function(){beforeEach(function(){F={setActiveItem:jasmine.createSpy()};C({cardLayout:F});A.add({xtype:"tab",id:"tab1",card:{some:"card"},tabBar:A});A.render(document.body);E=A.getComponent("tab1");spyOn(A,"setActiveTab").andCallThrough()});afterEach(function(){A.destroy()});it("should call setActiveTab",function(){B("tab1",E);expect(A.setActiveTab).toHaveBeenCalledWith(E)});it("should fire the 'change' event",function(){var G;A.on("change",G=jasmine.createSpy(),this);B("tab1",E);expect(G).toHaveBeenCalled()});xit("should set the cardLayout's card to the tab's card",function(){B("tab1");expect(F.setActiveItem).toHaveBeenCalledWith(E.card)});describe("the 'change' event",function(){var G;beforeEach(function(){A.on("change",function(){G=arguments},this);B("tab1")});it("should have a reference to the tabBar",function(){expect(G[0]).toEqual(A)});it("should have a reference to the tab",function(){expect(G[1]).toEqual(E)});it("should have a reference to the tab's card",function(){expect(G[2]).toEqual(E.card)})})});describe("if the tab disabled config is true",function(){var I,H,G;beforeEach(function(){I={setActiveItem:jasmine.createSpy()};C({cardLayout:I});A.add({xtype:"tab",id:"tab1",card:{some:"card"},tabBar:A},{xtype:"tab",id:"tab2",disabled:true,card:{other:"card"},tabBar:A});H=A.items.items[0];G=A.items.items[1]});afterEach(function(){A.destroy()});it("should set the tab instance to disabled",function(){expect(A.getComponent("tab2").disabled).toBe(true)});it("should not call setActiveItem on the layout",function(){B("tab2");expect(I.setActiveItem).not.toHaveBeenCalled()})})});describe("ensureTabVisible",function(){var F;function G(J){var I=A.layout.overflowHandler;expect(I.getItemVisibility(J).fullyVisible).toBe(true)}function H(J){var I=A.layout.overflowHandler;expect(I.getItemVisibility(J).fullyVisible).toBe(false)}function E(I){C(Ext.apply({renderTo:Ext.getBody(),width:300,items:D(10)},I));F=A.items}afterEach(function(){F=null});describe("arguments",function(){it("should default to the activeTab",function(){E();var I=F.last();A.setActiveTab(I);A.layout.overflowHandler.scrollBy(-1000,false);H(I);A.ensureTabVisible();G(I)});it("should accept a tab",function(){E();var I=F.getAt(8);H(I);A.ensureTabVisible(8);G(I)});describe("index",function(){it("should accept 0",function(){E();var I=F.first();A.layout.overflowHandler.scrollBy(5000,false);H(I);A.ensureTabVisible(0);G(I)});it("should accept a non-zero index",function(){E();var I=F.getAt(3);A.layout.overflowHandler.scrollBy(5000,false);H(I);A.ensureTabVisible(3);G(I)})});describe("tab panel items",function(){var I;beforeEach(function(){I=new Ext.tab.Panel({renderTo:Ext.getBody(),width:300,items:D(10,"title")});A=I.getTabBar()});afterEach(function(){I.destroy();I=null});it("should accept a tabpanel item",function(){var J=A.items.last();H(J);A.ensureTabVisible(I.items.last());G(J)});it("should ignore components not in the tab panel",function(){var K=new Ext.Component();var J=A.items.first();G(J);A.ensureTabVisible(K);G(J);K.destroy()})})});it("should not cause issue if there is no scroller",function(){E({width:3000});expect(function(){A.ensureTabVisible(F.last())}).not.toThrow()})});describe("scroll & active tab",function(){var F;function G(J){var I=A.layout.overflowHandler;expect(I.getItemVisibility(J).fullyVisible).toBe(true)}function H(J){var I=A.layout.overflowHandler;expect(I.getItemVisibility(J).fullyVisible).toBe(false)}function E(I){C(Ext.apply({renderTo:Ext.getBody(),width:300,items:D(10)},I));F=A.items}afterEach(function(){F=null});it("should have the the active tab scrolled to",function(){E();var I=F.last();A.setActiveTab(I);G(I);I=F.first();A.setActiveTab(I);G(I)});describe("active item change",function(){describe("with ensureActiveVisibleOnChange: false",function(){beforeEach(function(){E({ensureActiveVisibleOnChange:false})});it("should not move the item into full view when changing the text",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setText("Longer text that will cause a scroll");expect(J.getWidth()).toBeGreaterThan(I);H(J)});it("should move the item into full view when changing the icon",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setIcon(Ext.BLANK_IMAGE_URL);expect(J.getWidth()).toBeGreaterThan(I);H(J)});it("should move the item into full view when changing the iconCls",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setIconCls("someIconCls");expect(J.getWidth()).toBeGreaterThan(I);H(J)});it("should move the item into full view when changing the glyph",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setGlyph(100);expect(J.getWidth()).toBeGreaterThan(I);H(J)})});describe("with ensureActiveVisibleOnChange: true",function(){beforeEach(function(){E({ensureActiveVisibleOnChange:true})});it("should move the item into full view when changing the text",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setText("Longer text that will cause a scroll");expect(J.getWidth()).toBeGreaterThan(I);G(J)});it("should move the item into full view when changing the icon",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setIcon(Ext.BLANK_IMAGE_URL);expect(J.getWidth()).toBeGreaterThan(I);G(J)});it("should move the item into full view when changing the iconCls",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setIconCls("someIconCls");expect(J.getWidth()).toBeGreaterThan(I);G(J)});it("should move the item into full view when changing the glyph",function(){var J=F.last(),I=J.getWidth();A.setActiveTab(J);A.ensureTabVisible(0);J.setGlyph(100);expect(J.getWidth()).toBeGreaterThan(I);G(J)})})})});xdescribe("setting the active tab",function(){var E;beforeEach(function(){C();A.add({xtype:"tab",card:{some:"card"},tabBar:A});E=A.getComponent(0)});it("should set the activeTab property to that tab",function(){A.setActiveTab(E);expect(A.activeTab).toEqual(E)})});describe("moving tab items",function(){var E;beforeEach(function(){E=new Ext.tab.Panel({deferredRender:false,renderTo:Ext.getBody(),width:300,items:[{title:"Tab 1",html:"Tab 1",id:"tab1"},{title:"Tab 2",html:"Tab 2",id:"tab2"},{title:"Tab 3",html:"Tab 3",id:"tab3"}]});A=E.getTabBar()});afterEach(function(){E.destroy();E=null});it("should move the underlying cards to keep the orders synchronized",function(){expect(A.getComponent(0).text).toBe("Tab 1");expect(A.getComponent(1).text).toBe("Tab 2");expect(A.getComponent(2).text).toBe("Tab 3");A.move(0,2);expect(A.getComponent(0).text).toBe("Tab 2");expect(A.getComponent(1).text).toBe("Tab 3");expect(A.getComponent(2).text).toBe("Tab 1");E.move(0,2);expect(A.getComponent(0).text).toBe("Tab 2");expect(A.getComponent(1).text).toBe("Tab 3");expect(A.getComponent(2).text).toBe("Tab 1")})})})