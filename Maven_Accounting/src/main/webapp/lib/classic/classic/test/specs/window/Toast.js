describe("Ext.window.Toast",function(){var G=jasmine.fireMouseEvent,K=jasmine.waitForFocus,A=jasmine.focusAndWait,H=jasmine.expectFocused,J,E,M,F,D,C,B,L;function I(N){M=Ext.toast(Ext.apply({html:"A toast to focus",slideInDuration:100,hideDuration:100,autoClose:false,listeners:{show:B,destroy:L}},N));return M}beforeEach(function(){B=jasmine.createSpy("show");L=jasmine.createSpy("destroy")});afterEach(function(){Ext.destroy(J,E,M);J=F=D=null});describe("creation",function(){describe("autoClose is true",function(){describe("closable is not defined",function(){beforeEach(function(){I({autoClose:true})});it("should force closable to false",function(){expect(M.closable).toBe(false)});it("should not render close tool",function(){var N=M.down("[type=close]");expect(N).toBeFalsy()})});describe("closable is true",function(){beforeEach(function(){I({closable:true,autoClose:true})});it("should not force closable to false",function(){expect(M.closable).toBe(true)});it("should render close tool",function(){var N=M.down("[type=close]");expect(N).toBeTruthy()})})})});describe("closeOnMouseDown",function(){beforeEach(function(){I({align:"tl",html:"foo",animate:false,closeOnMouseDown:true})});it("should dismiss toast",function(){G(Ext.getBody(),"click",0,0);waitForSpy(L,"destroy spy",100);runs(function(){expect(L).toHaveBeenCalled()})})});describe("canceling animation",function(){beforeEach(function(){I({align:"tl",animate:false})});describe("showing",function(){it("should show",function(){expect(M.el.isVisible()).toBe(true)});it("should be visibly positioned",function(){var N=M.getPosition();expect(N).toEqual([M.xPos,M.yPos])});it("should appear synchronously",function(){expect(B).toHaveBeenCalled()})});describe("hiding",function(){beforeEach(function(){M.close()});it("should hide",function(){expect(M.el).toBe(null)});it("should disappear synchronously",function(){expect(L).toHaveBeenCalled()});it("should be destroyed",function(){expect(M.destroyed).toBe(true)})})});describe("focus handling",function(){beforeEach(function(){J=new Ext.window.Window({width:300,x:10,y:10,items:[{xtype:"textfield",id:"field1"},{xtype:"textfield",id:"field2"}]});F=J.down("#field1");D=J.down("#field2");J.show();A(F)});it("should not steal focus from a floater",function(){runs(function(){I()});waitsForSpy(B,"show toast",1000);H(F,true);runs(function(){D.focus()});K(D);runs(function(){M.close()});waitsForSpy(L,"close toast",1000);H(D,true)});it("should not steal focus from 2nd level floater",function(){E=new Ext.window.Window({width:300,x:50,y:50,defaultFocus:"field3",items:[{xtype:"textfield",id:"field3"}]}).show();C=E.down("#field3");K(C);runs(function(){I()});waitForSpy(B,"show toast",1000);H(C,true);runs(function(){M.close()});waitForSpy(L,"close toast",1000);H(C,true)})})})