Ext.define("Ext.chart.series.sprite.Bar",{alias:"sprite.barSeries",extend:"Ext.chart.series.sprite.StackedCartesian",inheritableStatics:{def:{processors:{minBarWidth:"number",maxBarWidth:"number",minGapWidth:"number",radius:"number",inGroupGapWidth:"number"},defaults:{minBarWidth:2,maxBarWidth:100,minGapWidth:5,inGroupGapWidth:3,radius:0}}},drawLabel:function(K,I,S,H,O){var Q=this,N=Q.attr,F=Q.getMarker("labels"),D=F.getTemplate(),L=Q.labelCfg||(Q.labelCfg={}),C=Q.surfaceMatrix,J=N.labelOverflowPadding,B=D.attr.display,M=D.attr.orientation,G,E,A,R,T,P;L.x=C.x(I,H);L.y=C.y(I,H);if(!N.flipXY){L.rotationRads=-Math.PI*0.5}else{L.rotationRads=0}L.calloutVertical=!N.flipXY;switch(M){case"horizontal":L.rotationRads=0;L.calloutVertical=false;break;case"vertical":L.rotationRads=-Math.PI*0.5;L.calloutVertical=true;break}L.text=K;if(D.attr.renderer){P=[K,F,L,{store:Q.getStore()},O];R=Ext.callback(D.attr.renderer,null,P,0,Q.getSeries());if(typeof R==="string"){L.text=R}else{if(typeof R==="object"){if("text" in R){L.text=R.text}T=true}}}A=Q.getMarkerBBox("labels",O,true);if(!A){Q.putMarker("labels",L,O);A=Q.getMarkerBBox("labels",O,true)}E=(A.width/2+J);if(S>H){E=-E}if((M==="horizontal"&&N.flipXY)||(M==="vertical"&&!N.flipXY)||!M){G=(B==="insideStart")?S+E:H-E}else{G=(B==="insideStart")?S+J*2:H-J*2}L.x=C.x(I,G);L.y=C.y(I,G);G=(B==="insideStart")?S-E:H+E;L.calloutPlaceX=C.x(I,G);L.calloutPlaceY=C.y(I,G);G=(B==="insideStart")?S:H;L.calloutStartX=C.x(I,G);L.calloutStartY=C.y(I,G);if(S>H){E=-E}if(Math.abs(H-S)<=E*2||B==="outside"){L.callout=1}else{L.callout=0}if(T){Ext.apply(L,R)}Q.putMarker("labels",L,O)},drawBar:function(L,B,D,C,H,K,A,E){var G=this,J={},F=G.attr.renderer,I;J.x=C;J.y=H;J.width=K-C;J.height=A-H;J.radius=G.attr.radius;if(F){I=Ext.callback(F,null,[G,J,{store:G.getStore()},E],0,G.getSeries());Ext.apply(J,I)}G.putMarker("items",J,E,!F)},renderClipped:function(f,T,e,b){if(this.cleanRedraw){return }var P=this,N=P.attr,V=N.dataX,U=N.dataY,g=N.labels,M=N.dataStartY,L=N.groupCount,d=N.groupOffset-(L-1)*0.5,Y=N.inGroupGapWidth,S=T.lineWidth,c=N.matrix,a=c.elements[0],I=c.elements[3],E=c.elements[4],D=f.roundPixel(c.elements[5])-1,j=(a<0?-1:1)*a-N.minGapWidth,J=(Math.min(j,N.maxBarWidth)-Y*(L-1))/L,Z=f.roundPixel(Math.max(N.minBarWidth,J)),C=P.surfaceMatrix,G,h,B,H,k,A,K=0.5*N.lineWidth,l=Math.min(e[0],e[2]),W=Math.max(e[0],e[2]),X=Math.max(0,Math.floor(l)),O=Math.min(V.length-1,Math.ceil(W)),F=g&&P.getMarker("labels"),R,Q;for(k=X;k<=O;k++){R=M?M[k]:0;Q=U[k];A=V[k]*a+E+d*(Z+Y);G=f.roundPixel(A-Z/2)+K;H=f.roundPixel(Q*I+D+S);h=f.roundPixel(A+Z/2)-K;B=f.roundPixel(R*I+D+S);P.drawBar(T,f,e,G,H-K,h,B-K,k);if(F&&g[k]!=null){P.drawLabel(g[k],A,B,H,k)}P.putMarker("markers",{translationX:C.x(A,H),translationY:C.y(A,H)},k,true)}},getIndexNearPoint:function(K,J){var L=this,G=L.attr,H=G.dataX,A=L.getSurface(),B=A.getRect()||[0,0,0,0],I=B[3],E,D,C,M,F=-1;if(G.flipXY){E=I-J;if(A.getInherited().rtl){D=B[2]-K}else{D=K}}else{E=K;D=I-J}for(C=0;C<H.length;C++){M=L.getMarkerBBox("items",C);if(Ext.draw.Draw.isPointInBBox(E,D,M)){F=C;break}}return F}})