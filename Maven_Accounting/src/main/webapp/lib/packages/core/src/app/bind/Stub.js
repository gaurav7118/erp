Ext.define("Ext.app.bind.Stub",{extend:"Ext.app.bind.AbstractStub",requires:["Ext.app.bind.Binding"],isStub:true,dirty:true,formula:null,validationKey:"validation",statics:{trackHadValue:function(E,A,G,F){var C=F&&F.children,H,B,D;D=E!==undefined;if(!A.hadValue[G]){A.hadValue[G]=D}if(F){F.hadValue=D}if(E&&(E.constructor===Object||E.isModel)){if(E.isModel){E=E.data}for(B in E){Ext.app.bind.Stub.trackHadValue(E[B],A,G+"."+B,C&&C[B])}}}},constructor:function(A,B,C){var D=this,E=B;D.callParent([A,B]);D.boundValue=null;if(C){C.add(D);if(!C.isRootStub){E=C.path+"."+B}}D.hadValue=A.hadValue[E];D.path=E},destroy:function(){var C=this,D=C.formula,A=C.parent,B=C.storeBinding;if(D){D.destroy()}if(B){B.destroy()}C.detachBound();C.parentValue=C.formula=C.storeBinding=null;C.callParent()},bindValidation:function(C,B){var A=this.parent;return A&&A.descend([this.validationKey,this.name]).bind(C,B)},bindValidationField:function(F,D){var C=this.parent,B=this.name,E=typeof F==="string",A;if(C){A=C.bind(function(G){var H=null;if(G&&G.isModel){H=G.getField(B)}if(E){D[F](H,null,this)}else{F.call(D,H,null,this)}})}return A||null},descend:function(F,C){var E=this,D=E.children||(E.children={}),G=C||0,B=F[G++],A;if(!(A=D[B])){A=new Ext.app.bind.Stub(E.owner,B,E)}if(G<F.length){A=A.descend(F,G)}return A},getChildValue:function(A){var D=this,C=D.name,B;if(!A&&!Ext.isString(A)){B=D.hadValue?null:undefined}else{B=D.inspectValue(A);if(!B){if(A.isEntity){B=A.data[C]}else{B=A[C]}}}return B},getDataObject:function(){var F=this,B=F.parent.getDataObject(),D=F.name,C=B?B[D]:null,E,A;if(!C&&B&&B.isEntity){E=B.associations;if(E&&D in E){C=B[E[D].getterName]()}}if(!C||!(C.$className||Ext.isObject(C))){B[D]=C={};F.hadValue=F.owner.hadValue[F.path]=true;F.invalidate(true,true)}return C},getRawValue:function(){return this.getChildValue(this.getParentValue())},graft:function(E){var F=this,D=F.parent,C=F.children,A=F.name,B;E.parent=D;E.children=C;if(D){D.children[A]=E}if(C){for(B in C){C[B].parent=E}}F.children=null;return F.callParent([E])},isLoading:function(){var D=this,C=D.parent,G=false,B,F,E,A;if(C&&!(G=C.isLoading())){F=D.getParentValue();E=D.inspectValue(F);if(E){G=E.isLoading()}else{if(F&&F.isModel){B=F.associations;if(!(B&&D.name in B)){G=false;A=true}}if(!A){G=!D.hadValue&&D.getRawValue()===undefined}}}return G},invalidate:function(B,A){var E=this,D=E.children,C;E.dirty=true;if(!A&&!E.isLoading()){if(!E.scheduled){E.schedule()}}if(B&&D){for(C in D){D[C].invalidate(B,A)}}},isReadOnly:function(){var A=this.formula;return !!(A&&!A.set)},set:function(H){var G=this,I=G.parent,A=G.name,E=G.formula,F,C,B,D;if(E&&!E.settingValue&&E.set){E.setValue(H);return }else{if(G.isLinkStub){D=G.getLinkFormulaStub();E=D?D.formula:null;if(E){if(D.isReadOnly()){Ext.raise("Cannot setValue on a readonly formula")}E.setValue(H);return }}}F=I.getDataObject();if(F.isEntity){C=F.associations;if(C&&(A in C)){B=C[A];F[B.setterName](H);G.invalidate(true)}else{F.set(A,H)}}else{if((H&&H.constructor===Object)||H!==F[A]){if(!G.setByLink(H)){if(H===undefined){delete F[A]}else{F[A]=H;Ext.app.bind.Stub.trackHadValue(H,G.owner,G.path,G)}G.inspectValue(F);G.invalidate(true)}}}},onStoreLoad:function(){this.invalidate(true)},afterLoad:function(A){this.invalidate(true)},afterCommit:function(A){this.afterEdit(A,null)},afterEdit:function(G,E){var C=this.children,H=E&&E.length,D=G.associations,I,F,B,A;if(C){if(H){for(F=0;F<H;++F){B=C[E[F]];if(B){B.invalidate()}}}else{for(I in C){if(!(D&&I in D)){C[I].invalidate()}}}}this.invalidate()},afterReject:function(A){this.afterEdit(A,null)},setByLink:function(D){var C=this,G=0,A,B,F,E;for(E=C;E;E=E.parent){if(E.isLinkStub){B=E;if(G){for(F=[],A=0,E=C;E!==B;E=E.parent){++A;F[G-A]=E.name}}break}++G}if(!B||!(E=B.getTargetStub())){return false}if(F){E=E.descend(F)}E.set(D);return true},setFormula:function(C){var A=this,B=A.formula;if(B){B.destroy()}A.formula=new Ext.app.bind.Formula(A,C)},react:function(){var C=this,B=this.boundValue,A=C.children,D;if(B){if(B.isValidation){B.refresh();D=B.generation;if(C.lastValidationGeneration===D){return }C.lastValidationGeneration=D}else{if(B.isModel){if(A&&A[C.validationKey]){B.isValid()}}else{if(B.isStore){if(B.isLoading()&&!B.loadCount){return }}}}}this.callParent()},privates:{collect:function(){var C=this,A=C.callParent(),B=C.storeBinding?1:0,D=C.formula?1:0;return A+B+D},getLinkFormulaStub:function(){var A=this;while(A.isLinkStub){A=A.binding.stub}return A.formula?A:null},getParentValue:function(){var A=this;if(A.dirty){A.parentValue=A.parent.getValue();A.dirty=false}return A.parentValue},setStore:function(A){this.storeBinding=A},inspectValue:function(G){var H=this,A=H.name,E=H.boundValue,B=null,C,I,D,F;if(G&&G.isEntity){C=G.associations;if(C&&(A in C)){B=G[C[A].getterName]();if(B&&B.isStore){B.$associatedStore=true}}else{if(A===H.validationKey){B=G.getValidation();H.lastValidationGeneration=null}}}else{if(G){I=G[A];if(I&&(I.isModel||I.isStore)){B=I}}}D=E!==B;if(D){if(E){H.detachBound()}if(B){if(B.isModel){B.join(H)}else{F=B.associatedEntity;if(F&&!F.phantom&&!B.complete&&!B.hasPendingLoad()){B.load()}B.on("load",H.onStoreLoad,H,{single:true})}}H.boundValue=B}return B},detachBound:function(){var A=this,B=A.boundValue;if(B){if(B.isModel){B.unjoin(A)}else{B.un("load",A.onStoreLoad,A)}}},sort:function(){var C=this,D=C.formula,A=C.scheduler,B=C.storeBinding;C.callParent();if(B){A.sortItem(B)}if(D){A.sortItem(D)}}}})