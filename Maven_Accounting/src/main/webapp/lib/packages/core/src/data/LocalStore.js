Ext.define("Ext.data.LocalStore",{extend:"Ext.Mixin",mixinConfig:{id:"localstore"},config:{extraKeys:null},applyExtraKeys:function(A){var C,B=this.getData();B.setExtraKeys(A);A=B.getExtraKeys();for(C in A){this[C]=A[C]}},add:function(A){return this.insert(this.getCount(),arguments.length===1?A:arguments)},constructDataCollection:function(){return new Ext.util.Collection({rootProperty:"data"})},createModel:function(A){var B=this.getSession(),C;if(!A.isModel){C=this.getModel();A=new C(A,B)}return A},createFiltersCollection:function(){return this.getData().getFilters()},createSortersCollection:function(){var A=this.getData().getSorters();A.setSorterConfigure(this.addFieldTransform,this);return A},onCollectionSort:function(){this.onSorterEndUpdate()},onCollectionFilter:function(){this.onFilterEndUpdate()},notifySorterChange:function(){this.getData().onSorterChange()},forceLocalSort:function(){this.getData().onSortChange()},contains:function(A){return this.indexOf(A)>-1},each:function(E,D){var F=this.data.items,A=F.length,B,C;for(C=0;C<A;++C){B=F[C];if(E.call(D||B,B,C,A)===false){break}}},collect:function(B,A,C){var D=this,E=D.getData();if(C===true&&E.filtered){E=E.getSource()}return E.collect(B,"data",A)},getById:function(B){var A=this.getData();if(A.filtered){A=A.getSource()}return A.get(B)||null},getByInternalId:function(A){var C=this.getData(),B;if(C.filtered){if(!C.$hasExtraKeys){B=this.makeInternalKeyCfg();C.setExtraKeys(B);C.$hasExtraKeys=true}C=C.getSource()}if(!C.$hasExtraKeys){C.setExtraKeys(B||this.makeInternalKeyCfg());C.$hasExtraKeys=true}return C.byInternalId.get(A)||null},getDataSource:function(){var A=this.getData();return A.getSource()||A},indexOf:function(A){return this.getData().indexOf(A)},indexOfId:function(A){return this.indexOf(this.getById(A))},insert:function(C,B){var E=this,A,D;if(B){if(!Ext.isIterable(B)){B=[B]}else{B=Ext.Array.clone(B)}A=B.length}if(!A){return[]}for(D=0;D<A;++D){B[D]=E.createModel(B[D])}E.getData().insert(C,B);return B},queryBy:function(B,A){var C=this.getData();return(C.getSource()||C).createFiltered(B,A)},query:function(E,D,F,A,B){var C=this.getData();return(C.getSource()||C).createFiltered(E,D,F,A,B)},first:function(A){return this.getData().first(A)||null},last:function(A){return this.getData().last(A)||null},sum:function(C,A){var B=this.getData();return(A&&this.isGrouped())?B.sumByGroup(C):B.sum(C)},count:function(A){var B=this.getData();return(A&&this.isGrouped())?B.countByGroup():B.count()},min:function(C,A){var B=this.getData();return(A&&this.isGrouped())?B.minByGroup(C):B.min(C)},max:function(C,A){var B=this.getData();return(A&&this.isGrouped())?B.maxByGroup(C):B.max(C)},average:function(C,A){var B=this.getData();return(A&&this.isGrouped())?B.averageByGroup(C):B.average(C)},aggregate:function(G,J,E,H){var F=this,A,D,B,I,C;if(E&&F.isGrouped()){A=F.getGroups().items;D=A.length;B={};for(C=0;C<D;++C){I=A[C];B[I.getGroupKey()]=F.getAggregate(G,J||F,I.items,H)}return B}else{return F.getAggregate(G,J,F.getData().items,H)}},getAggregate:function(F,E,C,G){var B=[],A=C.length,D;for(D=0;D<A;++D){B[D]=C[D].get(G)}return F.call(E||this,C,B)},addObserver:function(A){var B=this.observers;if(!B){this.observers=B=new Ext.util.Collection()}B.add(A)},removeObserver:function(A){var B=this.observers;if(B){B.remove(A)}},callObservers:function(G,D){var H=this.observers,A,C,E,B,F;if(H){C=H.items;if(D){D.unshift(this)}else{D=[this]}for(E=0,A=C.length;E<A;++E){F=C[E];B="onSource"+G;if(F[B]){F[B].apply(F,D)}}}},queryRecordsBy:function(E,D){var G=this.getData(),F=[],A,C,B;G=(G.getSource()||G).items;D=D||this;for(C=0,A=G.length;C<A;++C){B=G[C];if(E.call(D,B)===true){F.push(B)}}return F},queryRecords:function(G,F){var E=this.getData(),D=[],A,C,B;E=(E.getSource()||E).items;for(C=0,A=E.length;C<A;++C){B=E[C];if(B.get(G)===F){D.push(B)}}return D},privates:{isLast:function(A){return A===this.last()},makeInternalKeyCfg:function(){return{byInternalId:{property:"internalId",rootProperty:""}}}}})