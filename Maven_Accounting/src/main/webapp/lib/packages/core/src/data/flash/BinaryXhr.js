Ext.define("Ext.data.flash.BinaryXhr",{statics:{flashPluginActivated:function(){Ext.data.flash.BinaryXhr.flashPluginActive=true;Ext.data.flash.BinaryXhr.flashPlugin=document.getElementById("ext-flash-polyfill");Ext.GlobalEvents.fireEvent("flashready")},flashPluginActive:false,flashPluginInjected:false,connectionIndex:1,liveConnections:{},flashPlugin:null,onFlashStateChange:function(D,C,B){var A;A=this.liveConnections[Number(D)];if(A){A.onFlashStateChange(C,B)}else{Ext.warn.log("onFlashStateChange for unknown connection ID: "+D)}},registerConnection:function(B){var A=this.connectionIndex;this.conectionIndex=this.connectionIndex+1;this.liveConnections[A]=B;return A},injectFlashPlugin:function(){var B=this,A,C;B.flashPolyfillEl=Ext.getBody().appendChild({id:"ext-flash-polyfill",cn:[{tag:"p",html:"To view this page ensure that Adobe Flash Player version 11.1.0 or greater is installed."},{tag:"a",href:"http://www.adobe.com/go/getflashplayer",cn:[{tag:"img",src:window.location.protocol+"//www.adobe.com/images/shared/download_buttons/get_flash_player.gif",alt:"Get Adobe Flash player"}]}]});A=[Ext.Loader.getPath("Ext.data.Connection"),"../../../plugins/flash/swfobject.js"].join("/");C="/plugins/flash/FlashPlugin.swf";C=[Ext.Loader.getPath("Ext.data.Connection"),"../../plugins/flash/FlashPlugin.swf"].join("/");if(Ext.flashPluginPath){C=Ext.flashPluginPath}Ext.Loader.loadScript({url:A,onLoad:function(){var E="11.4.0";var G="playerProductInstall.swf";var D={};var H={};H.quality="high";H.bgcolor="#ffffff";H.allowscriptaccess="sameDomain";H.allowfullscreen="true";var F={};F.id="ext-flash-polyfill";F.name="polyfill";F.align="middle";swfobject.embedSWF(C,"ext-flash-polyfill","0","0",E,G,D,H,F)},onError:function(){Ext.raise("Could not load flash-loader file swfobject.js from "+flashLoader)},scope:B});Ext.data.flash.BinaryXhr.flashPluginInjected=true}},readyState:0,status:0,statusText:"",responseBytes:null,javascriptId:null,constructor:function(A){if(!Ext.data.flash.BinaryXhr.flashPluginInjected){Ext.data.flash.BinaryXhr.injectFlashPlugin()}var B=this;Ext.apply(B,A);B.requestHeaders={}},abort:function(){var A=this;if(A.readyState==4){Ext.warn.log("Aborting a connection that's completed its transfer: "+this.url);return }A.aborted=true;if(!Ext.data.flash.BinaryXhr.flashPluginActive){Ext.GlobalEvents.removeListener("flashready",A.onFlashReady,A);return }Ext.data.flash.BinaryXhr.flashPlugin.abortRequest(A.javascriptId);delete Ext.data.flash.BinaryXhr.liveConnections[A.javascriptId]},getAllResponseHeaders:function(){var A=[];Ext.Object.each(this.responseHeaders,function(B,C){A.push(B+": "+C)});return A.join("\x0d\x0a")},getResponseHeader:function(B){var A=this.responseHeaders;return(A&&A[B])||null},open:function(F,C,D,A,B){var E=this;E.method=F;E.url=C;E.async=D!==false;E.user=A;E.password=B;if(!E.async){Ext.raise("Binary posts are only supported in async mode: "+C)}if(E.method!="POST"){Ext.log.warn("Binary data can only be sent as a POST request: "+C)}},overrideMimeType:function(A){this.mimeType=A},send:function(A){var B=this;B.body=A;if(!Ext.data.flash.BinaryXhr.flashPluginActive){Ext.GlobalEvents.addListener("flashready",B.onFlashReady,B)}else{this.onFlashReady()}},onFlashReady:function(){var C=this,B,A;C.javascriptId=Ext.data.flash.BinaryXhr.registerConnection(C);B={method:C.method,url:C.url,user:C.user,password:C.password,mimeType:C.mimeType,requestHeaders:C.requestHeaders,body:C.body,javascriptId:C.javascriptId};A=Ext.data.flash.BinaryXhr.flashPlugin.postBinary(B)},setReadyState:function(B){var A=this;if(A.readyState!=B){A.readyState=B;A.onreadystatechange()}},setRequestHeader:function(B,A){this.requestHeaders[B]=A},onreadystatechange:Ext.emptyFn,parseData:function(B){var A=this;this.status=B.status||0;A.responseHeaders={};if(A.mimeType){A.responseHeaders["content-type"]=A.mimeType}if(B.reason=="complete"){this.responseBytes=B.data;A.responseHeaders["content-length"]=B.data.length}else{if(B.reason=="error"||B.reason=="securityError"){this.statusText=B.text;A.responseHeaders["content-length"]=0}else{Ext.raise("Unkown reason code in data: "+B.reason)}}},onFlashStateChange:function(C,B){var A=this;if(C==4){A.parseData(B);delete Ext.data.flash.BinaryXhr.liveConnections[A.javascriptId]}A.setReadyState(C)}})