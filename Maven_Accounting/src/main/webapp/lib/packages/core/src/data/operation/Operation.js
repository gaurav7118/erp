Ext.define("Ext.data.operation.Operation",{alternateClassName:"Ext.data.Operation",isOperation:true,config:{synchronous:false,url:"",params:undefined,callback:undefined,scope:undefined,resultSet:null,response:null,request:null,records:null,id:undefined,proxy:null,batch:null,recordCreator:null,internalCallback:null,internalScope:null},order:0,foreignKeyDirection:1,started:false,running:false,complete:false,success:undefined,exception:false,error:undefined,idPrefix:"ext-operation-",constructor:function(A){var B=A&&A.scope;this.initConfig(A);if(A){A.scope=B}if(B){this.setScope(B);this.initialConfig.scope=B}this._internalId=Ext.id(this,this.idPrefix)},getAction:function(){return this.action},execute:function(){var B=this,A;delete B.error;delete B.success;B.complete=B.exception=false;B.setStarted();B.request=A=B.doExecute();if(A){A.setOperation(B)}return A},doExecute:Ext.emptyFn,abort:function(){var B=this,A=B.request;if(B.running&&A){B.getProxy().abort(A);B.request=null}},process:function(B,D,A,E){var C=this;E=E!==false;C.setResponse(A);C.setResultSet(B);if(B.getSuccess()){C.doProcess(B,D,A);C.setSuccessful(E)}else{if(E){C.setException(B.getMessage())}}},_commitSetOptions:{convert:true,commit:true},doProcess:function(L,F,E){var J=this,D=J._commitSetOptions,A=J.getRecords(),C=A.length,M=A[0].clientIdProperty,N=L.getRecords(),I=N?N.length:0,K,H,B,G;if(I&&M){K=Ext.Array.toValueMap(A,"id");for(G=0;G<I;++G){H=N[G];B=K[H[M]];if(B){delete K[B.id];delete H[M];B.set(H,D)}else{Ext.log.warn("Ignoring server record: "+Ext.encode(H))}}for(G in K){K[G].commit()}}else{for(G=0;G<C;++G){B=A[G];if(I===0||!(H=N[G])){B.commit()}else{B.set(H,D)}}}},setStarted:function(){this.started=this.running=true},setCompleted:function(){var B=this,A=B.getProxy();B.complete=true;B.running=false;B.triggerCallbacks();if(A){A.completeOperation(B)}},setSuccessful:function(A){this.success=true;if(A){this.setCompleted()}},setException:function(A){var B=this;B.exception=true;B.success=B.running=false;B.error=A;B.setCompleted()},triggerCallbacks:function(){var A=this,B=A.getInternalCallback();if(B){B.call(A.getInternalScope()||A,A);A.setInternalCallback(null);A.setInternalScope(null)}if(B=A.getCallback()){B.call(A.getScope()||A,A.getRecords(),A,A.wasSuccessful());A.setCallback(null);A.setScope(null)}},hasException:function(){return this.exception},getError:function(){return this.error},getRecords:function(){var A;return this._records||((A=this.getResultSet())?A.getRecords():null)},isStarted:function(){return this.started},isRunning:function(){return this.running},isComplete:function(){return this.complete},wasSuccessful:function(){return this.isComplete()&&this.success===true},allowWrite:function(){return true}})