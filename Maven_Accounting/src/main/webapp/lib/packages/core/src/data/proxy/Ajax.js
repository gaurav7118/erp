Ext.define("Ext.data.proxy.Ajax",{requires:["Ext.Ajax"],extend:"Ext.data.proxy.Server",alias:"proxy.ajax",alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],isAjaxProxy:true,defaultActionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},config:{binary:false,headers:undefined,paramsAsJson:false,withCredentials:false,useDefaultXhrHeader:true,username:null,password:null,actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"}},doRequest:function(A){var D=this,E=D.getWriter(),C=D.buildRequest(A),G=D.getMethod(C),B,F;if(E&&A.allowWrite()){C=E.write(C)}C.setConfig({binary:D.getBinary(),headers:D.getHeaders(),timeout:D.getTimeout(),scope:D,callback:D.createRequestCallback(C,A),method:G,useDefaultXhrHeader:D.getUseDefaultXhrHeader(),disableCaching:false});if(G.toUpperCase()!=="GET"&&D.getParamsAsJson()){F=C.getParams();if(F){B=C.getJsonData();if(B){B=Ext.Object.merge({},B,F)}else{B=F}C.setJsonData(B);C.setParams(undefined)}}if(D.getWithCredentials()){C.setWithCredentials(true);C.setUsername(D.getUsername());C.setPassword(D.getPassword())}return D.sendRequest(C)},sendRequest:function(A){A.setRawRequest(Ext.Ajax.request(A.getCurrentConfig()));this.lastRequest=A;return A},abort:function(A){A=A||this.lastRequest;if(A){Ext.Ajax.abort(A.getRawRequest())}},getMethod:function(A){var C=this.getActionMethods(),B=A.getAction(),D;if(C){D=C[B]}return D||this.defaultActionMethods[B]},createRequestCallback:function(C,A){var B=this;return function(E,F,D){if(C===B.lastRequest){B.lastRequest=null}B.processResponse(F,A,C,D)}},destroy:function(){this.lastRequest=null;this.callParent()}})