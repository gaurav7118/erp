Ext.define("Ext.data.writer.Writer",{mixins:["Ext.mixin.Factoryable"],alias:"writer.base",factoryConfig:{defaultType:null},alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],config:{clientIdProperty:null,allDataOptions:{persist:true},partialDataOptions:{changes:true,critical:true},writeAllFields:false,dateFormat:null,nameProperty:"name",writeRecordId:true,transform:null},isWriter:true,constructor:function(A){this.initConfig(A)},applyTransform:function(A){if(A){if(Ext.isFunction(A)){A={fn:A}}return A.fn.bind(A.scope||this)}return A},write:function(E){var C=E.getOperation(),B=C.getRecords()||[],A=B.length,F=[],D;for(D=0;D<A;D++){F.push(this.getRecordData(B[D],C))}return this.writeRecords(E,F)},writeRecords:Ext.emptyFn,getRecordData:function(I,G){var L=this,E=L.getNameProperty(),A=E!=="name",C=I.self.idField,P=C[E]||C.name,O=I.id,D=L.getWriteAllFields(),K,B,F,Q,N,J,H,M;if(C.serialize){O=C.serialize(O)}if(!D&&G&&G.isDestroyOperation){K={};K[P]=O}else{B=L.getDateFormat();F=I.phantom;Q=(F||D)?L.getAllDataOptions():L.getPartialDataOptions();N=F&&L.getClientIdProperty();J=I.getFieldsMap();Q.serialize=false;H=I.getData(Q);K=A?{}:H;if(N){K[N]=O;delete H[P]}else{if(!L.getWriteRecordId()){delete H[P]}}for(P in H){O=H[P];if(!(M=J[P])){if(A){K[P]=O}}else{if(M.isDateField&&B&&Ext.isDate(O)){O=Ext.Date.format(O,B)}else{if(M.serialize){O=M.serialize(O,I)}}if(A){P=M[E]||P}K[P]=O}}}return K}})