Ext.define("Ext.data.writer.Xml",{extend:"Ext.data.writer.Writer",alternateClassName:"Ext.data.XmlWriter",alias:"writer.xml",config:{documentRoot:"xmlData",defaultDocumentRoot:"xmlData",header:"",record:"record"},selectorRe:/[^>\s]+/g,writeRecords:function(B,C){var H=this,F=[],D=0,G=C.length,J=H.getDocumentRoot(),I=H.getRecord(),E=I.match(this.selectorRe),K=E.length,L=C.length!==1&&K===1,A;A=this.getTransform();if(A){C=A(C,B)}F.push(H.getHeader()||"");if(!J&&L){J=H.getDefaultDocumentRoot()}if(J){F.push("<",J,">")}for(D=0;D<K-1;D++){F.push("<",E[D],">")}I=E[D];for(D=0;D<G;++D){this.objectToElement(I,C[D],F)}for(D=K-2;D>-1;D--){F.push("</",E[D],">")}if(J){F.push("</",J,">")}B.setXmlData(F.join(""));return B},objectToElement:function(B,E,F){var M,K,G=[],D,C,I,H,J,A,L;if(!F){F=[]}F.push("<",B);for(M in E){K=E[M];if(M[0]==="@"){F.push(" ",M.substr(1),'="',K,'"')}else{if(typeof K==="object"){this.objectToElement(M,K,G)}else{D=M.match(this.selectorRe);if((C=D.length)>1){J=J||{};for(H=J,I=0;I<C;I++){A=H;L=D[I];H=H[L]||(H[L]={})}A[L]=K}else{G.push("<",M,">",K,"</",M,">")}}}}F.push(">");F.push.apply(F,G);if(J){for(M in J){K=J[M];this.objectToElement(M,K,F)}}F.push("</",B,">");return F}})