Ext.define("Ext.event.gesture.Drag",{extend:"Ext.event.gesture.SingleTouch",priority:100,isStarted:false,startPoint:null,previousPoint:null,lastPoint:null,handledEvents:["dragstart","drag","dragend","dragcancel"],config:{minDistance:8},constructor:function(){this.callParent(arguments);this.initInfo()},initInfo:function(){this.info={touch:null,previous:{x:0,y:0},x:0,y:0,delta:{x:0,y:0},absDelta:{x:0,y:0},flick:{velocity:{x:0,y:0}},direction:{x:0,y:0},time:0,previousTime:{x:0,y:0}}},onTouchStart:function(A){if(this.callParent(arguments)===false){if(this.isStarted&&this.lastMoveEvent!==null){this.lastMoveEvent.isStopped=false;this.onTouchEnd(this.lastMoveEvent)}return false}this.startTime=A.time;this.startPoint=A.changedTouches[0].point},tryDragStart:function(D){var B=this.startPoint,F=D.changedTouches[0],A=F.point,E=this.getMinDistance(),C=this.info;if(Math.abs(A.getDistanceTo(B))>=E){this.isStarted=true;this.previousPoint=this.lastPoint=A;this.resetInfo("x",D,F);this.resetInfo("y",D,F);C.time=D.time;this.fire("dragstart",D,C)}},onTouchMove:function(B){if(!this.isStarted){this.tryDragStart(B)}if(!this.isStarted){return }var C=B.changedTouches[0],A=C.point;if(this.lastPoint){this.previousPoint=this.lastPoint}this.lastPoint=A;this.lastMoveEvent=B;this.updateInfo("x",B,C);this.updateInfo("y",B,C);this.info.time=B.time;this.fire("drag",B,this.info)},onAxisDragEnd:function(A,C){var B=C.time-C.previousTime[A];if(B>0){C.flick.velocity[A]=(C[A]-C.previous[A])/B}},resetInfo:function(C,F,H){var D=this.lastPoint[C],B=this.startPoint[C],G=D-B,A=C.toUpperCase(),E=this.info;E.touch=H;E.delta[C]=G;E.absDelta[C]=Math.abs(G);E.previousTime[C]=this.startTime;E.previous[C]=B;E[C]=D;E.direction[C]=0;E["start"+A]=this.startPoint[C];E["previous"+A]=E.previous[C];E["page"+A]=E[C];E["delta"+A]=E.delta[C];E["absDelta"+A]=E.absDelta[C];E["previousDelta"+A]=0;E.startTime=this.startTime},updateInfo:function(D,H,G){var I=this,K=I.lastPoint[D],E=I.previousPoint[D],A=I.startPoint[D],L=K-A,C=I.info,J=C.direction,F=D.toUpperCase(),B=C.previous[D];C.touch=G;C.delta[D]=L;C.absDelta[D]=Math.abs(L);if(K!==B&&K!==C[D]){C.previous[D]=C[D];C.previousTime[D]=C.time}C[D]=K;if(K>E){J[D]=1}else{if(K<E){J[D]=-1}}C["start"+F]=A;C["previous"+F]=C.previous[D];C["page"+F]=C[D];C["delta"+F]=C.delta[D];C["absDelta"+F]=C.absDelta[D];C["previousDelta"+F]=C.previous[D]-A;C.startTime=I.startTime},onTouchEnd:function(A){this.doEnd(A)},onTouchCancel:function(A){this.doEnd(A,true);return false},doEnd:function(D,B){if(!this.isStarted){this.tryDragStart(D)}if(this.isStarted){var E=D.changedTouches[0],A=E.point,C=this.info;this.isStarted=false;this.lastPoint=A;this.updateInfo("x",D,E);this.updateInfo("y",D,E);C.time=D.time;this.onAxisDragEnd("x",C);this.onAxisDragEnd("y",C);this.fire(B?"dragcancel":"dragend",D,C);this.startPoint=null;this.previousPoint=null;this.lastPoint=null;this.lastMoveEvent=null}},reset:function(){var A=this;A.isStarted=A.lastPoint=A.startPoint=A.previousPoint=A.lastPoint=A.lastMoveEvent=null;A.initInfo()}},function(A){var B=Ext.manifest.gestures;A.instance=new A(B&&B.drag)})