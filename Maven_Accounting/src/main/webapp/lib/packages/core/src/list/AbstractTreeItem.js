Ext.define("Ext.list.AbstractTreeItem",{extend:"Ext.Widget",isTreeListItem:true,cachedConfig:{expandable:false,expanded:false,floated:false,iconCls:"",leaf:true,loading:false,selected:false,selectedParent:false},config:{iconClsProperty:"iconCls",indent:null,owner:null,node:null,over:null,parentItem:null,text:{lazy:true,$value:""},textProperty:"text"},updateNode:function(D){if(D){var G=this,A=G.itemMap,H,B,F,E,I,C;G.element.dom.setAttribute("data-recordId",D.internalId);if(!A){H=D.childNodes;B=G.getOwner();G.itemMap=A={};for(E=0,F=H.length;E<F;++E){C=H[E];I=B.createItem(C,G);A[C.internalId]=I;G.insertItem(I,null)}}G.setExpanded(D.isExpanded());G.doNodeUpdate(D)}},updateSelected:function(B){if(!this.isConfiguring){var A=this.getParentItem();while(A&&!A.isRootListItem){A.setSelectedParent(B);A=A.getParentItem()}}},collapse:function(){this.getNode().collapse()},expand:function(){this.getNode().expand()},getToolElement:Ext.emptyFn,insertItem:Ext.emptyFn,isExpanded:function(){return this.getExpanded()},isSelectionEvent:Ext.emptyFn,isToggleEvent:Ext.emptyFn,nodeCollapse:function(C,E){var B=this,A=B.getOwner(),D=B.preventAnimation?null:A.getAnimation();B.nodeCollapseBegin(D,E);if(!D){B.nodeCollapseEnd(E)}},nodeCollapseBegin:function(C,D){var B=this,A=B.getOwner();B.setExpanded(false);A.fireEvent("itemcollapse",A,B)},nodeCollapseEnd:function(A){if(!A){this.getOwner().updateLayout()}},nodeExpand:function(C){var B=this,A=B.getOwner(),E=B.getFloated(),D=!E&&A.getAnimation();B.nodeExpandBegin(D);if(!D){B.nodeExpandEnd()}},nodeExpandBegin:function(C){var B=this,A=B.getOwner();B.setExpanded(true);A.fireEvent("itemexpand",A,B)},nodeExpandEnd:function(){this.getOwner().updateLayout()},nodeInsert:function(D,F){var G=this,C=G.getOwner(),A=G.itemMap,B=D.internalId,I=C.getItem(D),E=null,H;if(I){H=I.getParentItem();H.removeItem(I);if(H!==G){H.doUpdateExpandable();I.setParentItem(G)}}else{I=G.getOwner().createItem(D,G)}A[B]=I;if(F){E=A[F.internalId]}G.insertItem(I,E);G.doUpdateExpandable();C.fireEvent("iteminsert",C,G,I,E);C.updateLayout()},nodeRemove:function(D){var C=this,E=C.itemMap,A=C.getOwner(),F=D.internalId,B=E[F];if(B){delete E[F];C.removeItem(B);B.destroy();C.doUpdateExpandable();A.fireEvent("itemremove",A,C,B);A.updateLayout()}},nodeUpdate:function(B,A){this.doNodeUpdate(B)},removeItem:Ext.emptyFn,updateFloated:function(E){var D=this,B=D.element,F=D.placeholder,C,A;if(E){F=B.clone(false,true);F.id+="-placeholder";D.placeholder=Ext.get(F);D.wasExpanded=D.getExpanded();D.setExpanded(true);B.dom.parentNode.insertBefore(F,B.dom);D.floater=D.createFloater()}else{if(F){A=D.wasExpanded;C=D.getNode();D.setExpanded(A);if(!A&&C.isExpanded()){D.preventAnimation=true;C.collapse();D.preventAnimation=false}D.floater.remove(D,false);F.dom.parentNode.insertBefore(B.dom,F.dom);F.destroy();D.floater.destroy();D.placeholder=D.floater=null;D.floatedByHover=false}}},destroy:function(){var C=this,D=C.itemMap,A=C.getOwner(),B;if(D){for(B in D){D[B].destroy()}C.itemMap=null}if(A){A.removeItem(C.getNode())}C.setNode(null);C.setParentItem(null);C.setOwner(null);C.callParent()},privates:{doNodeUpdate:function(D){var C=this,B=this.getTextProperty(),A=this.getIconClsProperty();if(B){C.setText(D.data[B])}if(A){C.setIconCls(D.data[A])}C.setLoading(D.isLoading());C.setLeaf(D.isLeaf());C.doUpdateExpandable()},doUpdateExpandable:function(){var A=this.getNode();this.setExpandable(A.isExpandable())},onClick:function(E){var C=this,A=C.getOwner(),B=C.getNode(),D={event:E,item:C,node:B,tree:A,select:B.get("selectable")!==false&&C.isSelectionEvent(E),toggle:C.isToggleEvent(E)};if(A.fireEvent("itemclick",A,D)!==false){if(D.toggle){C.toggleExpanded()}if(D.select){A.setSelection(C.getNode())}}},toggleExpanded:function(){if(this.isExpanded()){this.collapse()}else{this.expand()}},updateIndent:function(B){var A=this.itemMap,C;for(C in A){A[C].setIndent(B)}}}})