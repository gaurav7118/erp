Ext.define("Ext.util.AbstractMixedCollection",{requires:["Ext.util.Filter"],mixins:{observable:"Ext.util.Observable"},isMixedCollection:true,generation:0,indexGeneration:0,constructor:function(B,A){var C=this;if(arguments.length===1&&Ext.isObject(B)){C.initialConfig=B;Ext.apply(C,B)}else{C.allowFunctions=B===true;if(A){C.getKey=A}C.initialConfig={allowFunctions:C.allowFunctions,getKey:C.getKey}}C.items=[];C.map={};C.keys=[];C.indexMap={};C.length=0;C.mixins.observable.constructor.call(C)},destroy:function(){var A=this;A.items=A.map=A.keys=A.indexMap=null;A.callParent()},allowFunctions:false,add:function(C,D){var A=this.length,B;if(arguments.length===1){B=this.insert(A,C)}else{B=this.insert(A,C,D)}return B},getKey:function(A){return A.id},replace:function(C,E){var D=this,A,B;if(arguments.length==1){E=arguments[0];C=D.getKey(E)}A=D.map[C];if(typeof C=="undefined"||C===null||typeof A=="undefined"){return D.add(C,E)}D.generation++;B=D.indexOfKey(C);D.items[B]=E;D.map[C]=E;if(D.hasListeners.replace){D.fireEvent("replace",C,A,E)}return E},reorder:function(D){var G=this,B=G.items,C=0,F=B.length,A=[],E=[],H;G.suspendEvents();for(H in D){A[D[H]]=B[H]}for(C=0;C<F;C++){if(D[C]==undefined){E.push(B[C])}}for(C=0;C<F;C++){if(A[C]==undefined){A[C]=E.shift()}}G.clear();G.addAll(A);G.resumeEvents()},updateKey:function(F,G){var D=this,E=D.map,A=D.indexOfKey(F),C=D.indexMap,B;if(A>-1){B=E[F];delete E[F];delete C[F];E[G]=B;C[G]=A;D.keys[A]=G;D.indexGeneration=++D.generation}},addAll:function(C){var B=this,A;if(arguments.length>1||Ext.isArray(C)){B.insert(B.length,arguments.length>1?arguments:C)}else{for(A in C){if(C.hasOwnProperty(A)){if(B.allowFunctions||typeof C[A]!="function"){B.add(A,C[A])}}}}},each:function(E,D){var B=Ext.Array.push([],this.items),C=0,A=B.length,F;for(;C<A;C++){F=B[C];if(E.call(D||F,F,C,A)===false){break}}},eachKey:function(E,D){var F=this.keys,B=this.items,C=0,A=F.length;for(;C<A;C++){E.call(D||window,F[C],B[C],C,A)}},findBy:function(E,D){var F=this.keys,B=this.items,C=0,A=B.length;for(;C<A;C++){if(E.call(D||window,B[C],F[C])){return B[C]}}return null},find:function(){if(Ext.isDefined(Ext.global.console)){Ext.global.console.warn("Ext.util.MixedCollection: find has been deprecated. Use findBy instead.")}return this.findBy.apply(this,arguments)},insert:function(B,C,D){var A;if(Ext.isIterable(C)){A=this.doInsert(B,C,D)}else{if(arguments.length>2){A=this.doInsert(B,[C],[D])}else{A=this.doInsert(B,[C])}A=A[0]}return A},doInsert:function(H,M,L){var J=this,B,C,F,I=M.length,A=I,E=J.hasListeners.add,D,G={},K,O,N;if(L!=null){J.useLinearSearch=true}else{L=M;M=new Array(I);for(F=0;F<I;F++){M[F]=this.getKey(L[F])}}J.suspendEvents();for(F=0;F<I;F++){B=M[F];C=J.indexOfKey(B);if(C!==-1){if(C<H){H--}J.removeAt(C)}if(B!=null){if(G[B]!=null){K=true;A--}G[B]=F}}J.resumeEvents();if(K){O=M;N=L;M=new Array(A);L=new Array(A);F=0;for(B in G){M[F]=O[G[B]];L[F]=N[G[B]];F++}I=A}D=H===J.length&&J.indexGeneration===J.generation;Ext.Array.insert(J.items,H,L);Ext.Array.insert(J.keys,H,M);J.length+=I;J.generation++;if(D){J.indexGeneration=J.generation}for(F=0;F<I;F++,H++){B=M[F];if(B!=null){J.map[B]=L[F];if(D){J.indexMap[B]=H}}if(E){J.fireEvent("add",H,L[F],B)}}return L},remove:function(D){var C=this,B,A;if(!C.useLinearSearch&&(B=C.getKey(D))){A=C.indexOfKey(B)}else{A=Ext.Array.indexOf(C.items,D)}return(A===-1)?false:C.removeAt(A)},removeAll:function(A){var C=this,B;if(A||C.hasListeners.remove){if(A){for(B=A.length-1;B>=0;--B){C.remove(A[B])}}else{while(C.length){C.removeAt(0)}}}else{C.length=C.items.length=C.keys.length=0;C.map={};C.indexMap={};C.generation++;C.indexGeneration=C.generation}},removeAt:function(A){var C=this,D,B;if(A<C.length&&A>=0){C.length--;D=C.items[A];Ext.Array.erase(C.items,A,1);B=C.keys[A];if(typeof B!="undefined"){delete C.map[B]}Ext.Array.erase(C.keys,A,1);if(C.hasListeners.remove){C.fireEvent("remove",D,B)}C.generation++;return D}return false},removeRange:function(G,A){var H=this,B,I,F,E,C,D;if(G<H.length&&G>=0){if(!A){A=1}E=Math.min(G+A,H.length);A=E-G;D=E===H.length;C=D&&H.indexGeneration===H.generation;for(F=G;F<E;F++){I=H.keys[F];if(I!=null){delete H.map[I];if(C){delete H.indexMap[I]}}}B=H.items[F-1];H.length-=A;H.generation++;if(C){H.indexGeneration=H.generation}if(D){H.items.length=H.keys.length=H.length}else{H.items.splice(G,A);H.keys.splice(G,A)}return B}return false},removeAtKey:function(B){var D=this,C=D.keys,A;if(B==null){for(A=C.length-1;A>=0;A--){if(C[A]==null){D.removeAt(A)}}}else{return D.removeAt(D.indexOfKey(B))}},getCount:function(){return this.length},indexOf:function(C){var B=this,A;if(C!=null){if(!B.useLinearSearch&&(A=B.getKey(C))){return this.indexOfKey(A)}return Ext.Array.indexOf(B.items,C)}return -1},indexOfKey:function(A){if(!this.map.hasOwnProperty(A)){return -1}if(this.indexGeneration!==this.generation){this.rebuildIndexMap()}return this.indexMap[A]},rebuildIndexMap:function(){var E=this,D=E.indexMap={},C=E.keys,A=C.length,B;for(B=0;B<A;B++){D[C[B]]=B}E.indexGeneration=E.generation},get:function(B){var D=this,A=D.map[B],C=A!==undefined?A:(typeof B=="number")?D.items[B]:undefined;return typeof C!="function"||D.allowFunctions?C:null},getAt:function(A){return this.items[A]},getByKey:function(A){return this.map[A]},contains:function(C){var B=this,A;if(C!=null){if(!B.useLinearSearch&&(A=B.getKey(C))){return this.map[A]!=null}return Ext.Array.indexOf(this.items,C)!==-1}return false},containsKey:function(A){return this.map.hasOwnProperty(A)},clear:function(){var A=this;if(A.generation){A.length=0;A.items=[];A.keys=[];A.map={};A.indexMap={};A.generation++;A.indexGeneration=A.generation}if(A.hasListeners.clear){A.fireEvent("clear")}},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},sum:function(G,B,H,A){var C=this.extractValues(G,B),F=C.length,E=0,D;H=H||0;A=(A||A===0)?A:F-1;for(D=H;D<=A;D++){E+=C[D]}return E},collect:function(I,E,G){var J=this.extractValues(I,E),A=J.length,B={},C=[],H,F,D;for(D=0;D<A;D++){H=J[D];F=String(H);if((G||!Ext.isEmpty(H))&&!B[F]){B[F]=true;C.push(H)}}return C},extractValues:function(C,A){var B=this.items;if(A){B=Ext.Array.pluck(B,A)}return Ext.Array.pluck(B,C)},hasRange:function(B,A){return(A<this.length)},getRange:function(H,B){var G=this,D=G.items,C=[],A=D.length,F,E;if(A<1){return C}if(H>B){E=true;F=H;H=B;B=F}if(H<0){H=0}if(B==null||B>=A){B=A-1}C=D.slice(H,B+1);if(E&&C.length){C.reverse()}return C},filter:function(D,C,E,A){var B=[];if(Ext.isString(D)){B.push(new Ext.util.Filter({property:D,value:C,anyMatch:E,caseSensitive:A}))}else{if(Ext.isArray(D)||D instanceof Ext.util.Filter){B=B.concat(D)}}return this.filterBy(Ext.util.Filter.createFilterFn(B))},filterBy:function(E,D){var H=this,A=new H.self(H.initialConfig),G=H.keys,B=H.items,F=B.length,C;A.getKey=H.getKey;for(C=0;C<F;C++){if(E.call(D||H,B[C],G[C])){A.add(G[C],B[C])}}A.useLinearSearch=H.useLinearSearch;return A},findIndex:function(C,B,E,D,A){if(Ext.isEmpty(B,false)){return -1}B=this.createValueMatcher(B,D,A);return this.findIndexBy(function(F){return F&&B.test(F[C])},null,E)},findIndexBy:function(E,D,H){var G=this,F=G.keys,B=G.items,C=H||0,A=B.length;for(;C<A;C++){if(E.call(D||G,B[C],F[C])){return C}}return -1},createValueMatcher:function(C,E,A,B){if(!C.exec){var D=Ext.String.escapeRegex;C=String(C);if(E===true){C=D(C)}else{C="^"+D(C);if(B===true){C+="$"}}C=new RegExp(C,A?"":"i")}return C},clone:function(){var A=this,B=new A.self(A.initialConfig);B.add(A.keys,A.items);B.useLinearSearch=A.useLinearSearch;return B}})