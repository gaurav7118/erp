Ext.define("Ext.util.Positionable",{mixinId:"positionable",_positionTopLeft:["position","top","left"],_alignRe:/^([a-z]+)-([a-z]+)([?!])?$/,afterSetPosition:Ext.emptyFn,getAnchorToXY:function(){Ext.raise("getAnchorToXY is not implemented in "+this.$className)},getBorderPadding:function(){Ext.raise("getBorderPadding is not implemented in "+this.$className)},getLocalX:function(){Ext.raise("getLocalX is not implemented in "+this.$className)},getLocalXY:function(){Ext.raise("getLocalXY is not implemented in "+this.$className)},getLocalY:function(){Ext.raise("getLocalY is not implemented in "+this.$className)},getX:function(){Ext.raise("getX is not implemented in "+this.$className)},getXY:function(){Ext.raise("getXY is not implemented in "+this.$className)},getY:function(){Ext.raise("getY is not implemented in "+this.$className)},setLocalX:function(){Ext.raise("setLocalX is not implemented in "+this.$className)},setLocalXY:function(){Ext.raise("setLocalXY is not implemented in "+this.$className)},setLocalY:function(){Ext.raise("setLocalY is not implemented in "+this.$className)},setX:function(){Ext.raise("setX is not implemented in "+this.$className)},setXY:function(){Ext.raise("setXY is not implemented in "+this.$className)},setY:function(){Ext.raise("setY is not implemented in "+this.$className)},adjustForConstraints:function(C,B){var A=this.getConstrainVector(B,C);if(A){C[0]+=A[0];C[1]+=A[1]}return C},alignTo:function(C,A,F,B){var E=this,D=E.el;return E.setXY(E.getAlignToXY(C,A,F),D.anim&&!!B?D.anim(B):false)},calculateAnchorXY:function(F,H,G,D){var I=this,C=I.el,J=document,E=(C.dom===J.body||C.dom===J),K=Math.round,L,B,A;F=(F||"tl").toLowerCase();D=D||{};B=D.width||(E?Ext.Element.getViewportWidth():I.getWidth());A=D.height||(E?Ext.Element.getViewportHeight():I.getHeight());switch(F){case"tl":L=[0,0];break;case"bl":L=[0,A];break;case"tr":L=[B,0];break;case"c":L=[K(B*0.5),K(A*0.5)];break;case"t":L=[K(B*0.5),0];break;case"l":L=[0,K(A*0.5)];break;case"r":L=[B,K(A*0.5)];break;case"b":L=[K(B*0.5),A];break;case"tc":L=[K(B*0.5),0];break;case"bc":L=[K(B*0.5),A];break;case"br":L=[B,A]}return[L[0]+H,L[1]+G]},convertPositionSpec:Ext.identityFn,getAlignToXY:function(I,V,E){var W=this,D,U,A,G,Q,F,R,S,O,P,T,N,M,B,C,H,K,L,J;I=Ext.get(I.el||I);if(!I||!I.dom){Ext.raise({sourceClass:"Ext.util.Positionable",sourceMethod:"getAlignToXY",msg:"Attempted to align an element that doesn't exist"})}E=E||[0,0];V=(!V||V==="?"?"tl-bl?":(!(/-/).test(V)&&V!==""?"tl-"+V:V||"tl-bl")).toLowerCase();V=W.convertPositionSpec(V);A=V.match(W._alignRe);if(!A){Ext.raise({sourceClass:"Ext.util.Positionable",sourceMethod:"getAlignToXY",el:I,position:V,offset:E,msg:'Attemmpted to align an element with an invalid position: "'+V+'"'})}N=A[1];M=A[2];T=!!A[3];G=W.getAnchorXY(N,true);Q=W.getAnchorToXY(I,M,false);L=Q[0]-G[0]+E[0];J=Q[1]-G[1]+E[1];if(T){if(A[3]==="!"){D=I}else{D=W.constrainTo||W.container||W.el.parent()}D=Ext.get(D.el||D);U=D.getConstrainRegion();U.right=U.left+D.el.dom.clientWidth;F=W.getWidth();R=W.getHeight();S=I.getRegion();B=N.charAt(0);C=N.charAt(N.length-1);H=M.charAt(0);K=M.charAt(M.length-1);O=(L<S.right&&L+F>=S.left)&&((B=="t"&&H=="b")||(B=="b"&&H=="t"));P=(J<S.bottom&&J+R>=S.top)&&((C=="r"&&K=="l")||(C=="l"&&K=="r"));if(L+F>U.right){if(P){L=S.left-F;P=false}else{L=U.right-F}}if(L<U.left){L=P?S.right:U.left}if(J+R>U.bottom){if(O){J=S.top-R;O=false}else{J=U.bottom-R}}if(J<U.top){J=O?S.bottom:U.top}}return[L,J]},getAnchorXY:function(D,H,B){var G=this,I=G.getXY(),A=G.el,K=document,C=A.dom==K.body||A.dom==K,J=A.getScroll(),F=C?J.left:H?0:I[0],E=C?J.top:H?0:I[1];return G.calculateAnchorXY(D,F,E,B)},getBox:function(D,G){var E=this,K=G?E.getLocalXY():E.getXY(),H=K[0],F=K[1],I=E.getWidth(),B=E.getHeight(),C,A,J;if(D){C=E.getBorderPadding();A=C.beforeX;J=C.beforeY;H+=A;F+=J;I-=(A+C.afterX);B-=(J+C.afterY)}return{x:H,left:H,0:H,y:F,top:F,1:F,width:I,height:B,right:H+I,bottom:F+B}},calculateConstrainedPosition:function(G,B,K,D){var J=this,C,H=J.floatParent,E=H?H.getTargetEl():null,A,F,I,M=false,L;if(K&&H){A=E.getXY();F=E.getBorderPadding();A[0]+=F.beforeX;A[1]+=F.beforeY;if(B){I=[B[0]+A[0],B[1]+A[1]]}}else{I=B}G=G||J.constrainTo||E||J.container||J.el.parent();if(K&&I){I=J.reverseTranslateXY(I)}C=((J.constrainHeader&&J.header.rendered)?J.header:J).getConstrainVector(G,I,D);if(C){M=B||J.getPosition(K);M[0]+=C[0];M[1]+=C[1]}return M},getConstrainRegion:function(){var G=this,C=G.el,A=C.dom.nodeName==="BODY",E=C.dom,F=C.getBorders(),H=C.getXY(),D=H[0]+F.beforeX,I=H[1]+F.beforeY,J,B,K;if(A){J=C.getScroll();D=J.left;I=J.top;B=Ext.Element.getViewportWidth();K=Ext.Element.getViewportHeight()}else{B=E.clientWidth;K=E.clientHeight}return new Ext.util.Region(I,D+B,I+K,D)},getConstrainVector:function(G,C,E){var A=this.getRegion(),D=[0,0],B=(this.shadow&&this.constrainShadow&&!this.shadowDisabled)?this.shadow.getShadowSize():undefined,I=false,H,F=this.constraintInsets;if(!(G instanceof Ext.util.Region)){G=Ext.get(G.el||G);H=G.getViewSize();G=G.getConstrainRegion();G.right=G.left+H.width;G.bottom=G.top+H.height}if(F){F=Ext.isObject(F)?F:Ext.Element.parseBox(F);G.adjust(F.top,F.right,F.bottom,F.left)}if(C){A.translateBy(C[0]-A.x,C[1]-A.y)}if(E){A.right=A.left+E[0];A.bottom=A.top+E[1]}if(B){G.adjust(B[0],-B[1],-B[2],B[3])}if(A.right>G.right){I=true;D[0]=(G.right-A.right)}if(A.left+D[0]<G.left){I=true;D[0]=(G.left-A.left)}if(A.bottom>G.bottom){I=true;D[1]=(G.bottom-A.bottom)}if(A.top+D[1]<G.top){I=true;D[1]=(G.top-A.top)}return I?D:false},getOffsetsTo:function(A){var C=this.getXY(),B=Ext.fly(A.el||A).getXY();return[C[0]-B[0],C[1]-B[1]]},getRegion:function(){var A=this.getBox();return new Ext.util.Region(A.top,A.right,A.bottom,A.left)},getClientRegion:function(){var B=this,A,C=B.getBox(),D=B.dom;A=D.offsetWidth-D.clientWidth;if(A){if(B.getStyle("direction")==="rtl"){C.left+=A}else{C.right-=A}}A=D.offsetHeight-D.clientHeight;if(A){C.bottom-=A}return new Ext.util.Region(C.top,C.right,C.bottom,C.left)},getViewRegion:function(){var F=this,C=F.el,A=C.dom.nodeName==="BODY",E,I,G,H,D,B,J;if(A){I=C.getScroll();D=I.left;H=I.top;B=Ext.Element.getViewportWidth();J=Ext.Element.getViewportHeight()}else{E=F.getBorderPadding();G=F.getXY();D=G[0]+E.beforeX;H=G[1]+E.beforeY;B=F.getWidth(true);J=F.getHeight(true)}return new Ext.util.Region(H,D+B,H+J,D)},move:function(I,B,C){var F=this,L=F.getXY(),J=L[0],H=L[1],D=[J-B,H],K=[J+B,H],G=[J,H-B],A=[J,H+B],E={l:D,left:D,r:K,right:K,t:G,top:G,up:G,b:A,bottom:A,down:A};I=I.toLowerCase();F.setXY([E[I][0],E[I][1]],C)},setBox:function(C){var B=this,A,D;if(C.isRegion){C={x:C.left,y:C.top,width:C.right-C.left,height:C.bottom-C.top}}B.constrainBox(C);A=C.x;D=C.y;B.setXY([A,D]);B.setSize(C.width,C.height);B.afterSetPosition(A,D);return B},constrainBox:function(D){var C=this,B,A,E;if(C.constrain||C.constrainHeader){A=("x" in D)?D.x:D.left;E=("y" in D)?D.y:D.top;B=C.calculateConstrainedPosition(null,[A,E],false,[D.width,D.height]);if(B){D.x=B[0];D.y=B[1]}}},translatePoints:function(A,C){var B=this.translateXY(A,C);return{left:B.x,top:B.y}},translateXY:function(G,E){var D=this,B=D.el,H=B.getStyle(D._positionTopLeft),A=H.position==="relative",C=parseFloat(H.left),F=parseFloat(H.top),I=D.getXY();if(Ext.isArray(G)){E=G[1];G=G[0]}if(isNaN(C)){C=A?0:B.dom.offsetLeft}if(isNaN(F)){F=A?0:B.dom.offsetTop}C=(typeof G==="number")?G-I[0]+C:undefined;F=(typeof E==="number")?E-I[1]+F:undefined;return{x:C,y:F}},reverseTranslateXY:function(J){var H=J,C=this.el,I=[],D=C.dom,B=D.offsetParent,A,E,G,F;if(B){A=C.isStyle("position","relative"),E=Ext.fly(B).getXY(),G=J[0]+E[0]+B.clientLeft;F=J[1]+E[1]+B.clientTop;if(A){G+=C.getPadding("l");F+=C.getPadding("t")}H=[G,F]}return H}})