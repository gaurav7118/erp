describe("Ext.ClassManager",function(){var C=Ext.ClassManager,A,B=function(){};beforeEach(function(){C.enableNamespaceParseCache=false;window.My={awesome:{Class:function(){console.log(11)},Class1:function(){console.log(12)},Class2:function(){console.log(13)}},cool:{AnotherClass:function(){console.log(21)},AnotherClass1:function(){console.log(22)},AnotherClass2:function(){console.log(23)}}}});afterEach(function(){try{delete window.Something;delete window.My;delete window.I;delete window.Test}catch(D){window.Something=undefined;window.My=undefined;window.I=undefined;window.Test=undefined}C.enableNamespaceParseCache=true});describe("exist",function(){it("should return whether a single class exists",function(){expect(C.isCreated("My.notexisting.Class")).toBe(false);expect(C.isCreated("My.awesome.Class")).toBe(true)})});describe("loader preprocessor",function(){beforeEach(function(){A=function(){}});it("should load and replace string class names with objects",function(){var E={extend:"My.awesome.Class",mixins:{name1:My.cool.AnotherClass,name2:"My.cool.AnotherClass1"}},D={extend:My.awesome.Class,mixins:{name1:My.cool.AnotherClass,name2:My.cool.AnotherClass1}},F;spyOn(Ext.Loader,"require").andCallFake(function(G,H){F=G;H()});Ext.Class.getPreprocessor("loader").fn(A,E,B,B);expect(Ext.Loader.require).toHaveBeenCalled();expect(F).toEqual(["My.awesome.Class","My.cool.AnotherClass1"]);expect(E).toEqual(D)})});describe("create",function(){var F,E,H,G,D;beforeEach(function(){H=C.create("I.am.the.MixinClass1",{config:{mixinConfig:"mixinConfig"},constructor:function(){this.mixinConstructor1Called=true},mixinProperty1:"mixinProperty1",mixinMethod1:function(){this.mixinMethodCalled=true}});G=C.create("I.am.the.MixinClass2",{constructor:function(){this.mixinConstructor2Called=true},mixinProperty2:"mixinProperty2",mixinMethod2:function(){this.mixinMethodCalled=true}});E=C.create("I.am.the.ParentClass",{alias:["parentclass","superclass"],mixins:{mixin1:"I.am.the.MixinClass1"},config:{name:"parentClass",isCool:false,members:{abe:"Abraham Elias",ed:"Ed Spencer"},hobbies:["football","bowling"]},onClassExtended:function(K,J){K.onClassExtendedCalled=true},constructor:function(J){this.initConfig(J);this.parentConstructorCalled=true;this.mixins.mixin1.constructor.apply(this,arguments)},parentProperty:"parentProperty",parentMethod:function(){this.parentMethodCalled=true}});F=C.create("I.am.the.SubClass",{alias:"subclass",extend:"I.am.the.ParentClass",mixins:{mixin1:"I.am.the.MixinClass1",mixin2:"I.am.the.MixinClass2"},config:{name:"subClass",isCool:true,members:{jacky:"Jacky Nguyen",tommy:"Tommy Maintz"},hobbies:["sleeping","eating","movies"],isSpecial:true},constructor:function(){this.subConstrutorCalled=true;this.superclass.constructor.apply(this,arguments);this.mixins.mixin2.constructor.apply(this,arguments)},myOwnMethod:function(){this.myOwnMethodCalled=true}})});afterEach(function(){Ext.undefine("I.am.the.MixinClass1");Ext.undefine("I.am.the.MixinClass2");Ext.undefine("I.am.the.ParentClass");Ext.undefine("I.am.the.SubClass")});it("should create the namespace",function(){expect(I).toBeDefined();expect(I.am).toBeDefined();expect(I.am.the).toBeDefined();expect(I.am.the.SubClass).toBeDefined()});it("should get className",function(){expect(Ext.getClassName(F)).toEqual("I.am.the.SubClass")});describe("addStatics",function(){it("single with name - value arguments",function(){var J=false;F.addStatics({staticMethod:function(){J=true}});expect(F.staticMethod).toBeDefined();F.staticMethod();expect(J).toBeTruthy()});it("multiple with object map argument",function(){F.addStatics({staticProperty:"something",staticMethod:function(){}});expect(F.staticProperty).toEqual("something");expect(F.staticMethod).toBeDefined()})});describe("mixin",function(){it("should have all properties of mixins",function(){var J=new F();expect(J.mixinProperty1).toEqual("mixinProperty1");expect(J.mixinProperty2).toEqual("mixinProperty2");expect(J.mixinMethod1).toBeDefined();expect(J.mixinMethod2).toBeDefined();expect(J.config.mixinConfig).toEqual("mixinConfig")})});describe("config",function(){it("should merge properly",function(){var J=new F();expect(J.config).toEqual({mixinConfig:"mixinConfig",name:"subClass",isCool:true,members:{abe:"Abraham Elias",ed:"Ed Spencer",jacky:"Jacky Nguyen",tommy:"Tommy Maintz"},hobbies:["sleeping","eating","movies"],isSpecial:true})});it("should apply default config",function(){var J=new F();expect(J.getName()).toEqual("subClass");expect(J.getIsCool()).toEqual(true);expect(J.getHobbies()).toEqual(["sleeping","eating","movies"])});it("should apply with supplied config",function(){var J=new F({name:"newName",isCool:false,members:{aaron:"Aaron Conran"}});expect(J.getName()).toEqual("newName");expect(J.getIsCool()).toEqual(false);expect(J.getMembers().aaron).toEqual("Aaron Conran")})});describe("overriden methods",function(){it("should call self constructor",function(){var J=new F();expect(J.subConstrutorCalled).toBeTruthy()});it("should call parent constructor",function(){var J=new F();expect(J.parentConstructorCalled).toBeTruthy()});it("should call mixins constructors",function(){var J=new F();expect(J.mixinConstructor1Called).toBeTruthy();expect(J.mixinConstructor2Called).toBeTruthy()})});describe("alias",function(){it("should store alias",function(){expect(C.getByAlias("subclass")).toBe(F)});it("should store multiple aliases",function(){expect(C.getByAlias("parentclass")).toBe(E);expect(C.getByAlias("superclass")).toBe(E)})})});describe("define",function(){it("should allow anonymous classes",function(){var D=Ext.define(null,function(F){return{constructor:function(){this.foo=1;this.T=F}}});var E=new D();expect(E.foo).toBe(1);expect(D).toBe(E.self);expect(E.T).toBe(D);expect(E.$className).toBeNull()})});describe("instantiate",function(){beforeEach(function(){C.create("Test.stuff.Person",{alias:"person",constructor:function(E,D,F){this.name=E;this.age=D;this.sex=F},eat:function(D){this.eatenFood=D}});C.create("Test.stuff.Developer",{alias:"developer",extend:"Test.stuff.Person",constructor:function(G,E,D,F){this.isGeek=G;return this.superclass.constructor.apply(this,arguments)},code:function(D){this.languageCoded=D;this.eat("bugs")}})});afterEach(function(){Ext.undefine("Test.stuff.Person");Ext.undefine("Test.stuff.Developer")});it("should create the instance by full class name",function(){var D=Ext.create("Test.stuff.Person","Jacky",24,"male");expect(D instanceof Test.stuff.Person).toBe(true)});it("should create the instance by alias",function(){var D=C.instantiateByAlias("person","Jacky",24,"male");expect(D instanceof Test.stuff.Person).toBe(true)});it("should pass all arguments to the constructor",function(){var D=C.instantiateByAlias("person","Jacky",24,"male");expect(D.name).toBe("Jacky");expect(D.age).toBe(24);expect(D.sex).toBe("male")});it("should have all methods in prototype",function(){var D=C.instantiateByAlias("person","Jacky",24,"male");D.eat("rice");expect(D.eatenFood).toBe("rice")});it("should works with inheritance",function(){var D=C.instantiateByAlias("developer",true,"Jacky",24,"male");D.code("javascript");expect(D.languageCoded).toBe("javascript");expect(D.eatenFood).toBe("bugs")})});describe("post-processors",function(){afterEach(function(){Ext.undefine("Something.Cool")});xdescribe("uses",function(){});describe("singleton",function(){it("should create the instance namespace and return the class",function(){var D=Ext.define("Something.Cool",{singleton:true,someMethod:function(){this.someMethodCalled=true},someProperty:"something"});expect(Something.Cool).toBeDefined();expect(Something.Cool instanceof D).toBeTruthy()})});describe("alias xtype",function(){it("should set xtype as a static class property",function(){var D=Ext.define("Something.Cool",{alias:"widget.cool"});expect(Something.Cool.xtype).toEqual("cool")})});describe("alternate",function(){it("should create the alternate with a string for alternateClassName property",function(){Ext.define("Something.Cool",{alternateClassName:"Something.CoolAsWell",someMethod:function(){this.someMethodCalled=true},someProperty:"something"});expect(Something.CoolAsWell).toBeDefined();expect(Something.CoolAsWell).toBe(Something.Cool)});it("should create the alternate with an array for alternateClassName property",function(){Ext.define("Something.Cool",{alternateClassName:["Something.CoolAsWell","Something.AlsoCool"]});expect(Something.CoolAsWell).toBe(Something.Cool);expect(Something.AlsoCool).toBe(Something.Cool)})})});describe("Ext.namespace",function(){var E=window;function D(F){if(Ext.isIE8){E[F]=undefined}else{delete E[F]}}it("should create a single top level namespace",function(){Ext.namespace("FooTest1");expect(E.FooTest1).toBeDefined();D("FooTest1")});it("should create multiple top level namespace",function(){Ext.namespace("FooTest2","FooTest3","FooTest4");expect(E.FooTest2).toBeDefined();expect(E.FooTest3).toBeDefined();expect(E.FooTest4).toBeDefined();D("FooTest2");D("FooTest3");D("FooTest4")});it("should create a chain of namespaces, starting from a top level",function(){Ext.namespace("FooTest5","FooTest5.ns1","FooTest5.ns1.ns2","FooTest5.ns1.ns2.ns3");expect(E.FooTest5).toBeDefined();expect(E.FooTest5.ns1).toBeDefined();expect(E.FooTest5.ns1.ns2).toBeDefined();expect(E.FooTest5.ns1.ns2.ns3).toBeDefined();D("FooTest5")});it("should create lower level namespaces without first defining the top level",function(){Ext.namespace("FooTest6.ns1","FooTest7.ns2");expect(E.FooTest6).toBeDefined();expect(E.FooTest6.ns1).toBeDefined();expect(E.FooTest7).toBeDefined();expect(E.FooTest7.ns2).toBeDefined();D("FooTest6");D("FooTest7")});it("should create a lower level namespace without defining the middle level",function(){Ext.namespace("FooTest8","FooTest8.ns1.ns2");expect(E.FooTest8).toBeDefined();expect(E.FooTest8.ns1).toBeDefined();expect(E.FooTest8.ns1.ns2).toBeDefined();D("FooTest8")});it("should not overwritte existing namespace",function(){Ext.namespace("FooTest9");FooTest9.prop1="foo";Ext.namespace("FooTest9");expect(FooTest9.prop1).toEqual("foo");D("FooTest9")})})})