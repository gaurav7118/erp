xdescribe("Ext.core.DomHelper",function(){var A={dom:{cleanBody:function(){document.getElementsByTagName("body")[0].innerHTML=""},parentNodeName:{"*":"div",frame:"frameset",col:"colgroup",colgroup:"table",option:"select",optgroup:"select",tbody:"table",thead:"table",tfoot:"table",tr:"tbody",td:"tr"},voidNode:{area:true,br:true,col:true,frame:true,hr:true,img:true,input:true,link:true,meta:true,param:true,range:true,spacer:true,wbr:true}},String:{html:function(C,D){var E="<"+C+" class="+D+">";if(!A.dom.voidNode[C]){E+="</"+C+">"}return E}}};xdescribe("useDom = false",function(){beforeEach(function(){Ext.core.DomHelper.useDom=false})});xdescribe("useDom = true",function(){beforeEach(function(){Ext.core.DomHelper.useDom=false});afterEach(function(){Ext.core.DomHelper.useDom=true})});function B(){var E=Ext.core.DomHelper,D,C;beforeEach(function(){D=Ext.getBody().createChild({id:"DomHelperHelper",children:[{cls:"child",id:"firstChild"},{cls:"child"},{cls:"child"},{cls:"child"},{cls:"child"},{cls:"child2"},{cls:"child2"},{cls:"child"},{cls:"child"},{cls:"child"}]});C=Ext.select("#DomHelperHelper > div")});afterEach(A.dom.cleanBody);describe("markup",function(){it("should return the markup for a string",function(){var F='<div class="class">my div!</div>';expect(E.markup(F)).toEqual(F)});it("should return the markup for an object",function(){var F='<div class="class"><span style="padding:10px;">test</span><br/></div>',G={cls:"class",children:[{tag:"span",html:"test",style:{padding:"10px"}},{tag:"br"}]};expect(E.markup(G)).toEqual(F)})});describe("applyStyles",function(){it("should apply styles from a string",function(){E.applyStyles(D,"padding:10px;");expect(D.dom.style.padding).toMatch(/^(?:10px|10px 10px 10px 10px)$/)});it("should apply styles from an object",function(){E.applyStyles(D,{padding:"10px"});expect(D.dom.style.padding).toMatch(/^(?:10px|10px 10px 10px 10px)$/)});xit("should apply styles from an object using numbers",function(){E.applyStyles(D,{padding:10});expect(D.dom.style.padding).toMatch(/^(?:10px|10px 10px 10px 10px)$/)});it("should apply styles from a function",function(){E.applyStyles(D,function(){return{padding:"10px"}});expect(D.dom.style.padding).toMatch(/^(?:10px|10px 10px 10px 10px)$/)})});describe("generateStyles",function(){it("should un-camel case names",function(){expect(E.generateStyles({backgroundColor:"red"})).toEqual("background-color:red;")});it("should concat multiple values",function(){expect(E.generateStyles({backgroundColor:"red",color:"green","font-size":"12px"})).toEqual("background-color:red;color:green;font-size:12px;")});it("should use a passed buffer",function(){var F=[];E.generateStyles({color:"red"},F);expect(F.join("")).toEqual("color:red;")});it("should not html encode by default",function(){expect(E.generateStyles({fontFamily:'"Arial"'})).toEqual('font-family:"Arial";')});it("should encode html entity values",function(){expect(E.generateStyles({fontFamily:'"Arial"'},null,true)).toEqual("font-family:&quot;Arial&quot;;")})});describe("insertHtml",function(){var G,F='<div id="newChild"></div>';describe("basic",function(){beforeEach(function(){G=Ext.getDom(C.first());expect(Ext.get("newChild")).toBeNull()});afterEach(function(){var H=document.getElementById("newChild");expect(H).toBeDefined();G.innerHTML=""});it("should insert a new element beforeBegin",function(){E.insertHtml("beforeBegin",G,F)});it("should insert a new element afterBegin",function(){E.insertHtml("afterBegin",G,F)});it("should insert a new element beforeEnd",function(){E.insertHtml("beforeEnd",G,F)});it("should insert a new element afterEnd",function(){E.insertHtml("afterEnd",G,F)});describe("textNode",function(){var H=0,J,I;beforeEach(function(){I=document.createTextNode(J="howdy"+(H++));G.appendChild(I);expect(G.firstChild).toEqual(I);expect(G.firstChild.nodeValue).toEqual(J)});afterEach(function(){expect(G.childNodes.length).toEqual(2);G.removeChild(I);expect(G.childNodes.length).toEqual(1);I=null;G.innerHTML="";expect(G.childNodes.length).toEqual(0)});it("should insert a new element beforeBegin",function(){E.insertHtml("beforeBegin",I,F)});it("should insert a new element afterBegin",function(){E.insertHtml("afterBegin",I,F)});it("should insert a new element beforeEnd",function(){E.insertHtml("beforeEnd",I,F)});it("should insert a new element afterEnd",function(){E.insertHtml("afterEnd",I,F)})})});describe("details",function(){var N={afterEnd:true,beforeBegin:true},I={afterBegin:true,beforeEnd:true},L={afterEnd:true,beforeBegin:true,afterBegin:true,beforeEnd:true};for(var J in A.dom.voidNode){M(N,J,J)}M(L,"div","div");M(L,"a","p");M(L,"a","a");M(I,"tr","td");M(N,"tr","tr");M(I,"tbody","tr");M(I,"tfoot","tr");M(I,"thead","tr");M(N,"tbody","tbody");M(N,"tbody","thead");M(N,"tbody","tfoot");M(N,"tfoot","tbody");M(N,"tfoot","thead");M(N,"tfoot","tfoot");M(N,"thead","tbody");M(N,"thead","thead");M(N,"thead","tfoot");function M(O,P,Q){if(O.afterBegin){K("afterBegin",P,Q)}if(O.beforeEnd){K("beforeEnd",P,Q)}if(O.afterEnd){H("afterEnd",P,Q)}if(O.beforeBegin){H("beforeBegin",P,Q)}if(O.afterBegin||O.beforeEnd){it(["should overwrite the HTML","of a",P.toUpperCase(),"Element"].join(" "),function(){var R=A.String.html(Q,"overwrite");var S=document.createElement(P);expect(S.parentNode).toBeNull();expect(S.childNodes.length).toBe(0);expect(S.firstChild).toBeNull();E.overwrite(S,R);expect(S.childNodes.length).toBe(1);expect(S.firstChild).toBeDefined();expect(S.firstChild.className).toBe("overwrite")});if(Ext.core.Element.prototype.setHTML){it(["should set the HTML","of a",P.toUpperCase(),"Element"].join(" "),function(){var R=A.String.html(Q,"overwrite");var S=document.createElement(P);expect(S.parentNode).toBeNull();expect(S.childNodes.length).toBe(0);expect(S.firstChild).toBeNull();Ext.fly(S).setHTML(R);expect(S.childNodes.length).toBe(1);expect(S.firstChild).toBeDefined();expect(S.firstChild.className).toBe("overwrite")})}}}function K(O,P,Q){it(["should insertHtml",Q.toUpperCase(),O,"of a "+P.toUpperCase()+" Element","when it has no parentNode"].join(" "),function(){var R=A.String.html(Q,O);var S=document.createElement(P);expect(S.parentNode).toBeNull();expect(S.childNodes.length).toBe(0);expect(S.firstChild).toBeNull();E.insertHtml(O,S,R);expect(S.childNodes.length).toBe(1);expect(S.firstChild).toBeDefined();expect(S.firstChild.className).toBe(O)})}function H(O,P,Q){it(["should insertHtml",Q.toUpperCase(),O,"of a "+P.toUpperCase()+" Element"].join(" "),function(){var S=A.String.html(Q,O);var T=document.createElement(P);document.createElement(A.dom.parentNodeName[P]||A.dom.parentNodeName["*"]).appendChild(T);var R=T.parentNode;expect(R).toBeDefined();expect(T.childNodes.length).toBe(0);expect(T.firstChild).toBeNull();expect(R.childNodes.length).toBe(1);E.insertHtml(O,T,S);R.removeChild(T);expect(R.childNodes.length).toBe(1);expect(R.firstChild.tagName.toLowerCase()).toBe(Q);expect(R.firstChild.className).toBe(O)})}})});describe("overwrite",function(){it("should overwrite the el",function(){var F=Ext.getDom(C.first());expect(F.innerHTML).toEqual("");E.overwrite(F,{tag:"span",html:"hello"});expect(F.innerHTML.toLowerCase()).toEqual("<span>hello</span>")});describe("table innerHTML bug",function(){it("should set the html of a tr Element, even when it has no parentNode",function(){var F=document.createElement("tr");expect(F.parentNode).toEqual(null);expect(F.childNodes.length).toEqual(0);E.overwrite(F,"<td>cell1");expect(F.childNodes.length).toEqual(1);expect(F.lastChild.innerHTML).toEqual("cell1");E.overwrite(F,"<td>cell2");expect(F.childNodes.length).toEqual(1);expect(F.lastChild.innerHTML).toEqual("cell2")});it("should set the html of an Element",function(){var F='<a href="http://mootools.net/">Link</a>';var G=document.createElement("div");E.overwrite(G,F);expect(G.innerHTML.toLowerCase()).toEqual(F.toLowerCase())});it("should set the html of an Element with multiple arguments",function(){var F=["<p>Paragraph</p>",'<a href="http://mootools.net/">Link</a>'];var G=document.createElement("div");E.overwrite(G,F);expect(G.innerHTML.toLowerCase()).toEqual(F.join("").toLowerCase())});it("should set the html of a select Element",function(){var G='<option>option 1</option><option selected="selected">option 2</option>';var F=document.createElement("select");E.overwrite(F,G);expect(F.childNodes.length).toEqual(2);expect(F.options.length).toEqual(2);expect(F.selectedIndex).toEqual(1)});it("should set the html of a table Element",function(){var F='<tbody><tr><td>cell 1</td><td>cell 2</td></tr><tr><td class="cell">cell 1</td><td>cell 2</td></tr></tbody>';var G=document.createElement("table");E.overwrite(G,F);expect(G.childNodes.length).toEqual(1);expect(G.firstChild.firstChild.childNodes.length).toEqual(2);expect(G.firstChild.lastChild.firstChild.className).toEqual("cell")});it("should set the html of a tbody Element",function(){var G='<tr><td>cell 1</td><td>cell 2</td></tr><tr><td class="cell">cell 1</td><td>cell 2</td></tr>';var F=document.createElement("tbody");document.createElement("table").appendChild(F);E.overwrite(F,G);expect(F.childNodes.length).toEqual(2);expect(F.lastChild.firstChild.className).toEqual("cell")});it("should set the html of a thead Element",function(){var F='<tr><td>cell 1</td><td>cell 2</td></tr><tr><td class="cell">cell 1</td><td>cell 2</td></tr>';var G=document.createElement("thead");document.createElement("table").appendChild(G);E.overwrite(G,F);expect(G.childNodes.length).toEqual(2);expect(G.lastChild.firstChild.className).toEqual("cell")});it("should set the html of a tfoot Element",function(){var F='<tr><td>cell 1</td><td>cell 2</td></tr><tr><td class="cell">cell 1</td><td>cell 2</td></tr>';var G=document.createElement("tfoot");document.createElement("table").appendChild(G);E.overwrite(G,F);expect(G.childNodes.length).toEqual(2);expect(G.lastChild.firstChild.className).toEqual("cell")});it("should set the html of a tr Element",function(){var F='<td class="cell">cell 1</td><td>cell 2</td>';var G=document.createElement("tr");document.createElement("tbody").appendChild(G);document.createElement("table").appendChild(G.parentNode);E.overwrite(G,F);expect(G.childNodes.length).toEqual(2);expect(G.firstChild.className).toEqual("cell")});it("should set the html of a td Element",function(){var F='<span class="span">Some Span</span><a href="#">Some Link</a>';var G=document.createElement("td");document.createElement("tr").appendChild(G);document.createElement("tbody").appendChild(G.parentNode);document.createElement("table").appendChild(G.parentNode.parentNode);E.overwrite(G,F);expect(G.childNodes.length).toEqual(2);expect(G.firstChild.className).toEqual("span")})})})}})