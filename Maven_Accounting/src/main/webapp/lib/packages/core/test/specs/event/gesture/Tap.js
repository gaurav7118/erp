describe("Ext.event.gesture.Tap",function(){var C=Ext.testHelper,I=Ext.event.gesture.Tap.instance,F=I.getMoveDistance(),J,L,H,G,B;function A(M){C.touchStart(J,M)}function D(M){C.touchMove(J,M)}function E(M){C.touchEnd(J,M)}function K(M){C.touchCancel(J,M)}beforeEach(function(){J=Ext.getBody().createChild();L=jasmine.createSpy();H=jasmine.createSpy();L.andCallFake(function(M){G=M});H.andCallFake(function(M){G=M});J.on("tap",L);J.on("tapcancel",H)});afterEach(function(){J.destroy()});it("should fire tap when there is no movement",function(){waits(100);runs(function(){A({id:1,x:10,y:10});E({id:1,x:10,y:10})});waitsForAnimation();runs(function(){expect(L).toHaveBeenCalled();expect(G.type).toBe("tap");expect(G.getX()).toBe(10);expect(G.getY()).toBe(10)})});it("should fire tap if movement is within moveDistance",function(){waits(100);runs(function(){A({id:1,x:10,y:10});D({id:1,x:9+F,y:10});E({id:1,x:9+F,y:10})});waitsForAnimation();runs(function(){expect(L).toHaveBeenCalled();expect(G.type).toBe("tap");expect(G.getX()).toBe(9+F);expect(G.getY()).toBe(10)})});it("should not fire tap, and should fire tapcancel if movement is greater than or equal to moveDistance",function(){waits(100);runs(function(){A({id:1,x:10,y:10});D({id:1,x:10,y:10+F});E({id:1,x:10,y:10+F})});waitsForAnimation();runs(function(){expect(L).not.toHaveBeenCalled();expect(H).toHaveBeenCalled();expect(G.type).toBe("tapcancel")})});if(Ext.supports.Touch){it("should not fire tap if a second touch is initiated",function(){runs(function(){A({id:1,x:10,y:10});A({id:2,x:30,y:30});E({id:1,x:10,y:10})});waitsForAnimation();runs(function(){E({id:2,x:30,y:30})});waitsForAnimation();runs(function(){expect(L).not.toHaveBeenCalled()})});it("should not fire tap and should fire tapcancel if a cancel event is received",function(){runs(function(){A({id:1,x:10,y:10})});waitsForAnimation();runs(function(){K({id:1,x:10,y:10})});waitsForAnimation();runs(function(){expect(L).not.toHaveBeenCalled();expect(H).toHaveBeenCalled();expect(G.type).toBe("tapcancel")})})}it("should not fire tap and should fire tapcancel if movement exceeds moveDistance, but the pointer is moved back within the moveDistance before touchend",function(){runs(function(){A({id:1,x:10,y:10});D({id:1,x:10,y:11+F})});waitsForAnimation();runs(function(){D({id:1,x:10,y:10});E({id:1,x:10,y:10})});waitsForAnimation();runs(function(){expect(L).not.toHaveBeenCalled();expect(H).toHaveBeenCalled();expect(G.type).toBe("tapcancel")})})})