Ext.define("Ext.ux.PreviewPlugin",{extend:"Ext.plugin.Abstract",alias:"plugin.preview",requires:["Ext.grid.feature.RowBody"],hideBodyCls:"x-grid-row-body-hidden",bodyField:"",previewExpanded:true,setCmp:function(F){this.callParent(arguments);var D=this,C=D.cmp=F.isXType("gridview")?F.grid:F,A=D.bodyField,G=D.hideBodyCls,B=Ext.create("Ext.grid.feature.RowBody",{grid:C,getAdditionalData:function(L,I,J,M){var H=Ext.grid.feature.RowBody.prototype.getAdditionalData,K={rowBody:L[A],rowBodyCls:C.getView().previewExpanded?"":G};if(Ext.isFunction(H)){Ext.apply(K,H.apply(this,arguments))}return K}}),E=function(I,H){H.previewExpanded=D.previewExpanded;H.featuresMC.add(B);B.init(I)};if(C.view){E(C,C.view)}else{C.on({viewcreated:E,single:true})}},toggleExpanded:function(B){var C=this.getCmp(),A=C&&C.getView(),E=A.bufferedRenderer,D=A.scrollManager;if(C&&A&&B!==A.previewExpanded){this.previewExpanded=A.previewExpanded=!!B;A.refreshView();if(D){if(E){E.stretchView(A,E.getScrollHeight(true))}else{D.refresh(true)}}}}})