Ext.ns("Ext.ux");Ext.define("Ext.ux.TabScrollerMenu",{alias:"plugin.tabscrollermenu",requires:["Ext.menu.Menu"],pageSize:10,maxText:15,menuPrefixText:"Items",constructor:function(A){Ext.apply(this,A)},init:function(B){var A=this;A.tabPanel=B;B.on({render:function(){A.tabBar=B.tabBar;A.layout=A.tabBar.layout;A.layout.overflowHandler.handleOverflow=Ext.Function.bind(A.showButton,A);A.layout.overflowHandler.clearOverflow=Ext.Function.createSequence(A.layout.overflowHandler.clearOverflow,A.hideButton,A)},destroy:A.destroy,scope:A,single:true})},showButton:function(){var C=this,A=Ext.getClass(C.layout.overflowHandler).prototype.handleOverflow.apply(C.layout.overflowHandler,arguments),B=C.menuButton;if(C.tabPanel.items.getCount()>1){if(!B){B=C.menuButton=C.tabBar.body.createChild({cls:Ext.baseCSSPrefix+"tab-tabmenu-right"},C.tabBar.body.child("."+Ext.baseCSSPrefix+"box-scroller-right"));B.addClsOnOver(Ext.baseCSSPrefix+"tab-tabmenu-over");B.on("click",C.showTabsMenu,C)}B.setVisibilityMode(Ext.dom.Element.DISPLAY);B.show();A.reservedSpace+=B.getWidth()}else{C.hideButton()}return A},hideButton:function(){var A=this;if(A.menuButton){A.menuButton.hide()}},getPageSize:function(){return this.pageSize},setPageSize:function(A){this.pageSize=A},getMaxText:function(){return this.maxText},setMaxText:function(A){this.maxText=A},getMenuPrefixText:function(){return this.menuPrefixText},setMenuPrefixText:function(A){this.menuPrefixText=A},showTabsMenu:function(D){var A=this;if(A.tabsMenu){A.tabsMenu.removeAll()}else{A.tabsMenu=new Ext.menu.Menu()}A.generateTabMenuItems();var C=Ext.get(D.getTarget()),B=C.getXY();B[1]+=24;A.tabsMenu.showAt(B)},generateTabMenuItems:function(){var K=this,H=K.tabPanel,A=H.getActiveTab(),I=H.items.getRange(),L=K.getPageSize(),E=K.tabsMenu,P,D,N,F,J,B,M,O,C,G;E.suspendLayouts();I=Ext.Array.filter(I,function(Q){if(Q.id==A.id){return false}return Q.hidden?!!Q.hiddenByLayout:true});P=I.length;D=Math.floor(P/L);N=P%L;if(P>L){for(F=0;F<D;F++){J=(F+1)*L;B=[];for(M=0;M<L;M++){G=M+J-L;O=I[G];B.push(K.autoGenMenuItem(O))}E.add({text:K.getMenuPrefixText()+" "+(J-L+1)+" - "+J,menu:B})}if(N>0){C=D*L;B=[];for(F=C;F<P;F++){O=I[F];B.push(K.autoGenMenuItem(O))}K.tabsMenu.add({text:K.menuPrefixText+" "+(C+1)+" - "+(C+B.length),menu:B})}}else{for(F=0;F<P;++F){E.add(K.autoGenMenuItem(I[F]))}}E.resumeLayouts(true)},autoGenMenuItem:function(B){var A=this.getMaxText(),C=Ext.util.Format.ellipsis(B.title,A);return{text:C,handler:this.showTabFromMenu,scope:this,disabled:B.disabled,tabToShow:B,iconCls:B.iconCls}},showTabFromMenu:function(A){this.tabPanel.setActiveTab(A.tabToShow)},destroy:function(){Ext.destroy(this.tabsMenu,this.menuButton);this.callParent()}})