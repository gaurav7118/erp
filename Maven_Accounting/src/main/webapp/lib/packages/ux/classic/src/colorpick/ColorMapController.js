Ext.define("Ext.ux.colorpick.ColorMapController",{extend:"Ext.app.ViewController",alias:"controller.colorpickercolormapcontroller",requires:["Ext.ux.colorpick.ColorUtils"],onFirstBoxReady:function(){var D=this,C=D.getView(),B=C.down("#dragHandle"),A=B.dd;A.constrain=true;A.constrainTo=C.getEl();A.initialConstrainTo=A.constrainTo;A.on("drag",Ext.bind(D.onHandleDrag,D));D.mon(C.getEl(),{mousedown:D.onMouseDown,dragstart:D.onDragStart,scope:D})},onHandleDrag:function(C,F){var H=this,A=H.getView(),G=A.down("#dragHandle"),K=G.getX()-A.getX(),I=G.getY()-A.getY(),E=A.getEl(),J=E.getWidth(),L=E.getHeight(),B=K/J,D=I/L;if(B>0.99){B=1}if(D>0.99){D=1}A.fireEvent("handledrag",B,D)},onMouseDown:function(D){var C=this,B=C.getView(),A=B.down("#dragHandle");A.setY(D.getY());A.setX(D.getX());C.onHandleDrag();A.dd.onMouseDown(D,A.dd.el)},onDragStart:function(D){var C=this,B=C.getView(),A=B.down("#dragHandle");A.dd.onDragStart(D,A.dd.el)},onMapClick:function(G){var D=this,C=D.getView(),A=C.down("#dragHandle"),H=C.getXY(),B=G.getXY(),F,E;F=B[0]-H[0];E=B[1]-H[1];A.getEl().setStyle({left:F+"px",top:E+"px"});D.onHandleDrag()},onColorBindingChanged:function(A){var K=this,D=K.getViewModel(),F=D.get("selectedColor"),G,B=K.getView(),J=B.down("#dragHandle"),I=B.getEl(),M=I.getWidth(),N=I.getHeight(),C,H,E,L;G=Ext.ux.colorpick.ColorUtils.rgb2hsv(F.r,F.g,F.b);C=G.s;E=M*C;H=1-G.v;L=N*H;J.getEl().setStyle({left:E+"px",top:L+"px"})},onHueBindingChanged:function(B){var E=this,C=E.getViewModel(),A,D;A=Ext.ux.colorpick.ColorUtils.hsv2rgb(B,1,1);D=Ext.ux.colorpick.ColorUtils.rgb2hex(A.r,A.g,A.b);E.getView().getEl().applyStyles({"background-color":"#"+D})}})