Ext.define("Ext.ux.desktop.Video",{extend:"Ext.panel.Panel",alias:"widget.video",layout:"fit",autoplay:false,controls:true,bodyStyle:"background-color:#000;color:#fff",html:"",tpl:['<video id="{id}-video" autoPlay="{autoplay}" controls="{controls}" poster="{poster}" start="{start}" loopstart="{loopstart}" loopend="{loopend}" autobuffer="{autobuffer}" loop="{loop}" style="width:100%;height:100%">','<tpl for="src">','<source src="{src}" type="{type}"/>',"</tpl>","{html}","</video>"],initComponent:function(){var E=this,F,C,B,D;if(E.fallbackHTML){F=E.fallbackHTML}else{F="Your browser does not support HTML5 Video. ";if(Ext.isChrome){F+="Upgrade Chrome."}else{if(Ext.isGecko){F+="Upgrade to Firefox 3.5 or newer."}else{var A='<a href="http://www.google.com/chrome">Chrome</a>';F+='Please try <a href="http://www.mozilla.com">Firefox</a>';if(Ext.isIE){F+=", "+A+' or <a href="http://www.apple.com/safari/">Safari</a>.'}else{F+=" or "+A+"."}}}}E.fallbackHTML=F;B=E.data=Ext.copyTo({tag:"video",html:F},E,"id,poster,start,loopstart,loopend,playcount,autobuffer,loop");if(E.autoplay){B.autoplay=1}if(E.controls){B.controls=1}if(Ext.isArray(E.src)){B.src=E.src}else{B.src=[{src:E.src}]}E.callParent()},afterRender:function(){var A=this;A.callParent();A.video=A.body.getById(A.id+"-video");el=A.video.dom;A.supported=(el&&el.tagName.toLowerCase()=="video");if(A.supported){A.video.on("error",A.onVideoError,A)}},getFallback:function(){return'<h1 style="background-color:#ff4f4f;padding: 10px;">'+this.fallbackHTML+"</h1>"},onVideoError:function(){var A=this;A.video.remove();A.supported=false;A.body.createChild(A.getFallback())},onDestroy:function(){var C=this;var B=C.video;if(C.supported&&B){var A=B.dom;if(A&&A.pause){A.pause()}B.remove();C.video=null}C.callParent()}})