Ext.define("Ext.ux.ajax.XmlSimlet",{extend:"Ext.ux.ajax.DataSimlet",alias:"simlet.xml",xmlTpl:["<{root}>\n",'<tpl for="data">',"    <{parent.record}>\n",'<tpl for="parent.fields">',"        <{name}>{[parent[values.name]]}</{name}>\n","</tpl>","    </{parent.record}>\n","</tpl>","</{root}>"],doGet:function(L){var J=this,B=J.getData(L),H=J.getPage(L,B),I=L.xhr.options.operation.getProxy(),E=I&&I.getReader(),D=E&&E.getModel(),G=J.callParent(arguments),A={data:H,reader:E,fields:D&&D.fields,root:E&&E.getRootProperty(),record:E&&E.record},F,C,K;if(L.groupSpec){A.summaryData=J.getSummary(L,B,H)}if(J.xmlTpl){F=Ext.XTemplate.getTpl(J,"xmlTpl");C=F.apply(A)}else{C=B}if(typeof DOMParser!="undefined"){K=(new DOMParser()).parseFromString(C,"text/xml")}else{K=new ActiveXObject("Microsoft.XMLDOM");K.async=false;K.loadXML(C)}G.responseText=C;G.responseXML=K;return G},fixTree:function(){this.callParent(arguments);var A=[];this.buildTreeXml(this.data,A);this.data=A.join("")},buildTreeXml:function(C,B){var A=this.rootProperty,D=this.recordProperty;B.push("<",A,">");Ext.Array.forEach(C,function(F){B.push("<",D,">");for(var E in F){if(E=="children"){this.buildTreeXml(F.children,B)}else{B.push("<",E,">",F[E],"</",E,">")}}B.push("</",D,">")});B.push("</",A,">")}})