Ext.define("Ext.ux.event.Player",function(D){var H={},C={},A={},G,B={},F={resize:1,reset:1,submit:1,change:1,select:1,error:1,abort:1};Ext.each(["click","dblclick","mouseover","mouseout","mousedown","mouseup","mousemove"],function(I){F[I]=H[I]=C[I]={bubbles:true,cancelable:(I!="mousemove"),detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0}});Ext.each(["keydown","keyup","keypress"],function(I){F[I]=H[I]=A[I]={bubbles:true,cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:0}});Ext.each(["blur","change","focus","resize","scroll","select"],function(I){H[I]=B[I]={bubbles:(I in F),cancelable:false,detail:1}});var E={8:function(J,K,I){if(K<I){J.value=J.value.substring(0,K)+J.value.substring(I)}else{if(K>0){J.value=J.value.substring(0,--K)+J.value.substring(I)}}this.setTextSelection(J,K,K)},46:function(J,K,I){if(K<I){J.value=J.value.substring(0,K)+J.value.substring(I)}else{if(K<J.value.length-1){J.value=J.value.substring(0,K)+J.value.substring(K+1)}}this.setTextSelection(J,K,K)}};return{extend:"Ext.ux.event.Driver",keyFrameEvents:{click:true},pauseForAnimations:true,speed:1,stallTime:0,_inputSpecialKeys:{INPUT:E,TEXTAREA:Ext.apply({},E)},tagPathRegEx:/(\w+)(?:\[(\d+)\])?/,constructor:function(I){var J=this;J.callParent(arguments);J.timerFn=function(){J.onTick()};J.attachTo=J.attachTo||window;G=J.attachTo.document},getElementFromXPath:function(P){var Q=this,M=P.split("/"),R=Q.tagPathRegEx,N,K,L,O,S,J,I=Q.attachTo.document;I=(M[0]=="~")?I.body:I.getElementById(M[0].substring(1));for(N=1,K=M.length;I&&N<K;++N){L=R.exec(M[N]);O=L[2]?parseInt(L[2],10):1;S=L[1].toUpperCase();for(J=I.firstChild;J;J=J.nextSibling){if(J.tagName==S){if(O==1){break}--O}}I=J}return I},offsetToRangeCharacterMove:function(I,J){return J-(I.value.slice(0,J).split("\r\n").length-1)},setTextSelection:function(M,I,L){if(I<0){I+=M.value.length}if(L==null){L=I}if(L<0){L+=M.value.length}if(typeof M.selectionStart==="number"){M.selectionStart=I;M.selectionEnd=L}else{var K=M.createTextRange();var J=this.offsetToRangeCharacterMove(M,I);K.collapse(true);if(I==L){K.move("character",J)}else{K.moveEnd("character",this.offsetToRangeCharacterMove(M,L));K.moveStart("character",J)}K.select()}},getTimeIndex:function(){var I=this.getTimestamp()-this.stallTime;return I*this.speed},makeToken:function(I,L){var J=this,K;I[L]=true;I.defer=function(){I[L]=false;K=J.getTime()};I.finish=function(){I[L]=true;J.stallTime+=J.getTime()-K;J.schedule()}},nextEvent:function(J){var K=this,I=++K.queueIndex;if(K.keyFrameEvents[J.type]){Ext.Array.insert(K.eventQueue,I,[{keyframe:true,ts:J.ts}])}},peekEvent:function(){return this.eventQueue[this.queueIndex]||null},replaceEvent:function(I,L){for(var K,J=0,M=L.length;J<M;++J){if(J){K=L[J-1];delete K.afterplay;delete K.screenshot;delete L[J].beforeplay}}Ext.Array.replace(this.eventQueue,(I==null)?this.queueIndex:I,1,L)},processEvents:function(){var J=this,K=J.pauseForAnimations&&J.attachTo.Ext.fx.Manager.items,I;while((I=J.peekEvent())!==null){if(K&&K.getCount()){return true}if(I.keyframe){if(!J.processKeyFrame(I)){return false}J.nextEvent(I)}else{if(I.ts<=J.getTimeIndex()&&J.fireEvent("beforeplay",J,I)!==false&&J.playEvent(I)){J.nextEvent(I)}else{return true}}}J.stop();return false},processKeyFrame:function(I){var J=this;if(!I.defer){J.makeToken(I,"done");J.fireEvent("keyframe",J,I)}return I.done},injectEvent:function(N,M){var L=this,K=M.type,I=Ext.apply({},M,H[K]),J;if(K==="type"){J=L._inputSpecialKeys[N.tagName];if(J){return L.injectTypeInputEvent(N,M,J)}return L.injectTypeEvent(N,M)}if(K==="focus"&&N.focus){N.focus();return true}if(K==="blur"&&N.blur){N.blur();return true}if(K==="scroll"){N.scrollLeft=M.pos[0];N.scrollTop=M.pos[1];return true}if(K==="mduclick"){return L.injectEvent(N,Ext.applyIf({type:"mousedown"},M))&&L.injectEvent(N,Ext.applyIf({type:"mouseup"},M))&&L.injectEvent(N,Ext.applyIf({type:"click"},M))}if(C[K]){return D.injectMouseEvent(N,I,L.attachTo)}if(A[K]){return D.injectKeyEvent(N,I,L.attachTo)}if(B[K]){return D.injectUIEvent(N,K,I.bubbles,I.cancelable,I.view||L.attachTo,I.detail)}return false},injectTypeEvent:function(P,J){var R=this,T=J.text,N=[],I,M,O,L,K,S,Q;if(T){delete J.text;S=T.toUpperCase();for(O=0,L=T.length;O<L;++O){I=T.charCodeAt(O);M=S.charCodeAt(O);N.push(Ext.applyIf({type:"keydown",charCode:M,keyCode:M},J),Ext.applyIf({type:"keypress",charCode:I,keyCode:I},J),Ext.applyIf({type:"keyup",charCode:M,keyCode:M},J))}}else{N.push(Ext.applyIf({type:"keydown",charCode:J.keyCode},J),Ext.applyIf({type:"keyup",charCode:J.keyCode},J))}for(O=0,L=N.length;O<L;++O){R.injectEvent(P,N[O])}return true},injectTypeInputEvent:function(M,K,I){var J=this,N=K.text,L,O;if(I){L=J.getTextSelection(M);if(N){O=L[0];M.value=M.value.substring(0,O)+N+M.value.substring(L[1]);O+=N.length;J.setTextSelection(M,O,O)}else{if(!(I=I[K.keyCode])){if("caret" in K){J.setTextSelection(M,K.caret,K.caret)}else{if(K.selection){J.setTextSelection(M,K.selection[0],K.selection[1])}}return J.injectTypeEvent(M,K)}I.call(this,M,L[0],L[1]);return true}}return true},playEvent:function(I){var K=this,L=K.getElementFromXPath(I.target),J;if(!L){return false}if(!K.playEventHook(I,"beforeplay")){return false}if(!I.injected){I.injected=true;J=K.translateEvent(I,L);K.injectEvent(L,J)}return K.playEventHook(I,"afterplay")},playEventHook:function(K,J){var L=this,I=J+".done",N=J+".fired",M=K[J];if(M&&!K[I]){if(!K[N]){K[N]=true;L.makeToken(K,I);if(L.eventScope&&Ext.isString(M)){M=L.eventScope[M]}if(M){M.call(L.eventScope||L,K)}}return false}return true},schedule:function(){var I=this;if(!I.timer){I.timer=setTimeout(I.timerFn,10)}},_translateAcross:["type","button","charCode","keyCode","caret","pos","text","selection"],translateEvent:function(P,L){var N=this,I={},O=P.modKeys||"",M=N._translateAcross,K=M.length,J,Q;while(K--){J=M[K];if(J in P){I[J]=P[J]}}I.altKey=O.indexOf("A")>0;I.ctrlKey=O.indexOf("C")>0;I.metaKey=O.indexOf("M")>0;I.shiftKey=O.indexOf("S")>0;if(L&&"x" in P){Q=Ext.fly(L).getXY();Q[0]+=P.x;Q[1]+=P.y}else{if("x" in P){Q=[P.x,P.y]}else{if("px" in P){Q=[P.px,P.py]}}}if(Q){I.clientX=I.screenX=Q[0];I.clientY=I.screenY=Q[1]}if(P.key){I.keyCode=N.specialKeysByName[P.key]}if(P.type==="wheel"){if("onwheel" in N.attachTo.document){I.wheelX=P.dx;I.wheelY=P.dy}else{I.type="mousewheel";I.wheelDeltaX=-40*P.dx;I.wheelDeltaY=I.wheelDelta=-40*P.dy}}return I},onStart:function(){var I=this;I.queueIndex=0;I.schedule()},onStop:function(){var I=this;if(I.timer){clearTimeout(I.timer);I.timer=null}},onTick:function(){var I=this;I.timer=null;if(I.processEvents()){I.schedule()}},statics:{ieButtonCodeMap:{0:1,1:4,2:2},injectKeyEvent:function(N,J,I){var M=J.type,L=null;if(M==="textevent"){M="keypress"}I=I||window;if(G.createEvent){try{L=G.createEvent("KeyEvents");L.initKeyEvent(M,J.bubbles,J.cancelable,I,J.ctrlKey,J.altKey,J.shiftKey,J.metaKey,J.keyCode,J.charCode)}catch(K){try{L=G.createEvent("Events")}catch(O){L=G.createEvent("UIEvents")}finally{L.initEvent(M,J.bubbles,J.cancelable);L.view=I;L.altKey=J.altKey;L.ctrlKey=J.ctrlKey;L.shiftKey=J.shiftKey;L.metaKey=J.metaKey;L.keyCode=J.keyCode;L.charCode=J.charCode}}N.dispatchEvent(L)}else{if(G.createEventObject){L=G.createEventObject();L.bubbles=J.bubbles;L.cancelable=J.cancelable;L.view=I;L.ctrlKey=J.ctrlKey;L.altKey=J.altKey;L.shiftKey=J.shiftKey;L.metaKey=J.metaKey;L.keyCode=(J.charCode>0)?J.charCode:J.keyCode;N.fireEvent("on"+M,L)}else{return false}}return true},injectMouseEvent:function(M,J,I){var L=J.type,K=null;I=I||window;if(G.createEvent){K=G.createEvent("MouseEvents");if(K.initMouseEvent){K.initMouseEvent(L,J.bubbles,J.cancelable,I,J.detail,J.screenX,J.screenY,J.clientX,J.clientY,J.ctrlKey,J.altKey,J.shiftKey,J.metaKey,J.button,J.relatedTarget)}else{K=G.createEvent("UIEvents");K.initEvent(L,J.bubbles,J.cancelable);K.view=I;K.detail=J.detail;K.screenX=J.screenX;K.screenY=J.screenY;K.clientX=J.clientX;K.clientY=J.clientY;K.ctrlKey=J.ctrlKey;K.altKey=J.altKey;K.metaKey=J.metaKey;K.shiftKey=J.shiftKey;K.button=J.button;K.relatedTarget=J.relatedTarget}if(J.relatedTarget&&!K.relatedTarget){if(L=="mouseout"){K.toElement=J.relatedTarget}else{if(L=="mouseover"){K.fromElement=J.relatedTarget}}}M.dispatchEvent(K)}else{if(G.createEventObject){K=G.createEventObject();K.bubbles=J.bubbles;K.cancelable=J.cancelable;K.view=I;K.detail=J.detail;K.screenX=J.screenX;K.screenY=J.screenY;K.clientX=J.clientX;K.clientY=J.clientY;K.ctrlKey=J.ctrlKey;K.altKey=J.altKey;K.metaKey=J.metaKey;K.shiftKey=J.shiftKey;K.button=D.ieButtonCodeMap[J.button]||0;K.relatedTarget=J.relatedTarget;M.fireEvent("on"+L,K)}else{return false}}return true},injectUIEvent:function(L,J,I){var K=null;I=I||window;if(G.createEvent){K=G.createEvent("UIEvents");K.initUIEvent(J.type,J.bubbles,J.cancelable,I,J.detail);L.dispatchEvent(K)}else{if(G.createEventObject){K=G.createEventObject();K.bubbles=J.bubbles;K.cancelable=J.cancelable;K.view=I;K.detail=J.detail;L.fireEvent("on"+J.type,K)}else{return false}}return true}}}})